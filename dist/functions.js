!function(){function e(r){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(r)}function r(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){n&&(e=n);var a=0,s=function(){};return{s:s,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){o=!0,i=e},f:function(){try{u||null==n.return||n.return()}finally{if(o)throw i}}}}function t(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function n(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function a(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?n(Object(t),!0).forEach((function(r){s(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function s(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function i(e,r,t,n,a,s,i){try{var u=e[s](i),o=u.value}catch(e){return void t(e)}u.done?r(o):Promise.resolve(o).then(n,a)}function u(e){return function(){var r=this,t=arguments;return new Promise((function(n,a){var s=e.apply(r,t);function u(e){i(s,n,a,u,o,"next",e)}function o(e){i(s,n,a,u,o,"throw",e)}u(void 0)}))}}function o(e){return e.charAt(0).toUpperCase()+e.slice(1)}function c(e,r){return p.apply(this,arguments)}function p(){return p=u(regeneratorRuntime.mark((function e(r,t){var n,s,i,u,o,c,p,l,b,f,d,m,h,g,k=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=k.length>2&&void 0!==k[2]?k[2]:void 0,s=k.length>3&&void 0!==k[3]?k[3]:void 0,null==n&&(n=void 0),null==s&&(s=void 0),i=readCookie("finsheet_api_key"),u=n,o=r,i){e.next=9;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 9:if(o){e.next=11;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 11:if("string"==typeof o){e.next=13;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 13:if(!o.includes(",")&&!o.includes(";")){e.next=15;break}return e.abrupt("return",["Invalid symbol"]);case 15:if(o=o.toUpperCase(),t){e.next=18;break}return e.abrupt("return",[["Metric cannot be empty"]]);case 18:if((t=t.toLowerCase())in map_excel_name_to_id||["bs","cf","ic"].includes(t)){e.next=21;break}return e.abrupt("return",[["Unsupported metric"]]);case 21:if(""===u&&(u=void 0),"string"==typeof u||void 0===u){e.next=24;break}return e.abrupt("return",[["Period has to be a string"]]);case 24:if(""===s&&(s=void 0),"number"==typeof s||void 0===s){e.next=27;break}return e.abrupt("return",[["Limit has to be a positive integer"]]);case 27:if(!(void 0!==s&&s<=0)){e.next=29;break}return e.abrupt("return",[["Limit has to be a positive integer"]]);case 29:if(c=t in map_excel_name_to_id?map_excel_name_to_id[t]:t,p=["bs","cf","ic"].includes(c),void 0!==u||!p&&!map_metrics[c].default_freq){e.next=35;break}u=["cf","ic"].includes(c)?"TTM":"bs"===c?"Q":map_metrics[c].default_freq,e.next=48;break;case 35:if(p||map_metrics[c].default_freq||void 0===u){e.next=39;break}return e.abrupt("return",[["This metric does not support periods"]]);case 39:if(void 0===u){e.next=48;break}if(u=u.toUpperCase(),!["bs","ic"].includes(c)||!u.includes("YTD")){e.next=43;break}return e.abrupt("return",[["Period YTD is only available for cf"]]);case 43:if("bs"!==c||!u.includes("TTM")){e.next=45;break}return e.abrupt("return",[["Period TTM is only available for ic and cf"]]);case 45:if(p?(l="cf"===c?["FY","TTM","Q","YTD"]:"bs"===c?["FY","Q"]:["FY","TTM","Q"],u=isValidFreq_returnCleanString(u,l,"TTM",c)):u=!!map_metrics[c].default_freq&&isValidFreq_returnCleanString(u,map_metrics[c].supported_freq,map_metrics[c].default_freq,c),!1!==u){e.next=48;break}return e.abrupt("return",[["Invalid period"]]);case 48:return!p&&["TTM","FY","Q","YTD"].includes(u)&&s&&s>1?u+="@"+s:p||(s=void 0),b={},p||(f={field_code:c},"-1"!==u&&""!==u&&void 0!==u&&(f.period=u),b=generate_query(1,"watchlist",[],[f],[],["",""],o,[f],[o])),b=a(a({},b),{ticker:o,metric:c,freq:u,api_key:i,limit:s,is_full_statement:p?"y":"n"}),206==c&&(b.is_latest_price="1"),d=link+"/excel/standard?"+new URLSearchParams(b).toString(),e.next=56,fetch(d);case 56:if((m=e.sent).ok){e.next=68;break}return e.next=60,m.text();case 60:return h=e.sent,e.prev=61,e.abrupt("return",[[JSON.parse(h).error]]);case 65:return e.prev=65,e.t0=e.catch(61),e.abrupt("return",[["Rate limit reached. Please try again later."]]);case 68:return e.next=70,m.json();case 70:if(!("message"in(g=e.sent))){e.next=73;break}return e.abrupt("return",[[g.message]]);case 73:return e.abrupt("return",handle_receive_AR_EQUITY(g,p,c));case 74:case"end":return e.stop()}}),e,null,[[61,65]])}))),p.apply(this,arguments)}function l(){return l=u(regeneratorRuntime.mark((function e(r,t){var n,a,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>2&&void 0!==s[2]?s[2]:void 0,a=s.length>3&&void 0!==s[3]?s[3]:void 0,t){e.next=4;break}return e.abrupt("return",[["Metric cannot be empty"]]);case 4:if((t=t.toLowerCase())in map_excel_name_to_id){e.next=7;break}return e.abrupt("return",[["Unsupported metric"]]);case 7:if(r){e.next=9;break}return e.abrupt("return",[[""]]);case 9:return e.abrupt("return",c(r,t,n,a));case 10:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function b(){return b=u(regeneratorRuntime.mark((function e(r,t){var n,a,s,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>2&&void 0!==i[2]?i[2]:void 0,a=i.length>3&&void 0!==i[3]?i[3]:void 0,s=t){e.next=5;break}return e.abrupt("return",[["Metric cannot be empty"]]);case 5:if(s=s.toLowerCase(),["bs","cf","ic"].includes(s)){e.next=8;break}return e.abrupt("return",[["Unsupported metric"]]);case 8:return e.abrupt("return",c(r,s,n,a));case 9:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}var f={1:1,5:1,15:1,30:1,60:1,D:1,W:1,M:1,d:1,w:1,m:1},d={d:1,w:1,m:1},m=["close","open","high","low","volume"];function h(e,r,t){return g.apply(this,arguments)}function g(){return g=u(regeneratorRuntime.mark((function e(r,t,n){var a,s,i,u,o,c,p,l,b,h,g,k,y=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=y.length>3&&void 0!==y[3]?y[3]:void 0,s=y.length>4&&void 0!==y[4]?y[4]:"stock",null==a&&(a=void 0),console.log(n,a),i=readCookie("finsheet_api_key")){e.next=7;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 7:if(r){e.next=9;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 9:if("string"==typeof r){e.next=11;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 11:if(!r.includes(",")&&!r.includes(";")){e.next=13;break}return e.abrupt("return",["Invalid symbol"]);case 13:if(r=r.toUpperCase(),t in f){e.next=16;break}return e.abrupt("return",[["Invalid resolution"]]);case 16:if(t in d&&(t=t.toUpperCase()),u=Date.parse(new Date)/1e3,n){e.next=20;break}return e.abrupt("return",[["'from' cannot be empty"]]);case 20:if("number"!=typeof n&&isNaN(n)){e.next=25;break}n<73e3&&(n=86400*(n-25569)),n=Math.round(n),e.next=28;break;case 25:if(n=Date.parse(n)/1e3,!(isNaN(n)||n<0)){e.next=28;break}return e.abrupt("return",[["Invalid 'from'"]]);case 28:if(""!=a&&void 0!==a){e.next=32;break}a=u,e.next=40;break;case 32:if("number"!=typeof a&&isNaN(a)){e.next=37;break}a<73e3&&(a=86400*(a-25569)),a=Math.round(a),e.next=40;break;case 37:if(a=Date.parse(a)/1e3,!(isNaN(a)||a<0)){e.next=40;break}return e.abrupt("return",[["Invalid 'to'"]]);case 40:if(!(a<=n)){e.next=42;break}return e.abrupt("return",[["'to' has to be after 'from'"]]);case 42:return console.log(n,a),o={ticker:r,resolution:t,from:n,to:a,api_key:i,properties:JSON.stringify(m),which:s},c=link+"/excel/candles?"+new URLSearchParams(o).toString(),e.next=47,fetch(c);case 47:if((p=e.sent).ok){e.next=59;break}return e.prev=49,e.next=52,p.text();case 52:return l=e.sent,e.abrupt("return",[[JSON.parse(l).error]]);case 56:return e.prev=56,e.t0=e.catch(49),e.abrupt("return",[["No data"]]);case 59:return e.next=61,p.json();case 61:if(!("message"in(b=e.sent))){e.next=64;break}return e.abrupt("return",[[b.message]]);case 64:if(h=b.data,g=[["Period","Open","High","Low","Close","Volume"]],h.c){e.next=68;break}return e.abrupt("return",[["No data"]]);case 68:if(h.c.constructor===Array)for(k=0;k<h.c.length;k++)g.push([h.t&&h.t[k]?new Date(1e3*h.t[k]):"",h.o&&h.o[k]?h.o[k]:"",h.h&&h.h[k]?h.h[k]:"",h.l&&h.l[k]?h.l[k]:"",h.c[k]?h.c[k]:"",h.v&&h.v[k]?h.v[k]:""]);else g.push([h.t?new Date(1e3*h.t):"",h.o?h.o:"",h.h?h.h:"",h.l?h.l:"",h.c?h.c:"",h.v?h.v:""]);if(!(g.length<2)){e.next=71;break}return e.abrupt("return",[["No data"]]);case 71:return e.abrupt("return",g);case 72:case"end":return e.stop()}}),e,null,[[49,56]])}))),g.apply(this,arguments)}function k(){return k=u(regeneratorRuntime.mark((function e(r,t){var n,a,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>2&&void 0!==s[2]?s[2]:void 0,a=s.length>3&&void 0!==s[3]?s[3]:void 0,e.abrupt("return",h(r,t,n,a,"stock"));case 3:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}function y(){return y=u(regeneratorRuntime.mark((function e(r,t){var n,a,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>2&&void 0!==s[2]?s[2]:void 0,a=s.length>3&&void 0!==s[3]?s[3]:void 0,e.abrupt("return",h(r,t,n,a,"forex"));case 3:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}function x(){return x=u(regeneratorRuntime.mark((function e(r,t){var n,a,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>2&&void 0!==s[2]?s[2]:void 0,a=s.length>3&&void 0!==s[3]?s[3]:void 0,e.abrupt("return",h(r,t,n,a,"crypto"));case 3:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}function v(){return v=u(regeneratorRuntime.mark((function e(r,t){var n,a,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>2&&void 0!==s[2]?s[2]:void 0,a=s.length>3&&void 0!==s[3]?s[3]:void 0,e.abrupt("return",h(r,t,n,a,"etf"));case 3:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}function w(){return w=u(regeneratorRuntime.mark((function e(r,t){var n,a,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>2&&void 0!==s[2]?s[2]:void 0,a=s.length>3&&void 0!==s[3]?s[3]:void 0,e.abrupt("return",h(r,t,n,a,"mutual_fund"));case 3:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function S(){return S=u(regeneratorRuntime.mark((function e(){var r,t,n,a,s,i,u,o,c,p,l,b,f=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=f.length>0&&void 0!==f[0]?f[0]:"USD",t=readCookie("finsheet_api_key")){e.next=4;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 4:return n={base_currency:r,api_key:t},a=link+"/excel/forex_all_rates?"+new URLSearchParams(n).toString(),e.next=8,fetch(a);case 8:if((s=e.sent).ok){e.next=20;break}return e.prev=10,e.next=13,s.text();case 13:return i=e.sent,e.abrupt("return",[[JSON.parse(i).error]]);case 17:return e.prev=17,e.t0=e.catch(10),e.abrupt("return",[["No data"]]);case 20:return e.next=22,s.json();case 22:if(!("message"in(u=e.sent))){e.next=25;break}return e.abrupt("return",[[u.message]]);case 25:for(o=u.data,c=[],p=0,l=Object.keys(o);p<l.length;p++)b=l[p],c.push([b,o[b]]);return e.abrupt("return",c);case 29:case"end":return e.stop()}}),e,null,[[10,17]])}))),S.apply(this,arguments)}var _={name:"Name",longName:"Full Name",description:"Description",marketCap:"Market Capitalization",totalSupply:"Total Supply",maxSupply:"Max Supply",circulatingSupply:"Circulating Supply",launchDate:"Launch Date",website:"Website",proofType:"Proof Type"};function C(){return(C=u(regeneratorRuntime.mark((function e(r){var t,n,a,s,i,u,o,c,p,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(!r.includes(":")){e.next=9;break}return e.abrupt("return",[["Invalid symbol, make sure it does not include exchange name"]]);case 9:return r=r.toUpperCase(),n=link+"/excel/asset_profile?"+new URLSearchParams({symbol:r,api_key:t,which:"crypto_profile"}).toString(),e.next=14,fetch(n);case 14:if((a=e.sent).ok){e.next=26;break}return e.prev=16,e.next=19,a.text();case 19:return s=e.sent,e.abrupt("return",[[JSON.parse(s).error]]);case 23:return e.prev=23,e.t0=e.catch(16),e.abrupt("return",[["No data"]]);case 26:return e.next=28,a.json();case 28:if(!("message"in(i=e.sent))){e.next=31;break}return e.abrupt("return",[[i.message]]);case 31:for(u=i.data,o=[],c=0,p=Object.keys(_);c<p.length;c++)l=p[c],u[l]&&o.push([_[l],u[l]]);return e.abrupt("return",o);case 35:case"end":return e.stop()}}),e,null,[[16,23]])})))).apply(this,arguments)}var N={assetClass:"Asset Class",aum:"AUM",avgVolume:"Avg Volume",cusip:"CUSIP",description:"Description",domicile:"Domicile",etfCompany:"ETF Issuer",expenseRatio:"Expense Ratio",inceptionDate:"Inception Date",investmentSegment:"Investment Segment",isin:"ISIN",name:"Name",nav:"NAV",navCurrency:"NAV Currency",priceToBook:"P/B",priceToEarnings:"P/E",trackingIndex:"Tracking Index",website:"Website"};function R(){return(R=u(regeneratorRuntime.mark((function e(r){var t,n,a,s,i,u,o,c,p,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:return r=r.toUpperCase(),n=link+"/excel/asset_profile?"+new URLSearchParams({symbol:r,api_key:t,which:"etf_profile"}).toString(),e.next=12,fetch(n);case 12:if((a=e.sent).ok){e.next=24;break}return e.prev=14,e.next=17,a.text();case 17:return s=e.sent,e.abrupt("return",[[JSON.parse(s).error]]);case 21:return e.prev=21,e.t0=e.catch(14),e.abrupt("return",[["No data"]]);case 24:return e.next=26,a.json();case 26:if(!("message"in(i=e.sent))){e.next=29;break}return e.abrupt("return",[[i.message]]);case 29:for(u=i.data.profile,o=[],i.data.symbol&&(o=[["Symbol",i.data.symbol]]),c=0,p=Object.keys(N);c<p.length;c++)l=p[c],u[l]&&o.push([N[l],u[l]]);return e.abrupt("return",o);case 34:case"end":return e.stop()}}),e,null,[[14,21]])})))).apply(this,arguments)}var O={benchmark:"Benchmark",beta:"Beta",category:"Category",description:"Description",expenseRatio:"Expense Ratio",fundFamily:"Fund Family",inceptionDate:"Inception Date",investmentSegment:"Investment Segment",name:"Full Name",totalNav:"Total NAV",turnover:"Turnover"};function P(){return(P=u(regeneratorRuntime.mark((function e(r){var t,n,a,s,i,u,o,c,p,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:return r=r.toUpperCase(),n=link+"/excel/asset_profile?"+new URLSearchParams({symbol:r,api_key:t,which:"mutual_fund_profile"}).toString(),e.next=12,fetch(n);case 12:if((a=e.sent).ok){e.next=24;break}return e.prev=14,e.next=17,a.text();case 17:return s=e.sent,e.abrupt("return",[[JSON.parse(s).error]]);case 21:return e.prev=21,e.t0=e.catch(14),e.abrupt("return",[["No data"]]);case 24:return e.next=26,a.json();case 26:if(!("message"in(i=e.sent))){e.next=29;break}return e.abrupt("return",[[i.message]]);case 29:for(u=i.data.profile,o=[],i.data.symbol&&(o=[["Symbol",i.data.symbol]]),c=0,p=Object.keys(O);c<p.length;c++)l=p[c],u[l]&&o.push([O[l],u[l]]);return e.abrupt("return",o);case 34:case"end":return e.stop()}}),e,null,[[14,21]])})))).apply(this,arguments)}function F(e,r,t){return I.apply(this,arguments)}function I(){return(I=u(regeneratorRuntime.mark((function e(t,n,a){var s,i,u,o,c,p,l,b,f,d,m,h,g,k,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(t=t.toUpperCase(),null!=n&&""!==n||(n=0),"number"==typeof n||void 0===n){e.next=11;break}return e.abrupt("return","skip has to be an integer");case 11:return i={symbol:t,skip:n.toString(),api_key:s,which:a},u=link+"/excel/asset_holdings?"+new URLSearchParams(i).toString(),e.next=15,fetch(u);case 15:if((o=e.sent).ok){e.next=27;break}return e.prev=17,e.next=20,o.text();case 20:return c=e.sent,e.abrupt("return",[[JSON.parse(c).error]]);case 24:return e.prev=24,e.t0=e.catch(17),e.abrupt("return",[["No data"]]);case 27:return e.next=29,o.json();case 29:if(!("message"in(p=e.sent))){e.next=32;break}return e.abrupt("return",p.message);case 32:e.prev=32,l=[["Date",p.data.atDate,"","","",""],["Symbol","CUSIP","ISIN","Name","Percent","Share","Value"]],b=p.data.holdings,f=r(b);try{for(f.s();!(d=f.n()).done;){for(m=d.value,h=[],g=0,k=Object.keys(U);g<k.length;g++)y=k[g],null!==m[y]&&void 0!==m[y]?h.push(m[y]):h.push("");l.push(h)}}catch(e){f.e(e)}finally{f.f()}return e.abrupt("return",l.length>2?l:[]);case 40:return e.prev=40,e.t1=e.catch(32),e.abrupt("return",[["No data"]]);case 43:case"end":return e.stop()}}),e,null,[[17,24],[32,40]])})))).apply(this,arguments)}var U={symbol:"Symbol",cusip:"CUSIP",isin:"ISIN",name:"Name",percent:"Percent",share:"Share",value:"Value"};function A(){return(A=u(regeneratorRuntime.mark((function e(r,t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",F(r,t,"etf_holdings"));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(){return(T=u(regeneratorRuntime.mark((function e(r,t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",F(r,t,"mutual_fund_holdings"));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(){return(j=u(regeneratorRuntime.mark((function e(r){var t,n,a,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[[""]]);case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:return r=r.toUpperCase(),n=link+"/excel/latest?"+new URLSearchParams({ticker:r,api_key:t}).toString(),e.next=12,fetch(n);case 12:if((a=e.sent).ok){e.next=24;break}return e.prev=14,e.next=17,a.text();case 17:return s=e.sent,e.abrupt("return",[[JSON.parse(s).error]]);case 21:return e.prev=21,e.t0=e.catch(14),e.abrupt("return",[["No data"]]);case 24:return e.next=26,a.json();case 26:if(!("message"in(i=e.sent))){e.next=29;break}return e.abrupt("return",[[i.message]]);case 29:return e.abrupt("return",[[i.data]]);case 30:case"end":return e.stop()}}),e,null,[[14,21]])})))).apply(this,arguments)}function E(e){var r=readCookie("finsheet_api_key");window.socket=new WebSocket("wss://"+link.slice(8)+"/ws?api_key="+r),window.socket.onopen=function(){console.log("Socket open"),e&&(window.socket.send(JSON.stringify({symbol:e,type:"subscribe"})),window.can_call_streaming=!0)},window.socket.onmessage=function(e){if(window.Should_Update_Streaming){var r=JSON.parse(e.data),t=r.data[0].s;window.OldBigSymbolPriceMap[t]=window.BigSymbolPriceMap[t],window.BigSymbolPriceMap[t]=r.data[0].p}},window.socket.onclose=function(e){console.log(12,e),setTimeout((function(){1e3===e.code?(window.have_not_reconnect_websocket=!1,E()):window.can_call_streaming=!1}),1e3)},window.socket.onerror=function(e){console.log(e),console.error("Socket encountered error: ",e.message,"Closing socket"),window.socket.close()}}function D(){return D=u(regeneratorRuntime.mark((function e(t,n){var a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Excel.run(function(){var e=u(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.have_not_set_interval_change_color&&(window.have_not_set_interval_change_color=!1,setInterval(u(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.Should_Update_Streaming){e.next=2;break}return e.abrupt("return");case 2:return n=t.workbook.worksheets.getActiveWorksheet(),(a=n.getUsedRange(!0)).load("formulas"),a.load("address"),a.load("values"),e.next=9,t.sync().then(u(regeneratorRuntime.mark((function e(){var s,i,o,c,p,l,b,f,d,m,h,g,k,y,x,v,w,S,_,C,N,R;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=n.id,i=a.address.split("!")[1].split(":")[0],o=0,c=0,p=0;case 4:if(!(p<i.length)){e.next=12;break}if(isNaN(i[p])){e.next=9;break}return c=colnameToNumber(i.slice(0,p))-1,o=parseInt(i.slice(p))-1,e.abrupt("break",12);case 9:p++,e.next=4;break;case 12:for(l=[],b=[],f=a.formulas,d=a.values,p=0;p<f.length;p++)for(m=0;m<f[0].length;m++)(h=f[p][m]).toLowerCase().startsWith("=fs_streaming(")&&(3===(g=h.split('"')).length?(k=g[1],window.BigSymbolPriceMap[k]&&window.OldBigSymbolPriceMap[k]&&(window.BigSymbolPriceMap[k]>window.OldBigSymbolPriceMap[k]?l.push([o+p,c+m]):window.BigSymbolPriceMap[k]<window.OldBigSymbolPriceMap[k]&&b.push([o+p,c+m]))):(y=s+"@@"+(o+p)+"@@"+(c+m),window.EachCellStreamingValue[y]&&d[p][m]&&(d[p][m]>window.EachCellStreamingValue[y]?l.push([o+p,c+m]):d[p][m]<window.EachCellStreamingValue[y]&&b.push([o+p,c+m])),window.EachCellStreamingValue[y]=d[p][m]));x=0,v=[[l,"#2cbd54"],[b,"#ff6669"]];case 19:if(!(x<v.length)){e.next=33;break}w=v[x],S="",_=r(w[0]);try{for(_.s();!(C=_.n()).done;)g=C.value,N=getExcelColName(g[1]),S+=N.toUpperCase()+(g[0]+1)+":"+N.toUpperCase()+(g[0]+1)+", "}catch(e){_.e(e)}finally{_.f()}if(""!==S&&(S=S.slice(0,S.length-2)),R=n.getRanges(S),!S){e.next=30;break}return R.format.font.color=w[1],e.next=30,t.sync().then(u(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))));case 30:x++,e.next=19;break;case 33:case"end":return e.stop()}}),e)}))));case 9:case"end":return e.stop()}}),e)}))),500));case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),readCookie("finsheet_api_key")){e.next=4;break}return e.abrupt("return","Please login using the sidebar");case 4:if(t){e.next=6;break}return e.abrupt("return","Symbol cannot be empty");case 6:if("string"==typeof t){e.next=8;break}return e.abrupt("return","Symbol has to be a string");case 8:t=t.toUpperCase(),window.socket&&window.socket.readyState===window.socket.OPEN||!window.have_not_reconnect_websocket?t in window.BigSymbolPriceMap||(a={symbol:t,type:"subscribe"},window.socket.send(JSON.stringify(a)),window.can_call_streaming=!0):E(t),s=setInterval((function(){if(window.can_call_streaming){var e=window.BigSymbolPriceMap[t];n.setResult(e)}else n.setResult("You need a Plus or Pro membership to stream real-time price.")}),500),n.onCanceled=function(){clearInterval(s)};case 12:case"end":return e.stop()}}),e)}))),D.apply(this,arguments)}function L(){return(L=u(regeneratorRuntime.mark((function e(t,n){var a,s,i,u,c,p,l,b,m,h,g,k,y,x,v,w,S,_,C,N,R,O,P,F;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(!t.includes(",")&&!t.includes(";")){e.next=9;break}return e.abrupt("return",["Invalid symbol"]);case 9:if(t=t.toUpperCase(),n in f){e.next=12;break}return e.abrupt("return",[["Invalid resolution"]]);case 12:return n in d&&(n=n.toUpperCase()),s={api_key:a,symbol:t,resolution:n,which:"pattern_recognition"},console.log(0,s),i=link+"/excel/technical?"+new URLSearchParams(s).toString(),e.next=18,fetch(i);case 18:if((u=e.sent).ok){e.next=30;break}return e.next=22,u.text();case 22:return c=e.sent,e.prev=23,e.abrupt("return",[[JSON.parse(c).error]]);case 27:return e.prev=27,e.t0=e.catch(23),e.abrupt("return",[["No data"]]);case 30:return e.next=32,u.json();case 32:if(!("message"in(p=e.sent))){e.next=35;break}return e.abrupt("return",[[p.message]]);case 35:e.prev=35,l=p.data,b=[],m=1,h=r(l),e.prev=40,h.s();case 42:if((g=h.n()).done){e.next=52;break}if((k=g.value).patternname&&k.symbol){e.next=46;break}return e.abrupt("continue",50);case 46:for(y=[["Pattern Name",k.patternname]],x=0,v=Object.keys(k);x<v.length;x++)"patternname"!==(w=v[x])&&"symbol"!==w&&y.push([o(w),k[w]]);y.length>m&&(m=y.length),b.push(y);case 50:e.next=42;break;case 52:e.next=57;break;case 54:e.prev=54,e.t1=e.catch(40),h.e(e.t1);case 57:return e.prev=57,h.f(),e.finish(57);case 60:for(S=0;S<b.length;S++)for(_=m-b[S].length,C=0;C<_;C++)b[S].push(["",""]),console.log(b[S].length);if(!(b.length<1)){e.next=63;break}return e.abrupt("return",[["No data"]]);case 63:for(N=[],S=0;S<b[0].length;S++){R=[],O=r(b);try{for(O.s();!(P=O.n()).done;)F=P.value,R=R.concat(F[S])}catch(e){O.e(e)}finally{O.f()}N.push(R)}return console.log(N),e.abrupt("return",N);case 69:return e.prev=69,e.t2=e.catch(35),e.abrupt("return",[["No data"]]);case 72:case"end":return e.stop()}}),e,null,[[23,27],[35,69],[40,54,57,60]])})))).apply(this,arguments)}function M(){return(M=u(regeneratorRuntime.mark((function e(r,t){var n,a,s,i,u,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(!r.includes(",")&&!r.includes(";")){e.next=9;break}return e.abrupt("return",["Invalid symbol"]);case 9:if(r=r.toUpperCase(),t in f){e.next=12;break}return e.abrupt("return",[["Invalid resolution"]]);case 12:return t in d&&(t=t.toUpperCase()),a=link+"/excel/technical?"+new URLSearchParams({api_key:n,symbol:r,resolution:t,which:"support_resistance"}).toString(),e.next=17,fetch(a);case 17:if((s=e.sent).ok){e.next=29;break}return e.next=21,s.text();case 21:return i=e.sent,e.prev=22,e.abrupt("return",[[JSON.parse(i).error]]);case 26:return e.prev=26,e.t0=e.catch(22),e.abrupt("return",[["No data"]]);case 29:return e.next=31,s.json();case 31:if(!("message"in(u=e.sent))){e.next=34;break}return e.abrupt("return",[[u.message]]);case 34:return o=u.data,e.prev=35,e.abrupt("return",o.length<1?[["No data"]]:[o]);case 39:return e.prev=39,e.t1=e.catch(35),e.abrupt("return",[["No data"]]);case 42:case"end":return e.stop()}}),e,null,[[22,26],[35,39]])})))).apply(this,arguments)}function J(){return(J=u(regeneratorRuntime.mark((function e(r,t){var n,a,s,i,u,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(!r.includes(",")&&!r.includes(";")){e.next=9;break}return e.abrupt("return",["Invalid symbol"]);case 9:if(r=r.toUpperCase(),t in f){e.next=12;break}return e.abrupt("return",[["Invalid resolution"]]);case 12:return t in d&&(t=t.toUpperCase()),a=link+"/excel/technical?"+new URLSearchParams({api_key:n,symbol:r,resolution:t,which:"aggregate_indicators"}).toString(),e.next=17,fetch(a);case 17:if((s=e.sent).ok){e.next=29;break}return e.next=21,s.text();case 21:return i=e.sent,e.prev=22,e.abrupt("return",[[JSON.parse(i).error]]);case 26:return e.prev=26,e.t0=e.catch(22),e.abrupt("return",[["No data"]]);case 29:return e.next=31,s.json();case 31:if(!("message"in(u=e.sent))){e.next=34;break}return e.abrupt("return",[[u.message]]);case 34:return o=u.data,e.prev=35,e.abrupt("return",[["Buy",o.technicalAnalysis.count.buy],["Neutral",o.technicalAnalysis.count.neutral],["Sell",o.technicalAnalysis.count.sell],["Aggregate signal",o.technicalAnalysis.signal],["ADX reading",o.trend.adx],["Trending",o.trend.trending.toString()]]);case 39:return e.prev=39,e.t1=e.catch(35),e.abrupt("return",[["No data"]]);case 42:case"end":return e.stop()}}),e,null,[[22,26],[35,39]])})))).apply(this,arguments)}function B(){return B=u(regeneratorRuntime.mark((function e(t,n,a,s){var i,u,c,p,l,b,m,h,g,k,y,x,v,w,S,_,C,N,R,O,P,F,I,U,A,T=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=T.length>4&&void 0!==T[4]?T[4]:void 0,u=T.length>5&&void 0!==T[5]?T[5]:[],c=u,null==i&&(i=void 0),p=readCookie("finsheet_api_key")){e.next=7;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 7:if(t){e.next=9;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 9:if("string"==typeof t){e.next=11;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 11:if(!t.includes(",")&&!t.includes(";")){e.next=13;break}return e.abrupt("return",["Invalid symbol"]);case 13:if(t=t.toUpperCase(),n in f){e.next=16;break}return e.abrupt("return",[["Invalid resolution"]]);case 16:if(n in d&&(n=n.toUpperCase()),"string"==typeof a){e.next=19;break}return e.abrupt("return",[["Indicator has to be a string"]]);case 19:if(a=a.toLowerCase(),l=Date.parse(new Date)/1e3,s){e.next=23;break}return e.abrupt("return",[["'from' cannot be empty"]]);case 23:if("number"!=typeof s&&isNaN(s)){e.next=28;break}s<73e3&&(s=86400*(s-25569)),s=Math.round(s),e.next=31;break;case 28:if(s=Date.parse(s)/1e3,!(isNaN(s)||s<0)){e.next=31;break}return e.abrupt("return",[["Invalid 'from'"]]);case 31:if(""!=i&&void 0!==i){e.next=35;break}i=l,e.next=43;break;case 35:if("number"!=typeof i&&isNaN(i)){e.next=40;break}i<73e3&&(i=86400*(i-25569)),i=Math.round(i),e.next=43;break;case 40:if(i=Date.parse(i)/1e3,!(isNaN(i)||i<0)){e.next=43;break}return e.abrupt("return",[["Invalid 'to'"]]);case 43:if(!(i<=s)){e.next=45;break}return e.abrupt("return",[["'to' has to be after 'from'"]]);case 45:b={},e.prev=46,m={},h=r(c);try{for(h.s();!(g=h.n()).done;)k=g.value,m[k[0].toString()]=k[1].toString()}catch(e){h.e(e)}finally{h.f()}b={symbol:t,resolution:n,from:s,to:i,api_key:p,indicator:a,indicator_fields:JSON.stringify(m),which:"technical_indicators"},e.next=56;break;case 53:return e.prev=53,e.t0=e.catch(46),e.abrupt("return",[["Invalid parameters"]]);case 56:return console.log("prepare",b),y=link+"/excel/technical?"+new URLSearchParams(b).toString(),e.next=60,fetch(y);case 60:if((x=e.sent).ok){e.next=72;break}return e.next=64,x.text();case 64:return v=e.sent,e.prev=65,e.abrupt("return",[[JSON.parse(v).error]]);case 69:return e.prev=69,e.t1=e.catch(65),e.abrupt("return",[["No data"]]);case 72:return e.next=74,x.json();case 74:if(w=e.sent,console.log(w),!("message"in w)){e.next=78;break}return e.abrupt("return",[[w.message]]);case 78:if(e.prev=78,(S=w.data).c){e.next=82;break}return e.abrupt("return",[["No data"]]);case 82:for(_={t:1,c:1,o:1,h:1,l:1,v:1,s:1},C=[],N=[["Period","Open","High","Low","Close","Volume"]],R=0,O=Object.keys(S);R<O.length;R++)P=O[R],_[P]||(C.push(P),N[0].push(o(P)));for(F=0;F<S.c.length;F++){I=[S.t&&S.t[F]?new Date(1e3*S.t[F]):"",S.o&&S.o[F]?S.o[F]:"",S.h&&S.h[F]?S.h[F]:"",S.l&&S.l[F]?S.l[F]:"",S.c[F]?S.c[F]:"",S.v&&S.v[F]?S.v[F]:""],U=r(C);try{for(U.s();!(A=U.n()).done;)P=A.value,I.push(S[P]&&null!==S[P][F]&&void 0!==S[P][F]?S[P][F]:"")}catch(e){U.e(e)}finally{U.f()}N.push(I)}if(!(N.length<2)){e.next=89;break}return e.abrupt("return",[["No data"]]);case 89:return console.log(N),e.abrupt("return",N);case 93:return e.prev=93,e.t2=e.catch(78),e.abrupt("return",[["No data"]]);case 96:case"end":return e.stop()}}),e,null,[[46,53],[65,69],[78,93]])}))),B.apply(this,arguments)}function V(){return(V=u(regeneratorRuntime.mark((function e(r){var t,n,a,s,i,u,c,p,l,b,f,d,m,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:return r=r.toUpperCase(),n=link+"/excel/alternative/esg?"+new URLSearchParams({symbol:r,api_key:t}).toString(),e.next=12,fetch(n);case 12:if((a=e.sent).ok){e.next=24;break}return e.prev=14,e.next=17,a.text();case 17:return s=e.sent,e.abrupt("return",[[JSON.parse(s).error]]);case 21:return e.prev=21,e.t0=e.catch(14),e.abrupt("return",[["No data"]]);case 24:return e.next=26,a.json();case 26:if(!("message"in(i=e.sent))){e.next=29;break}return e.abrupt("return",[[i.message]]);case 29:u=i.data,c=[],p=0,l=Object.keys(u);case 32:if(!(p<l.length)){e.next=45;break}if("data"!==(b=l[p])){e.next=38;break}try{for(f=0,d=Object.keys(u[b]);f<d.length;f++)m=d[f],c.push([o(m.split(/(?=[A-Z])/).join(" ")),u[b][m]])}catch(e){}e.next=42;break;case 38:if("symbol"!==b){e.next=40;break}return e.abrupt("continue",42);case 40:h="totalESGScore"===b?"Total ESG Score":o(b.split(/(?=[A-Z])/).join(" ")),c.push([h,u[b]]);case 42:p++,e.next=32;break;case 45:return e.abrupt("return",c);case 46:case"end":return e.stop()}}),e,null,[[14,21]])})))).apply(this,arguments)}function Y(){return(Y=u(regeneratorRuntime.mark((function e(t,n,a){var s,i,u,c,p,l,b,f,d,m,h,g,k,y,x,v,w,S,_,C;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(t=t.toUpperCase(),"string"==typeof n&&["annual","quarterly"].includes(n.toLowerCase())){e.next=10;break}return e.abrupt("return",[["Invalid frequency"]]);case 10:if(a||(a=100),"number"==typeof a){e.next=13;break}return e.abrupt("return",[["Limit has to be a number"]]);case 13:return i=link+"/excel/alternative/earnings_quality?"+new URLSearchParams({symbol:t,api_key:s,freq:n}).toString(),e.next=17,fetch(i);case 17:if((u=e.sent).ok){e.next=29;break}return e.prev=19,e.next=22,u.text();case 22:return c=e.sent,e.abrupt("return",[[JSON.parse(c).error]]);case 26:return e.prev=26,e.t0=e.catch(19),e.abrupt("return",[["No data"]]);case 29:return e.next=31,u.json();case 31:if(!("message"in(p=e.sent))){e.next=34;break}return e.abrupt("return",[[p.message]]);case 34:l=p.data.data,b={period:1,score:1,letterScore:1},f={},d={},m=0,h=r(l),e.prev=40,h.s();case 42:if((g=h.n()).done){e.next=52;break}if((k=g.value).period){e.next=46;break}return e.abrupt("continue",50);case 46:for(m+=1,y=0,x=Object.keys(k);y<x.length;y++)(v=x[y])in b||(f[v]=1),v in d?d[v].push(k[v]):v in d||(d[v]=[k[v]]);if(m!==a){e.next=50;break}return e.abrupt("break",52);case 50:e.next=42;break;case 52:e.next=57;break;case 54:e.prev=54,e.t1=e.catch(40),h.e(e.t1);case 57:return e.prev=57,h.f(),e.finish(57);case 60:if(!(Object.keys(d).length<1)){e.next=62;break}return e.abrupt("return",[["No data"]]);case 62:f=["period"].concat(Object.keys(f)).concat(["score","letterScore"]),w=[],S=r(f);try{for(S.s();!(_=S.n()).done;)C=_.value,w.push([o(C.split(/(?=[A-Z])/).join(" "))].concat([].concat(d[C]).reverse()))}catch(e){S.e(e)}finally{S.f()}return w[0][0]="",e.abrupt("return",w);case 68:case"end":return e.stop()}}),e,null,[[19,26],[40,54,57,60]])})))).apply(this,arguments)}function q(){return q=u(regeneratorRuntime.mark((function t(n,a){var s,i,u,o,c,p,l,b,f,d,m,h,g,k,y,x,v,w,S,_,C,N,R,O,P,F,I,U,A,T,j,E,D,L,M,J,B,V,Y,q,G,Q,H,W,X,Z,z,$,K,ee=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=ee.length>2&&void 0!==ee[2]?ee[2]:[],i=readCookie("finsheet_api_key")){t.next=4;break}return t.abrupt("return",[["Please login using the sidebar"]]);case 4:if(n){t.next=6;break}return t.abrupt("return",[["Provider name cannot be empty"]]);case 6:if("string"==typeof n){t.next=8;break}return t.abrupt("return",[["Provider name to be a string"]]);case 8:if(a){t.next=10;break}return t.abrupt("return",[["Endpoint name cannot be empty"]]);case 10:if("string"==typeof a){t.next=12;break}return t.abrupt("return",[["Endpoint name to be a string"]]);case 12:s||(s=[]),u={},t.prev=14,o=r(s);try{for(o.s();!(c=o.n()).done;)p=c.value,u[p[0].toString()]=p[1].toString()}catch(e){o.e(e)}finally{o.f()}t.next=22;break;case 19:return t.prev=19,t.t0=t.catch(14),t.abrupt("return",[["Invalid parameters"]]);case 22:if(""===(l=checkValidProviderEndpoint(n,a))[2]){t.next=25;break}return t.abrupt("return",[[l[2]]]);case 25:b=l[1],f=l[0],d=f.url,m=f.return_is_list?"list":"dic",h=f.params?f.params:{},g={},k=0,y=Object.keys(h);case 31:if(!(k<y.length)){t.next=39;break}if(x=y[k],!h[x].required||x in u){t.next=35;break}return t.abrupt("return",[['Missing parameter "'+x+'"']]);case 35:h[x].replace_2dots?d=d.replace(":"+x,u[x]):x in u?(v=h[x].transformInput,g[x]=v?v(u[x]):u[x]):h[x].default&&(g[x]=h[x].default.toString());case 36:k++,t.next=31;break;case 39:return console.log(12,g),w={api_key:i,base_url:b,endpoint_url:d,params:JSON.stringify(g),return_structure:m},S=link+"/excel/api?"+new URLSearchParams(w).toString(),t.next=44,fetch(S);case 44:if((_=t.sent).ok){t.next=56;break}return t.next=48,_.text();case 48:return C=t.sent,t.prev=49,t.abrupt("return",[[JSON.parse(C).error]]);case 53:return t.prev=53,t.t1=t.catch(49),t.abrupt("return",[["No data"]]);case 56:return t.next=58,_.json();case 58:if(!("message"in(N=t.sent))){t.next=61;break}return t.abrupt("return",[[N.message]]);case 61:R=N.data,console.log(R),t.prev=63,O=0,P=["err","error","errors"];case 65:if(!(O<P.length)){t.next=72;break}if(F=P[O],!R[F]||"object"===e(R[F])&&Object.keys(R[F]).length<1){t.next=69;break}return t.abrupt("return",[[JSON.stringify(R[F])]]);case 69:O++,t.next=65;break;case 72:t.next=76;break;case 74:t.prev=74,t.t2=t.catch(63);case 76:if(delete R.err,delete R.error,delete R.errors,"data"in R&&f.go_down_1_level?R=R.data:"result"in R&&f.go_down_1_level&&(R=R.result),R){t.next=82;break}return t.abrupt("return",[["No data"]]);case 82:if(f.go_up_1_level&&(R={data:R}),!f.specialHandleFunction){t.next=85;break}return t.abrupt("return",f.specialHandleFunction(R));case 85:if(I=[["No data"]],"object"!==e(R)||R.constructor===Array){t.next=95;break}for(U=[],A=0,T=0,j=Object.keys(R);T<j.length;T++){if(E=j[T],D=R[E],L=[],D)if("object"===e(D)&&Object.keys(D).length>15||D.constructor===Array){for(D.constructor!==Array&&(D=convertDicToArray(D,E)),M=[],J=0,B=Object.keys(D);J<B.length;J++)V=B[J],Y=f.go_up_1_level?D.constructor!==Array?V:"":D.constructor!==Array?E+"_"+V:E,M.push(handleApiDataExpandColumn(D[V],Y));D.constructor===Array&&D.length<1&&(M=[[[E,""]]]),L=rotateDataAfterExpandRow(M),console.log(E,R,D,M,L)}else"object"!==e(D)?L=[[E],[D]]:Object.keys(D).length<1||"object"!==e(D)?L=[[E],[""]]:(q=[handleApiDataExpandColumn(D,E)],L=rotateDataAfterExpandRow(q));else L=[[E],[""]];A=Math.max(A,L.length),U.push(L)}for(G=[],Q=0,H=U;Q<H.length;Q++)W=H[Q],G.push(blowUpDimension(W,A));I=concatHorizontally(G),t.next=104;break;case 95:if(R.constructor!==Array){t.next=103;break}for(X=[],Z=0,z=Object.keys(R);Z<z.length;Z++)$=z[Z],K="",X.push(handleApiDataExpandColumn(R[$],K));if(!(R.length<1)){t.next=100;break}return t.abrupt("return",[["No data"]]);case 100:I=rotateDataAfterExpandRow(X),t.next=104;break;case 103:return t.abrupt("return",[[JSON.stringify(R)]]);case 104:if(f.transformOutput)try{I=f.transformOutput(I)}catch(e){}return t.abrupt("return",I);case 106:case"end":return t.stop()}}),t,null,[[14,19],[49,53],[63,74]])}))),q.apply(this,arguments)}window.OldBigSymbolPriceMap={},window.BigSymbolPriceMap={},window.EachCellStreamingValue={},window.Should_Update_Streaming=!0,window.have_not_reconnect_websocket=!0,window.have_not_add_on_calculated_trigger=!0,window.have_not_set_interval_change_color=!0,window.can_call_streaming=!0,E(),CustomFunctions.associate("FS_EQUITYMETRICS",(function(e,r){return l.apply(this,arguments)})),CustomFunctions.associate("FS_EQUITYFULLFINANCIALS",(function(e,r){return b.apply(this,arguments)})),CustomFunctions.associate("FS_EQUITYCANDLES",(function(e,r){return k.apply(this,arguments)})),CustomFunctions.associate("FS_FOREXCANDLES",(function(e,r){return y.apply(this,arguments)})),CustomFunctions.associate("FS_CRYPTOCANDLES",(function(e,r){return x.apply(this,arguments)})),CustomFunctions.associate("FS_ETFCANDLES",(function(e,r){return v.apply(this,arguments)})),CustomFunctions.associate("FS_MUTUALFUNDCANDLES",(function(e,r){return w.apply(this,arguments)})),CustomFunctions.associate("FS_FOREXALLRATES",(function(){return S.apply(this,arguments)})),CustomFunctions.associate("FS_CRYPTOPROFILE",(function(e){return C.apply(this,arguments)})),CustomFunctions.associate("FS_ETFPROFILE",(function(e){return R.apply(this,arguments)})),CustomFunctions.associate("FS_MUTUALFUNDPROFILE",(function(e){return P.apply(this,arguments)})),CustomFunctions.associate("FS_ETFHOLDINGS",(function(e,r){return A.apply(this,arguments)})),CustomFunctions.associate("FS_MUTUALFUNDHOLDINGS",(function(e,r){return T.apply(this,arguments)})),CustomFunctions.associate("FS_LATEST",(function(e){return j.apply(this,arguments)})),CustomFunctions.associate("FS_STREAMING",(function(e,r){return D.apply(this,arguments)})),CustomFunctions.associate("FS_PATTERNRECOGNITION",(function(e,r){return L.apply(this,arguments)})),CustomFunctions.associate("FS_SUPPORTRESISTANCE",(function(e,r){return M.apply(this,arguments)})),CustomFunctions.associate("FS_AGGREGATEINDICATORS",(function(e,r){return J.apply(this,arguments)})),CustomFunctions.associate("FS_TECHNICALINDICATORS",(function(e,r,t,n){return B.apply(this,arguments)})),CustomFunctions.associate("FS_ESG",(function(e){return V.apply(this,arguments)})),CustomFunctions.associate("FS_EARNINGSQUALITY",(function(e,r,t){return Y.apply(this,arguments)})),CustomFunctions.associate("FS_API",(function(e,r){return q.apply(this,arguments)}))}();
//# sourceMappingURL=functions.js.map