!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function r(e){for(var r=1;r<arguments.length;r++){var a=null!=arguments[r]?arguments[r]:{};r%2?t(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):t(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){o=!0,s=e},f:function(){try{i||null==r.return||r.return()}finally{if(o)throw s}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t,r,n,a,u,s){try{var i=e[u](s),o=i.value}catch(e){return void r(e)}i.done?t(o):Promise.resolve(o).then(n,a)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var u=e.apply(t,r);function i(e){s(u,n,a,i,o,"next",e)}function o(e){s(u,n,a,i,o,"throw",e)}i(void 0)}))}}function o(e){return e.charAt(0).toUpperCase()+e.slice(1)}function c(e,t){return p.apply(this,arguments)}function p(){return p=i(regeneratorRuntime.mark((function e(t,n){var u,s,i,o,c,p,l,f,b,h,d,m,k,g,x,y,v,_,w,S,N,R,C,O,F,P,A=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=A.length>2&&void 0!==A[2]?A[2]:void 0,s=A.length>3&&void 0!==A[3]?A[3]:void 0,i=A.length>4&&void 0!==A[4]?A[4]:void 0,(o=i)||(o=""),null==u&&(u=void 0),null==s&&(s=void 0),c=readCookie("finsheet_api_key"),p=u,l=t,c){e.next=12;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 12:if(Array.isArray(l)&&(Array.isArray(l[0])?1===l.length&&1===l[0].length&&(l=l[0][0]):l=l[0]),f={},Array.isArray(l)){e.next=24;break}if(l){e.next=17;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 17:if("string"==typeof l){e.next=19;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 19:if(!l.includes(",")&&!l.includes(";")){e.next=21;break}return e.abrupt("return",["Invalid symbol"]);case 21:l=l.toUpperCase(),e.next=32;break;case 24:if(void 0===s||1===s||""===s){e.next=26;break}return e.abrupt("return",[["To get data for multiple stocks, limit has to be 1 or empty."]]);case 26:b=a(l);try{for(b.s();!(h=b.n()).done;){d=h.value,m=a(d);try{for(m.s();!(k=m.n()).done;)(g=k.value)&&(f[g]=1)}catch(e){m.e(e)}finally{m.f()}}}catch(e){b.e(e)}finally{b.f()}if(!(Object.keys(f).length<1)){e.next=30;break}return e.abrupt("return",[["Symbols cannot be empty"]]);case 30:if(!(Object.keys(f).length>100)){e.next=32;break}return e.abrupt("return",[["Too many symbols, maximum is 100 each time."]]);case 32:if(n){e.next=34;break}return e.abrupt("return",[["Metric cannot be empty"]]);case 34:if((n=n.toLowerCase())in map_excel_name_to_id||["bs","cf","ic"].includes(n)){e.next=37;break}return e.abrupt("return",[["Unsupported metric"]]);case 37:if("price_latest"!==n||!Array.isArray(l)){e.next=39;break}return e.abrupt("return",[["This metric does not support multiple symbols at the same time."]]);case 39:if(""===p&&(p=void 0),"string"==typeof p||void 0===p){e.next=42;break}return e.abrupt("return",[["Period has to be a string"]]);case 42:if(""===s&&(s=void 0),"number"==typeof s||void 0===s){e.next=45;break}return e.abrupt("return",[["Limit has to be a positive integer"]]);case 45:if(!(void 0!==s&&s<=0)){e.next=47;break}return e.abrupt("return",[["Limit has to be a positive integer"]]);case 47:if(x=n in map_excel_name_to_id?map_excel_name_to_id[n]:n,y=["bs","cf","ic"].includes(x),void 0!==p||!y&&!map_metrics[x].default_freq){e.next=53;break}p=["cf","ic"].includes(x)?"TTM":"bs"===x?"Q":map_metrics[x].default_freq,e.next=66;break;case 53:if(y||map_metrics[x].default_freq||void 0===p){e.next=57;break}return e.abrupt("return",[["This metric does not support periods"]]);case 57:if(void 0===p){e.next=66;break}if(p=p.toUpperCase(),!["bs","ic"].includes(x)||!p.includes("YTD")){e.next=61;break}return e.abrupt("return",[["Period YTD is only available for cf"]]);case 61:if("bs"!==x||!p.includes("TTM")){e.next=63;break}return e.abrupt("return",[["Period TTM is only available for ic and cf"]]);case 63:if(y?(v="cf"===x?["FY","TTM","Q","YTD"]:"bs"===x?["FY","Q"]:["FY","TTM","Q"],p=isValidFreq_returnCleanString(p,v,"TTM",x)):p=!!map_metrics[x].default_freq&&isValidFreq_returnCleanString(p,map_metrics[x].supported_freq,map_metrics[x].default_freq,x),!1!==p){e.next=66;break}return e.abrupt("return",[["Invalid period"]]);case 66:if(_=s<2||null==s||p.includes(".")||p.includes("-")||p.includes("+")||-1!==o.toLowerCase().indexOf("nh"),o.toLowerCase().includes("h")&&-1===o.toLowerCase().indexOf("nh")&&(_=!1),!Array.isArray(l)||_){e.next=70;break}return e.abrupt("return",[["can't display header when there are multiple tickers as input"]]);case 70:return w=!1,Array.isArray(l)||_||!(s<2||null==s)||["TTM","FY","Q","YTD"].includes(p)&&(w=!0,s=2),!y&&["TTM","FY","Q","YTD"].includes(p)&&s&&s>1?p+="@"+s:y||(s="undefined"),S={},y||(N={field_code:x},"-1"!==p&&""!==p&&void 0!==p&&(N.period=p),S=generate_query(1,"watchlist",[],[N],[],["",""],l,[N],Array.isArray(l)?Object.keys(f):[l])),S=r(r({},S),{ticker:Array.isArray(l)?"["+Object.keys(f).length.toString():l,metric:x,freq:p,api_key:c,limit:s?s.toString():"undefined",is_full_statement:y?"y":"n",is_share:"37"==x?"y":"n",is_nh:_?"y":"n"}),206==x&&(S.is_latest_price="1"),R={api_key:c,limit:s,is_full_statement:y?"y":"n",freq:p,is_share:"37"==x?"y":"n",function_name:"FS_EquityMetrics",is_nh:_?"y":"n"},C=link+"/excel/standard?"+new URLSearchParams(R).toString(),e.next=81,fetch(C,{method:"POST",body:JSON.stringify(S)});case 81:if((O=e.sent).ok){e.next=93;break}return e.next=85,O.text();case 85:return F=e.sent,e.prev=86,e.abrupt("return",[[JSON.parse(F).error]]);case 90:return e.prev=90,e.t0=e.catch(86),e.abrupt("return",[["Rate limit reached. Please try again later."]]);case 93:return e.next=95,O.json();case 95:if(!("message"in(P=e.sent))){e.next=98;break}return e.abrupt("return",[[P.message]]);case 98:return e.abrupt("return",handle_receive_AR_EQUITY(P,y,x,l,f,_,w));case 99:case"end":return e.stop()}}),e,null,[[86,90]])}))),p.apply(this,arguments)}function l(){return(l=i(regeneratorRuntime.mark((function e(t){var r,n,u,s,i,o,c,p,l,f,b,h,d,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[[""]]);case 5:if(n=t,Array.isArray(n)&&(Array.isArray(n[0])?1===n.length&&1===n[0].length&&(n=n[0][0]):n=n[0]),Array.isArray(n)){e.next=11;break}n=[[n]],e.next=12;break;case 11:return e.abrupt("return",[["Multiple tickers are not allowed."]]);case 12:u={},s=a(n);try{for(s.s();!(i=s.n()).done;){o=i.value,c=a(o);try{for(c.s();!(p=c.n()).done;)(l=p.value)&&(u[l]=1)}catch(e){c.e(e)}finally{c.f()}}}catch(e){s.e(e)}finally{s.f()}if(!(Object.keys(u).length<1)){e.next=17;break}return e.abrupt("return",[["Symbols cannot be empty"]]);case 17:if(!(Object.keys(u).length>100)){e.next=19;break}return e.abrupt("return",[["Too many symbols, maximum is 100 each time."]]);case 19:return f={ticker:Object.keys(u),api_key:r},b=link+"/excel/latest?"+new URLSearchParams({api_key:r}).toString(),e.next=24,fetch(b,{method:"POST",body:JSON.stringify(f)});case 24:if((h=e.sent).ok){e.next=36;break}return e.prev=26,e.next=29,h.text();case 29:return d=e.sent,e.abrupt("return",[[JSON.parse(d).error]]);case 33:return e.prev=33,e.t0=e.catch(26),e.abrupt("return",[["No data"]]);case 36:return e.next=38,h.json();case 38:if(!("message"in(m=e.sent))){e.next=41;break}return e.abrupt("return",[[m.message]]);case 41:return e.abrupt("return",[[m.data]]);case 42:case"end":return e.stop()}}),e,null,[[26,33]])})))).apply(this,arguments)}function f(){return f=i(regeneratorRuntime.mark((function e(t,r){var n,a,u,s,i,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>2&&void 0!==o[2]?o[2]:void 0,a=o.length>3&&void 0!==o[3]?o[3]:void 0,u=o.length>4&&void 0!==o[4]?o[4]:void 0,s=o.length>5?o[5]:void 0,r){e.next=6;break}return e.abrupt("return",[["Metric cannot be empty"]]);case 6:if((r=r.toLowerCase())in map_excel_name_to_id){e.next=9;break}return e.abrupt("return",[["Unsupported metric"]]);case 9:if(t){e.next=11;break}return e.abrupt("return",[[""]]);case 11:return i=c(t,r,n,a,u),e.t0=check_whether_reach_limit,e.next=15,i;case 15:return e.t1=e.sent,e.t2=s.address,e.next=19,(0,e.t0)(e.t1,e.t2);case 19:return e.abrupt("return",i);case 20:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function b(){return b=i(regeneratorRuntime.mark((function e(t,r){var n,a,u,s,i,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>2&&void 0!==o[2]?o[2]:void 0,a=o.length>3&&void 0!==o[3]?o[3]:void 0,u=o.length>4?o[4]:void 0,s=r){e.next=6;break}return e.abrupt("return",[["Metric cannot be empty"]]);case 6:if(s=s.toLowerCase(),["bs","cf","ic"].includes(s)){e.next=9;break}return e.abrupt("return",[["Unsupported metric"]]);case 9:return i=c(t,s,n,a),e.t0=check_whether_reach_limit,e.next=13,i;case 13:return e.t1=e.sent,e.t2=u.address,e.next=17,(0,e.t0)(e.t1,e.t2);case 17:return e.abrupt("return",i);case 18:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}var h={1:1,5:1,15:1,30:1,60:1,D:1,W:1,M:1,d:1,w:1,m:1},d={d:1,w:1,m:1},m=["close","open","high","low","volume"];function k(e,t,r){return g.apply(this,arguments)}function g(){return g=i(regeneratorRuntime.mark((function e(t,r,n){var u,s,i,c,p,l,f,b,k,g,x,y,v,_,w,S,N,R,C,O,F,P,A,I,T,D,U,E,L,j=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=j.length>3&&void 0!==j[3]?j[3]:void 0,s=j.length>4&&void 0!==j[4]?j[4]:void 0,i=j.length>5&&void 0!==j[5]?j[5]:void 0,c=j.length>6&&void 0!==j[6]?j[6]:"stock",null==u&&(u=void 0),p=readCookie("finsheet_api_key")){e.next=8;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 8:if(t){e.next=10;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 10:if("string"==typeof t){e.next=12;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 12:if(!t.includes(",")&&!t.includes(";")){e.next=14;break}return e.abrupt("return",["Invalid symbol"]);case 14:if(t=t.toUpperCase(),r in h){e.next=17;break}return e.abrupt("return",[["Invalid resolution"]]);case 17:if(r in d&&(r=r.toUpperCase()),l=Date.parse(new Date)/1e3,n){e.next=21;break}return e.abrupt("return",[["'from' cannot be empty"]]);case 21:if("number"!=typeof n&&isNaN(n)){e.next=26;break}n<73e3&&(n=86400*(n-25569)),n=Math.round(n),e.next=29;break;case 26:if(n=Date.parse(n)/1e3,!(isNaN(n)||n<0)){e.next=29;break}return e.abrupt("return",[["Invalid 'from'"]]);case 29:if(""!=u&&void 0!==u){e.next=33;break}u=l,e.next=41;break;case 33:if("number"!=typeof u&&isNaN(u)){e.next=38;break}u<73e3&&(u=86400*(u-25569)),u=Math.round(u),e.next=41;break;case 38:if(u=Date.parse(u)/1e3,!(isNaN(u)||u<0)){e.next=41;break}return e.abrupt("return",[["Invalid 'to'"]]);case 41:if(!(u<n)){e.next=43;break}return e.abrupt("return",[["'to' has to be after or equal to 'from'"]]);case 43:return f=0,u==n&&(u=n+resolution_map_to_seconds[r],f=1),b="FS_EquityCandles","future"==c?b="FS_FuturesCandles":"etf"==c&&(b="FS_EtfCandles"),"mutual_fund"==c&&(b="FS_MutualFundCandles"),"crypto"==c&&(b="FS_CryptoCandles"),"forex"==c&&(b="FS_ForexCandles"),k={ticker:t,resolution:r,from:n,to:u,api_key:p,properties:JSON.stringify(m),which:c,function_name:b},g=link+"/excel/candles?"+new URLSearchParams(k).toString(),e.next=54,fetch(g);case 54:if((x=e.sent).ok){e.next=66;break}return e.prev=56,e.next=59,x.text();case 59:return y=e.sent,e.abrupt("return",[[JSON.parse(y).error]]);case 63:return e.prev=63,e.t0=e.catch(56),e.abrupt("return",[["No data"]]);case 66:return e.next=68,x.json();case 68:if(!("message"in(v=e.sent))){e.next=71;break}return e.abrupt("return",[[v.message]]);case 71:if(_=v.data,i||(i=""),w=i.toLowerCase().includes("nh"),S=i.toLowerCase().includes("-"),N=i.toLowerCase().includes("ct"),R=[],C={Period:"t",Open:"o",High:"h",Low:"l",Close:"c",Volume:"v"},s&&"all"!=s&&"All"!=s&&"ALL"!=s){O=s.split("&"),F=a(O);try{for(F.s();!(P=F.n()).done;)A=P.value,(I=o(A.toLowerCase()))in C&&R.push(I)}catch(e){F.e(e)}finally{F.f()}}else R=["Period","Open","High","Low","Close","Volume"];if(T=[],_.c){e.next=82;break}return e.abrupt("return",[["No data"]]);case 82:if(_.c.constructor!==Array){e.next=96;break}D=0;case 84:if(!(D<_.c.length)){e.next=94;break}U=[],E=a(R);try{for(E.s();!(L=E.n()).done;)"Period"==(A=L.value)?U.push(_.t&&_.t[D]?N?new Date(1e3*_.t[D]):_.t[D]:""):U.push(_[C[A]]&&_[C[A]][D]?_[C[A]][D]:"")}catch(e){E.e(e)}finally{E.f()}if(T.push(U),!f){e.next=91;break}return e.abrupt("break",94);case 91:D++,e.next=84;break;case 94:e.next=97;break;case 96:T.push([_.t?new Date(1e3*_.t):"",_.o?_.o:"",_.h?_.h:"",_.l?_.l:"",_.c?_.c:"",_.v?_.v:""]);case 97:if(!(T.length<1)){e.next=99;break}return e.abrupt("return",[["No data"]]);case 99:return S&&T.reverse(),w||(T=[R].concat(T)),e.abrupt("return",T);case 102:case"end":return e.stop()}}),e,null,[[56,63]])}))),g.apply(this,arguments)}function x(){return x=i(regeneratorRuntime.mark((function e(t,r){var n,a,u,s,i,o,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>2&&void 0!==c[2]?c[2]:void 0,a=c.length>3&&void 0!==c[3]?c[3]:void 0,u=c.length>4&&void 0!==c[4]?c[4]:void 0,s=c.length>5&&void 0!==c[5]?c[5]:void 0,i=c.length>6?c[6]:void 0,o=k(t,r,n,a,u,s,"stock"),e.t0=check_whether_reach_limit,e.next=9,o;case 9:return e.t1=e.sent,e.t2=i.address,e.next=13,(0,e.t0)(e.t1,e.t2);case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}function y(){return y=i(regeneratorRuntime.mark((function e(t,r){var n,a,u,s,i,o,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>2&&void 0!==c[2]?c[2]:void 0,a=c.length>3&&void 0!==c[3]?c[3]:void 0,u=c.length>4&&void 0!==c[4]?c[4]:void 0,s=c.length>5&&void 0!==c[5]?c[5]:void 0,i=c.length>6?c[6]:void 0,o=k(t,r,n,a,u,s,"forex"),e.t0=check_whether_reach_limit,e.next=9,o;case 9:return e.t1=e.sent,e.t2=i.address,e.next=13,(0,e.t0)(e.t1,e.t2);case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}function v(){return v=i(regeneratorRuntime.mark((function e(t,r){var n,a,u,s,i,o,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>2&&void 0!==c[2]?c[2]:void 0,a=c.length>3&&void 0!==c[3]?c[3]:void 0,u=c.length>4&&void 0!==c[4]?c[4]:void 0,s=c.length>5&&void 0!==c[5]?c[5]:void 0,i=c.length>6?c[6]:void 0,o=k(t,r,n,a,u,s,"crypto"),e.t0=check_whether_reach_limit,e.next=9,o;case 9:return e.t1=e.sent,e.t2=i.address,e.next=13,(0,e.t0)(e.t1,e.t2);case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}function _(){return _=i(regeneratorRuntime.mark((function e(t,r){var n,a,u,s,i,o,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>2&&void 0!==c[2]?c[2]:void 0,a=c.length>3&&void 0!==c[3]?c[3]:void 0,u=c.length>4&&void 0!==c[4]?c[4]:void 0,s=c.length>5&&void 0!==c[5]?c[5]:void 0,i=c.length>6?c[6]:void 0,o=k(t,r,n,a,u,s,"etf"),e.t0=check_whether_reach_limit,e.next=9,o;case 9:return e.t1=e.sent,e.t2=i.address,e.next=13,(0,e.t0)(e.t1,e.t2);case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)}))),_.apply(this,arguments)}function w(){return w=i(regeneratorRuntime.mark((function e(t,r){var n,a,u,s,i,o,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>2&&void 0!==c[2]?c[2]:void 0,a=c.length>3&&void 0!==c[3]?c[3]:void 0,u=c.length>4&&void 0!==c[4]?c[4]:void 0,s=c.length>5&&void 0!==c[5]?c[5]:void 0,i=c.length>6?c[6]:void 0,o=k(t,r,n,a,u,s,"mutual_fund"),e.t0=check_whether_reach_limit,e.next=9,o;case 9:return e.t1=e.sent,e.t2=i.address,e.next=13,(0,e.t0)(e.t1,e.t2);case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function S(e){return N.apply(this,arguments)}function N(){return(N=i(regeneratorRuntime.mark((function e(t){var r,n,a,u,s,i,o,c,p,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:return n=link+"/excel/forex_all_rates?"+new URLSearchParams({base_currency:t,api_key:r,function_name:"FS_ForexAllRates"}).toString(),e.next=7,fetch(n);case 7:if((a=e.sent).ok){e.next=19;break}return e.prev=9,e.next=12,a.text();case 12:return u=e.sent,e.abrupt("return",[[JSON.parse(u).error]]);case 16:return e.prev=16,e.t0=e.catch(9),e.abrupt("return",[["No data"]]);case 19:return e.next=21,a.json();case 21:if(!("message"in(s=e.sent))){e.next=24;break}return e.abrupt("return",[[s.message]]);case 24:for(i=s.data,o=[],c=0,p=Object.keys(i);c<p.length;c++)l=p[c],o.push([l,i[l]]);return e.abrupt("return",o.length>0?o:[["No data"]]);case 28:case"end":return e.stop()}}),e,null,[[9,16]])})))).apply(this,arguments)}function R(){return R=i(regeneratorRuntime.mark((function e(){var t,r,n,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:"USD",r=a.length>1?a[1]:void 0,n=S(t),e.t0=check_whether_reach_limit,e.next=6,n;case 6:return e.t1=e.sent,e.t2=r.address,e.next=10,(0,e.t0)(e.t1,e.t2);case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}}),e)}))),R.apply(this,arguments)}var C={name:"Name",longName:"Full Name",description:"Description",marketCap:"Market Capitalization",totalSupply:"Total Supply",maxSupply:"Max Supply",circulatingSupply:"Circulating Supply",launchDate:"Launch Date",website:"Website",proofType:"Proof Type"};function O(e){return F.apply(this,arguments)}function F(){return(F=i(regeneratorRuntime.mark((function e(t){var r,n,a,u,s,i,o,c,p,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(!t.includes(":")){e.next=9;break}return e.abrupt("return",[["Invalid symbol, make sure it does not include exchange name"]]);case 9:return t=t.toUpperCase(),n=link+"/excel/asset_profile?"+new URLSearchParams({symbol:t,api_key:r,which:"crypto_profile",function_name:"FS_CryptoProfile"}).toString(),e.next=14,fetch(n);case 14:if((a=e.sent).ok){e.next=26;break}return e.prev=16,e.next=19,a.text();case 19:return u=e.sent,e.abrupt("return",[[JSON.parse(u).error]]);case 23:return e.prev=23,e.t0=e.catch(16),e.abrupt("return",[["No data"]]);case 26:return e.next=28,a.json();case 28:if(!("message"in(s=e.sent))){e.next=31;break}return e.abrupt("return",[[s.message]]);case 31:for(i=s.data,o=[],c=0,p=Object.keys(C);c<p.length;c++)l=p[c],i[l]&&o.push([C[l],i[l]]);return e.abrupt("return",o);case 35:case"end":return e.stop()}}),e,null,[[16,23]])})))).apply(this,arguments)}function P(){return(P=i(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=O(t),e.t0=check_whether_reach_limit,e.next=4,n;case 4:return e.t1=e.sent,e.t2=r.address,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A={assetClass:"Asset Class",aum:"AUM",avgVolume:"Avg Volume",cusip:"CUSIP",description:"Description",domicile:"Domicile",etfCompany:"ETF Issuer",expenseRatio:"Expense Ratio",inceptionDate:"Inception Date",investmentSegment:"Investment Segment",isin:"ISIN",name:"Name",nav:"NAV",navCurrency:"NAV Currency",priceToBook:"P/B",priceToEarnings:"P/E",trackingIndex:"Tracking Index",website:"Website"};function I(e){return T.apply(this,arguments)}function T(){return(T=i(regeneratorRuntime.mark((function e(t){var r,n,a,u,s,i,o,c,p,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:return t=t.toUpperCase(),n=link+"/excel/asset_profile?"+new URLSearchParams({symbol:t,api_key:r,which:"etf_profile",function_name:"FS_EtfProfile"}).toString(),e.next=12,fetch(n);case 12:if((a=e.sent).ok){e.next=24;break}return e.prev=14,e.next=17,a.text();case 17:return u=e.sent,e.abrupt("return",[[JSON.parse(u).error]]);case 21:return e.prev=21,e.t0=e.catch(14),e.abrupt("return",[["No data"]]);case 24:return e.next=26,a.json();case 26:if(!("message"in(s=e.sent))){e.next=29;break}return e.abrupt("return",[[s.message]]);case 29:for(i=s.data.profile,o=[],s.data.symbol&&(o=[["Symbol",s.data.symbol]]),c=0,p=Object.keys(A);c<p.length;c++)l=p[c],i[l]&&o.push([A[l],i[l]]);return e.abrupt("return",o.length>0?o:[["No data"]]);case 34:case"end":return e.stop()}}),e,null,[[14,21]])})))).apply(this,arguments)}function D(){return(D=i(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=I(t),e.t0=check_whether_reach_limit,e.next=4,n;case 4:return e.t1=e.sent,e.t2=r.address,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var U={benchmark:"Benchmark",beta:"Beta",category:"Category",description:"Description",expenseRatio:"Expense Ratio",fundFamily:"Fund Family",inceptionDate:"Inception Date",investmentSegment:"Investment Segment",name:"Full Name",totalNav:"Total NAV",turnover:"Turnover"};function E(e){return L.apply(this,arguments)}function L(){return(L=i(regeneratorRuntime.mark((function e(t){var r,n,a,u,s,i,o,c,p,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:return t=t.toUpperCase(),n=link+"/excel/asset_profile?"+new URLSearchParams({symbol:t,api_key:r,which:"mutual_fund_profile",function_name:"FS_MutualFundProfile"}).toString(),e.next=12,fetch(n);case 12:if((a=e.sent).ok){e.next=24;break}return e.prev=14,e.next=17,a.text();case 17:return u=e.sent,e.abrupt("return",[[JSON.parse(u).error]]);case 21:return e.prev=21,e.t0=e.catch(14),e.abrupt("return",[["No data"]]);case 24:return e.next=26,a.json();case 26:if(!("message"in(s=e.sent))){e.next=29;break}return e.abrupt("return",[[s.message]]);case 29:for(i=s.data.profile,o=[],s.data.symbol&&(o=[["Symbol",s.data.symbol]]),c=0,p=Object.keys(U);c<p.length;c++)l=p[c],i[l]&&o.push([U[l],i[l]]);return e.abrupt("return",o.length>0?o:[["No data"]]);case 34:case"end":return e.stop()}}),e,null,[[14,21]])})))).apply(this,arguments)}function j(){return(j=i(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=E(t),e.t0=check_whether_reach_limit,e.next=4,n;case 4:return e.t1=e.sent,e.t2=r.address,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e,t,r){return J.apply(this,arguments)}function J(){return(J=i(regeneratorRuntime.mark((function e(t,r,n){var u,s,i,o,c,p,l,f,b,h,d,m,k,g,x,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(t=t.toUpperCase(),null!=r&&""!==r||(r=0),"number"==typeof r||void 0===r){e.next=11;break}return e.abrupt("return","skip has to be an integer");case 11:return s="FS_EtfHoldings","mutual_fund_holdings"==n&&(s="FS_MutualFundsHoldings"),i={symbol:t,skip:r.toString(),api_key:u,which:n,function_name:s},o=link+"/excel/asset_holdings?"+new URLSearchParams(i).toString(),e.next=17,fetch(o);case 17:if((c=e.sent).ok){e.next=29;break}return e.prev=19,e.next=22,c.text();case 22:return p=e.sent,e.abrupt("return",[[JSON.parse(p).error]]);case 26:return e.prev=26,e.t0=e.catch(19),e.abrupt("return",[["No data"]]);case 29:return e.next=31,c.json();case 31:if(!("message"in(l=e.sent))){e.next=34;break}return e.abrupt("return",l.message);case 34:e.prev=34,f=[["Date",l.data.atDate,"","","","",""],["Symbol","CUSIP","ISIN","Name","Percent","Share","Value"]],b=l.data.holdings,h=a(b);try{for(h.s();!(d=h.n()).done;){for(m=d.value,k=[],g=0,x=Object.keys(B);g<x.length;g++)y=x[g],null!==m[y]&&void 0!==m[y]?k.push(m[y]):k.push("");f.push(k)}}catch(e){h.e(e)}finally{h.f()}return e.abrupt("return",f.length>2?f:[["No data"]]);case 42:return e.prev=42,e.t1=e.catch(34),e.abrupt("return",[["No data"]]);case 45:case"end":return e.stop()}}),e,null,[[19,26],[34,42]])})))).apply(this,arguments)}var B={symbol:"Symbol",cusip:"CUSIP",isin:"ISIN",name:"Name",percent:"Percent",share:"Share",value:"Value"};function V(){return(V=i(regeneratorRuntime.mark((function e(t,r,n){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=M(t,r,"etf_holdings"),e.t0=check_whether_reach_limit,e.next=4,a;case 4:return e.t1=e.sent,e.t2=n.address,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(){return(q=i(regeneratorRuntime.mark((function e(t,r,n){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=M(t,r,"mutual_fund_holdings"),e.t0=check_whether_reach_limit,e.next=4,a;case 4:return e.t1=e.sent,e.t2=n.address,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e){return H.apply(this,arguments)}function H(){return(H=i(regeneratorRuntime.mark((function e(t){var r,n,u,s,i,o,c,p,l,f,b,h,d,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[[""]]);case 5:if(n=t,Array.isArray(n)&&(Array.isArray(n[0])?1===n.length&&1===n[0].length&&(n=n[0][0]):n=n[0]),Array.isArray(n)){e.next=11;break}n=[[n]],e.next=12;break;case 11:return e.abrupt("return",[["Multiple tickers are not allowed."]]);case 12:u={},s=a(n);try{for(s.s();!(i=s.n()).done;){o=i.value,c=a(o);try{for(c.s();!(p=c.n()).done;)(l=p.value)&&(u[l]=1)}catch(e){c.e(e)}finally{c.f()}}}catch(e){s.e(e)}finally{s.f()}if(!(Object.keys(u).length<1)){e.next=17;break}return e.abrupt("return",[["Symbols cannot be empty"]]);case 17:if(!(Object.keys(u).length>100)){e.next=19;break}return e.abrupt("return",[["Too many symbols, maximum is 100 each time."]]);case 19:return f={ticker:Object.keys(u),api_key:r},b=link+"/excel/latest?"+new URLSearchParams({api_key:r}).toString(),e.next=24,fetch(b,{method:"POST",body:JSON.stringify(f)});case 24:if((h=e.sent).ok){e.next=36;break}return e.prev=26,e.next=29,h.text();case 29:return d=e.sent,e.abrupt("return",[[JSON.parse(d).error]]);case 33:return e.prev=33,e.t0=e.catch(26),e.abrupt("return",[["No data"]]);case 36:return e.next=38,h.json();case 38:if(!("message"in(m=e.sent))){e.next=41;break}return e.abrupt("return",[[m.message]]);case 41:return e.abrupt("return",[[m.data]]);case 42:case"end":return e.stop()}}),e,null,[[26,33]])})))).apply(this,arguments)}function G(){return(G=i(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Y(t),e.t0=check_whether_reach_limit,e.next=4,n;case 4:return e.t1=e.sent,e.t2=r.address,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(e){var t=readCookie("finsheet_api_key");window.socket=new WebSocket("wss://"+link.slice(8)+"/ws?api_key="+t),window.socket.onopen=function(){console.log("Socket open"),e&&(window.socket.send(JSON.stringify({symbol:e,type:"subscribe"})),window.can_call_streaming=!0)},window.socket.onmessage=function(e){if(window.Should_Update_Streaming){var t=JSON.parse(e.data),r=t.data[0].s;window.OldBigSymbolPriceMap[r]=window.BigSymbolPriceMap[r],window.BigSymbolPriceMap[r]=t.data[0].p}},window.socket.onclose=function(e){console.log(12,e),setTimeout((function(){1e3===e.code?(window.have_not_reconnect_websocket=!1,Q()):window.can_call_streaming=!1}),1e3)},window.socket.onerror=function(e){console.log(e),console.error("Socket encountered error: ",e.message,"Closing socket"),window.socket.close()}}function z(){return z=i(regeneratorRuntime.mark((function e(t,r){var n,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Excel.run(function(){var e=i(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.have_not_set_interval_change_color&&(window.have_not_set_interval_change_color=!1,setInterval(i(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.Should_Update_Streaming){e.next=2;break}return e.abrupt("return");case 2:return r=t.workbook.worksheets.getActiveWorksheet(),(n=r.getUsedRange(!0)).load("formulas"),n.load("address"),n.load("values"),e.next=9,t.sync().then(i(regeneratorRuntime.mark((function e(){var u,s,o,c,p,l,f,b,h,d,m,k,g,x,y,v,_,w,S,N,R,C;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=r.id,s=n.address.split("!")[1].split(":")[0],o=0,c=0,p=0;case 4:if(!(p<s.length)){e.next=12;break}if(isNaN(s[p])){e.next=9;break}return c=colnameToNumber(s.slice(0,p))-1,o=parseInt(s.slice(p))-1,e.abrupt("break",12);case 9:p++,e.next=4;break;case 12:for(l=[],f=[],b=n.formulas,h=n.values,p=0;p<b.length;p++)for(d=0;d<b[0].length;d++)(m=b[p][d]).toLowerCase().startsWith("=fs_streaming(")&&(3===(k=m.split('"')).length?(g=k[1],window.BigSymbolPriceMap[g]&&window.OldBigSymbolPriceMap[g]&&(window.BigSymbolPriceMap[g]>window.OldBigSymbolPriceMap[g]?l.push([o+p,c+d]):window.BigSymbolPriceMap[g]<window.OldBigSymbolPriceMap[g]&&f.push([o+p,c+d]))):(x=u+"@@"+(o+p)+"@@"+(c+d),window.EachCellStreamingValue[x]&&h[p][d]&&(h[p][d]>window.EachCellStreamingValue[x]?l.push([o+p,c+d]):h[p][d]<window.EachCellStreamingValue[x]&&f.push([o+p,c+d])),window.EachCellStreamingValue[x]=h[p][d]));y=0,v=[[l,"#2cbd54"],[f,"#ff6669"]];case 19:if(!(y<v.length)){e.next=33;break}_=v[y],w="",S=a(_[0]);try{for(S.s();!(N=S.n()).done;)k=N.value,R=getExcelColName(k[1]),w+=R.toUpperCase()+(k[0]+1)+":"+R.toUpperCase()+(k[0]+1)+", "}catch(e){S.e(e)}finally{S.f()}if(""!==w&&(w=w.slice(0,w.length-2)),C=r.getRanges(w),!w){e.next=30;break}return C.format.font.color=_[1],e.next=30,t.sync().then(i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))));case 30:y++,e.next=19;break;case 33:case"end":return e.stop()}}),e)}))));case 9:case"end":return e.stop()}}),e)}))),500));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),readCookie("finsheet_api_key")){e.next=4;break}return e.abrupt("return","Please login using the sidebar");case 4:if(t){e.next=6;break}return e.abrupt("return","Symbol cannot be empty");case 6:if("string"==typeof t){e.next=8;break}return e.abrupt("return","Symbol has to be a string");case 8:t=t.toUpperCase(),window.socket&&window.socket.readyState===window.socket.OPEN||!window.have_not_reconnect_websocket?t in window.BigSymbolPriceMap||(n={symbol:t,type:"subscribe"},window.socket.send(JSON.stringify(n)),window.can_call_streaming=!0):Q(t),u=setInterval((function(){if(window.can_call_streaming){var e=window.BigSymbolPriceMap[t];r.setResult(e)}else r.setResult("You need a Plus or Pro membership to stream real-time price.")}),500),r.onCanceled=function(){clearInterval(u)};case 12:case"end":return e.stop()}}),e)}))),z.apply(this,arguments)}function W(e,t){return K.apply(this,arguments)}function K(){return(K=i(regeneratorRuntime.mark((function e(t,r){var n,u,s,i,c,p,l,f,b,m,k,g,x,y,v,_,w,S,N,R,C,O,F;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(!t.includes(",")&&!t.includes(";")){e.next=9;break}return e.abrupt("return",["Invalid symbol"]);case 9:if(t=t.toUpperCase(),r in h){e.next=12;break}return e.abrupt("return",[["Invalid resolution"]]);case 12:return r in d&&(r=r.toUpperCase()),u=link+"/excel/technical?"+new URLSearchParams({api_key:n,symbol:t,resolution:r,which:"pattern_recognition",function_name:"FS_PatternRecognition"}).toString(),e.next=17,fetch(u);case 17:if((s=e.sent).ok){e.next=29;break}return e.next=21,s.text();case 21:return i=e.sent,e.prev=22,e.abrupt("return",[[JSON.parse(i).error]]);case 26:return e.prev=26,e.t0=e.catch(22),e.abrupt("return",[["No data"]]);case 29:return e.next=31,s.json();case 31:if(!("message"in(c=e.sent))){e.next=34;break}return e.abrupt("return",[[c.message]]);case 34:e.prev=34,p=c.data,l=[],f=1,b=a(p),e.prev=39,b.s();case 41:if((m=b.n()).done){e.next=51;break}if((k=m.value).patternname&&k.symbol){e.next=45;break}return e.abrupt("continue",49);case 45:for(g=[["Pattern Name",k.patternname]],x=0,y=Object.keys(k);x<y.length;x++)"patternname"!==(v=y[x])&&"symbol"!==v&&g.push([o(v),k[v]]);g.length>f&&(f=g.length),l.push(g);case 49:e.next=41;break;case 51:e.next=56;break;case 53:e.prev=53,e.t1=e.catch(39),b.e(e.t1);case 56:return e.prev=56,b.f(),e.finish(56);case 59:for(_=0;_<l.length;_++)for(w=f-l[_].length,S=0;S<w;S++)l[_].push(["",""]);if(!(l.length<1)){e.next=62;break}return e.abrupt("return",[["No data"]]);case 62:for(N=[],_=0;_<l[0].length;_++){R=[],C=a(l);try{for(C.s();!(O=C.n()).done;)F=O.value,R=R.concat(F[_])}catch(e){C.e(e)}finally{C.f()}N.push(R)}return e.abrupt("return",N);case 67:return e.prev=67,e.t2=e.catch(34),e.abrupt("return",[["No data"]]);case 70:case"end":return e.stop()}}),e,null,[[22,26],[34,67],[39,53,56,59]])})))).apply(this,arguments)}function X(){return(X=i(regeneratorRuntime.mark((function e(t,r,n){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=W(t,r),e.t0=check_whether_reach_limit,e.next=4,a;case 4:return e.t1=e.sent,e.t2=n.address,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e,t){return $.apply(this,arguments)}function $(){return($=i(regeneratorRuntime.mark((function e(t,r){var n,a,u,s,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(!t.includes(",")&&!t.includes(";")){e.next=9;break}return e.abrupt("return",["Invalid symbol"]);case 9:if(t=t.toUpperCase(),r in h){e.next=12;break}return e.abrupt("return",[["Invalid resolution"]]);case 12:return r in d&&(r=r.toUpperCase()),a=link+"/excel/technical?"+new URLSearchParams({api_key:n,symbol:t,resolution:r,which:"support_resistance",function_name:"FS_SupportResistance"}).toString(),e.next=17,fetch(a);case 17:if((u=e.sent).ok){e.next=29;break}return e.next=21,u.text();case 21:return s=e.sent,e.prev=22,e.abrupt("return",[[JSON.parse(s).error]]);case 26:return e.prev=26,e.t0=e.catch(22),e.abrupt("return",[["No data"]]);case 29:return e.next=31,u.json();case 31:if(!("message"in(i=e.sent))){e.next=34;break}return e.abrupt("return",[[i.message]]);case 34:return o=i.data,e.prev=35,e.abrupt("return",o.length<1?[["No data"]]:[o]);case 39:return e.prev=39,e.t1=e.catch(35),e.abrupt("return",[["No data"]]);case 42:case"end":return e.stop()}}),e,null,[[22,26],[35,39]])})))).apply(this,arguments)}function ee(){return(ee=i(regeneratorRuntime.mark((function e(t,r,n){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Z(t,r),e.t0=check_whether_reach_limit,e.next=4,a;case 4:return e.t1=e.sent,e.t2=n.address,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e,t){return re.apply(this,arguments)}function re(){return(re=i(regeneratorRuntime.mark((function e(t,r){var n,a,u,s,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(!t.includes(",")&&!t.includes(";")){e.next=9;break}return e.abrupt("return",["Invalid symbol"]);case 9:if(t=t.toUpperCase(),r in h){e.next=12;break}return e.abrupt("return",[["Invalid resolution"]]);case 12:return r in d&&(r=r.toUpperCase()),a=link+"/excel/technical?"+new URLSearchParams({api_key:n,symbol:t,resolution:r,which:"aggregate_indicators",function_name:"FS_AggregateIndicators"}).toString(),e.next=17,fetch(a);case 17:if((u=e.sent).ok){e.next=29;break}return e.next=21,u.text();case 21:return s=e.sent,e.prev=22,e.abrupt("return",[[JSON.parse(s).error]]);case 26:return e.prev=26,e.t0=e.catch(22),e.abrupt("return",[["No data"]]);case 29:return e.next=31,u.json();case 31:if(!("message"in(i=e.sent))){e.next=34;break}return e.abrupt("return",[[i.message]]);case 34:return o=i.data,e.prev=35,e.abrupt("return",[["Buy",o.technicalAnalysis.count.buy],["Neutral",o.technicalAnalysis.count.neutral],["Sell",o.technicalAnalysis.count.sell],["Aggregate signal",o.technicalAnalysis.signal],["ADX reading",o.trend.adx],["Trending",o.trend.trending.toString()]]);case 39:return e.prev=39,e.t1=e.catch(35),e.abrupt("return",[["No data"]]);case 42:case"end":return e.stop()}}),e,null,[[22,26],[35,39]])})))).apply(this,arguments)}function ne(){return(ne=i(regeneratorRuntime.mark((function e(t,r,n){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=te(t,r),e.t0=check_whether_reach_limit,e.next=4,a;case 4:return e.t1=e.sent,e.t2=n.address,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:return e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(e,t,r,n,a,u){return ue.apply(this,arguments)}function ue(){return(ue=i(regeneratorRuntime.mark((function e(t,r,n,u,s,i){var c,p,l,f,b,m,k,g,x,y,v,_,w,S,N,R,C,O,F,P,A,I,T;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((c=i)||(c=[]),null==s&&(s=void 0),p=readCookie("finsheet_api_key")){e.next=6;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 6:if(t){e.next=8;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 8:if("string"==typeof t){e.next=10;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 10:if(!t.includes(",")&&!t.includes(";")){e.next=12;break}return e.abrupt("return",["Invalid symbol"]);case 12:if(t=t.toUpperCase(),r in h){e.next=15;break}return e.abrupt("return",[["Invalid resolution"]]);case 15:if(r in d&&(r=r.toUpperCase()),"string"==typeof n){e.next=18;break}return e.abrupt("return",[["Indicator has to be a string"]]);case 18:if(n=n.toLowerCase(),l=Date.parse(new Date)/1e3,u){e.next=22;break}return e.abrupt("return",[["'from' cannot be empty"]]);case 22:if("number"!=typeof u&&isNaN(u)){e.next=27;break}u<73e3&&(u=86400*(u-25569)),u=Math.round(u),e.next=30;break;case 27:if(u=Date.parse(u)/1e3,!(isNaN(u)||u<0)){e.next=30;break}return e.abrupt("return",[["Invalid 'from'"]]);case 30:if(""!=s&&void 0!==s){e.next=34;break}s=l,e.next=42;break;case 34:if("number"!=typeof s&&isNaN(s)){e.next=39;break}s<73e3&&(s=86400*(s-25569)),s=Math.round(s),e.next=42;break;case 39:if(s=Date.parse(s)/1e3,!(isNaN(s)||s<0)){e.next=42;break}return e.abrupt("return",[["Invalid 'to'"]]);case 42:if(!(s<=u)){e.next=44;break}return e.abrupt("return",[["'to' has to be after 'from'"]]);case 44:f={},e.prev=45,b={},m=a(c);try{for(m.s();!(k=m.n()).done;)g=k.value,b[g[0].toString()]=g[1].toString()}catch(e){m.e(e)}finally{m.f()}f={symbol:t,resolution:r,from:u,to:s,api_key:p,indicator:n,indicator_fields:JSON.stringify(b),which:"technical_indicators",function_name:"FS_TechnicalIndicators"},e.next=55;break;case 52:return e.prev=52,e.t0=e.catch(45),e.abrupt("return",[["Invalid parameters"]]);case 55:return x=link+"/excel/technical?"+new URLSearchParams(f).toString(),e.next=58,fetch(x);case 58:if((y=e.sent).ok){e.next=70;break}return e.next=62,y.text();case 62:return v=e.sent,e.prev=63,e.abrupt("return",[[JSON.parse(v).error]]);case 67:return e.prev=67,e.t1=e.catch(63),e.abrupt("return",[["No data"]]);case 70:return e.next=72,y.json();case 72:if(!("message"in(_=e.sent))){e.next=75;break}return e.abrupt("return",[[_.message]]);case 75:if(e.prev=75,(w=_.data).c){e.next=79;break}return e.abrupt("return",[["No data"]]);case 79:for(S={t:1,c:1,o:1,h:1,l:1,v:1,s:1},N=[],R=[["Period","Open","High","Low","Close","Volume"]],C=0,O=Object.keys(w);C<O.length;C++)F=O[C],S[F]||(N.push(F),R[0].push(o(F)));for(P=0;P<w.c.length;P++){A=[w.t&&w.t[P]?w.t[P]:"",w.o&&w.o[P]?w.o[P]:"",w.h&&w.h[P]?w.h[P]:"",w.l&&w.l[P]?w.l[P]:"",w.c[P]?w.c[P]:"",w.v&&w.v[P]?w.v[P]:""],I=a(N);try{for(I.s();!(T=I.n()).done;)F=T.value,A.push(w[F]&&null!==w[F][P]&&void 0!==w[F][P]?w[F][P]:"")}catch(e){I.e(e)}finally{I.f()}R.push(A)}if(!(R.length<2)){e.next=86;break}return e.abrupt("return",[["No data"]]);case 86:return e.abrupt("return",R);case 89:return e.prev=89,e.t2=e.catch(75),e.abrupt("return",[["No data"]]);case 92:case"end":return e.stop()}}),e,null,[[45,52],[63,67],[75,89]])})))).apply(this,arguments)}function se(){return se=i(regeneratorRuntime.mark((function e(t,r,n,a){var u,s,i,o,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=c.length>4&&void 0!==c[4]?c[4]:void 0,s=c.length>5&&void 0!==c[5]?c[5]:[],i=c.length>6?c[6]:void 0,o=ae(t,r,n,a,u,s),e.t0=check_whether_reach_limit,e.next=7,o;case 7:return e.t1=e.sent,e.t2=i.address,e.next=11,(0,e.t0)(e.t1,e.t2);case 11:return e.abrupt("return",o);case 12:case"end":return e.stop()}}),e)}))),se.apply(this,arguments)}function ie(e){return oe.apply(this,arguments)}function oe(){return(oe=i(regeneratorRuntime.mark((function e(t){var r,n,a,u,s,i,c,p,l,f,b,h,d,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:return t=t.toUpperCase(),n=link+"/excel/alternative/esg?"+new URLSearchParams({symbol:t,api_key:r,function_name:"FS_ESG"}).toString(),e.next=12,fetch(n);case 12:if((a=e.sent).ok){e.next=24;break}return e.prev=14,e.next=17,a.text();case 17:return u=e.sent,e.abrupt("return",[[JSON.parse(u).error]]);case 21:return e.prev=21,e.t0=e.catch(14),e.abrupt("return",[["No data"]]);case 24:return e.next=26,a.json();case 26:if(!("message"in(s=e.sent))){e.next=29;break}return e.abrupt("return",[[s.message]]);case 29:i=s.data,c=[],p=0,l=Object.keys(i);case 32:if(!(p<l.length)){e.next=45;break}if("data"!==(f=l[p])){e.next=38;break}try{for(b=0,h=Object.keys(i[f]);b<h.length;b++)d=h[b],c.push([o(d.split(/(?=[A-Z])/).join(" ")),i[f][d]])}catch(e){}e.next=42;break;case 38:if("symbol"!==f){e.next=40;break}return e.abrupt("continue",42);case 40:m="totalESGScore"===f?"Total ESG Score":o(f.split(/(?=[A-Z])/).join(" ")),c.push([m,i[f]]);case 42:p++,e.next=32;break;case 45:return e.abrupt("return",c.length>0?c:[["No data"]]);case 46:case"end":return e.stop()}}),e,null,[[14,21]])})))).apply(this,arguments)}function ce(){return(ce=i(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ie(t),e.t0=check_whether_reach_limit,e.next=4,n;case 4:return e.t1=e.sent,e.t2=r.address,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(e,t,r){return le.apply(this,arguments)}function le(){return(le=i(regeneratorRuntime.mark((function e(t,r,n){var u,s,i,c,p,l,f,b,h,d,m,k,g,x,y,v,_,w,S,N;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(t=t.toUpperCase(),"string"==typeof r&&["annual","quarterly"].includes(r.toLowerCase())){e.next=10;break}return e.abrupt("return",[["Invalid frequency"]]);case 10:if(n||(n=100),"number"==typeof n){e.next=13;break}return e.abrupt("return",[["Limit has to be a number"]]);case 13:return s=link+"/excel/alternative/earnings_quality?"+new URLSearchParams({symbol:t,api_key:u,freq:r,function_name:"FS_EarningsQuality"}).toString(),e.next=17,fetch(s);case 17:if((i=e.sent).ok){e.next=29;break}return e.prev=19,e.next=22,i.text();case 22:return c=e.sent,e.abrupt("return",[[JSON.parse(c).error]]);case 26:return e.prev=26,e.t0=e.catch(19),e.abrupt("return",[["No data"]]);case 29:return e.next=31,i.json();case 31:if(!("message"in(p=e.sent))){e.next=34;break}return e.abrupt("return",[[p.message]]);case 34:l=p.data.data,f={period:1,score:1,letterScore:1},b={},h={},d=0,m=a(l),e.prev=40,m.s();case 42:if((k=m.n()).done){e.next=52;break}if((g=k.value).period){e.next=46;break}return e.abrupt("continue",50);case 46:for(d+=1,x=0,y=Object.keys(g);x<y.length;x++)(v=y[x])in f||(b[v]=1),v in h?h[v].push(g[v]):v in h||(h[v]=[g[v]]);if(d!==n){e.next=50;break}return e.abrupt("break",52);case 50:e.next=42;break;case 52:e.next=57;break;case 54:e.prev=54,e.t1=e.catch(40),m.e(e.t1);case 57:return e.prev=57,m.f(),e.finish(57);case 60:if(!(Object.keys(h).length<1)){e.next=62;break}return e.abrupt("return",[["No data"]]);case 62:b=["period"].concat(Object.keys(b)).concat(["score","letterScore"]),_=[],w=a(b);try{for(w.s();!(S=w.n()).done;)N=S.value,_.push([o(N.split(/(?=[A-Z])/).join(" "))].concat([].concat(h[N]).reverse()))}catch(e){w.e(e)}finally{w.f()}return _[0][0]="",e.abrupt("return",_.length>0?_:[["No data"]]);case 68:case"end":return e.stop()}}),e,null,[[19,26],[40,54,57,60]])})))).apply(this,arguments)}function fe(){return(fe=i(regeneratorRuntime.mark((function e(t,r,n,a){var u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=pe(t,r,n),e.t0=check_whether_reach_limit,e.next=4,u;case 4:return e.t1=e.sent,e.t2=a.address,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:return e.abrupt("return",u);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e,t,r){return he.apply(this,arguments)}function he(){return(he=i(regeneratorRuntime.mark((function t(r,n,u){var s,i,o,c,p,l,f,b,h,d,m,k,g,x,y,v,_,w,S,N,R,C,O,F,P,A,I,T,D,U,E,L,j,M,J,B,V,q,Y,H,G,Q,z,W,K,X,Z;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=readCookie("finsheet_api_key")){t.next=3;break}return t.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){t.next=5;break}return t.abrupt("return",[["Provider name cannot be empty"]]);case 5:if("string"==typeof r){t.next=7;break}return t.abrupt("return",[["Provider name to be a string"]]);case 7:if(n){t.next=9;break}return t.abrupt("return",[["Endpoint name cannot be empty"]]);case 9:if("string"==typeof n){t.next=11;break}return t.abrupt("return",[["Endpoint name to be a string"]]);case 11:u||(u=[]),i={},t.prev=13,o=a(u);try{for(o.s();!(c=o.n()).done;)p=c.value,i[p[0].toString()]=p[1].toString()}catch(e){o.e(e)}finally{o.f()}t.next=21;break;case 18:return t.prev=18,t.t0=t.catch(13),t.abrupt("return",[["Invalid parameters"]]);case 21:if(""===(l=checkValidProviderEndpoint(r,n))[2]){t.next=24;break}return t.abrupt("return",[[l[2]]]);case 24:f=l[1],b=l[0],h=b.url,d=b.return_is_list?"list":"dic",m=b.params?b.params:{},k={},g=0,x=Object.keys(m);case 30:if(!(g<x.length)){t.next=38;break}if(y=x[g],!m[y].required||y in i){t.next=34;break}return t.abrupt("return",[['Missing parameter "'+y+'"']]);case 34:m[y].replace_2dots?h=h.replace(":"+y,i[y]):y in i?(v=m[y].transformInput,k[y]=v?v(i[y]):i[y]):m[y].default&&(k[y]=m[y].default.toString());case 35:g++,t.next=30;break;case 38:return _={api_key:s,base_url:f,endpoint_url:h,params:JSON.stringify(k),return_structure:d},w=link+"/excel/api?"+new URLSearchParams(_).toString(),t.next=42,fetch(w);case 42:if((S=t.sent).ok){t.next=54;break}return t.next=46,S.text();case 46:return N=t.sent,t.prev=47,t.abrupt("return",[[JSON.parse(N).error]]);case 51:return t.prev=51,t.t1=t.catch(47),t.abrupt("return",[["No data"]]);case 54:return t.next=56,S.json();case 56:if(!("message"in(R=t.sent))){t.next=59;break}return t.abrupt("return",[[R.message]]);case 59:if(!("string"==typeof(C=R.data)||C instanceof String)){t.next=62;break}return t.abrupt("return",[[C]]);case 62:t.prev=62,O=0,F=["err","error","errors"];case 64:if(!(O<F.length)){t.next=71;break}if(P=F[O],!C[P]||"object"===e(C[P])&&Object.keys(C[P]).length<1){t.next=68;break}return t.abrupt("return",[[JSON.stringify(C[P])]]);case 68:O++,t.next=64;break;case 71:t.next=75;break;case 73:t.prev=73,t.t2=t.catch(62);case 75:if(delete C.err,delete C.error,delete C.errors,"data"in C&&b.go_down_1_level?C=C.data:"result"in C&&b.go_down_1_level&&(C=C.result),C){t.next=81;break}return t.abrupt("return",[["No data"]]);case 81:if(b.go_up_1_level&&(C={data:C}),!b.specialHandleFunction){t.next=84;break}return t.abrupt("return",b.specialHandleFunction(C));case 84:if(A=[["No data"]],"object"!==e(C)||C.constructor===Array){t.next=94;break}for(I=[],T=0,D=0,U=Object.keys(C);D<U.length;D++){if(E=U[D],L=C[E],j=[],L)if("object"===e(L)&&Object.keys(L).length>15||L.constructor===Array){for(L.constructor!==Array&&(L=convertDicToArray(L,E)),M=[],J=0,B=Object.keys(L);J<B.length;J++)V=B[J],q=b.go_up_1_level?L.constructor!==Array?V:"":L.constructor!==Array?E+"_"+V:E,M.push(handleApiDataExpandColumn(L[V],q));L.constructor===Array&&L.length<1&&(M=[[[E,""]]]),j=rotateDataAfterExpandRow(M)}else"object"!==e(L)?j=[[E],[L]]:Object.keys(L).length<1||"object"!==e(L)?j=[[E],[""]]:(Y=[handleApiDataExpandColumn(L,E)],j=rotateDataAfterExpandRow(Y));else j=[[E],[""]];T=Math.max(T,j.length),I.push(j)}for(H=[],G=0,Q=I;G<Q.length;G++)z=Q[G],H.push(blowUpDimension(z,T));A=concatHorizontally(H),t.next=103;break;case 94:if(C.constructor!==Array){t.next=102;break}for(W=[],K=0,X=Object.keys(C);K<X.length;K++)Z=X[K],W.push(handleApiDataExpandColumn(C[Z],""));if(!(C.length<1)){t.next=99;break}return t.abrupt("return",[["No data"]]);case 99:A=rotateDataAfterExpandRow(W),t.next=103;break;case 102:return t.abrupt("return",[[JSON.stringify(C)]]);case 103:if(b.transformOutput)try{A=b.transformOutput(A)}catch(e){}return t.abrupt("return",A);case 105:case"end":return t.stop()}}),t,null,[[13,18],[47,51],[62,73]])})))).apply(this,arguments)}function de(){return de=i(regeneratorRuntime.mark((function e(t,r){var n,a,u,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>2&&void 0!==s[2]?s[2]:[],a=s.length>3?s[3]:void 0,u=be(t,r,n),e.t0=check_whether_reach_limit,e.next=6,u;case 6:return e.t1=e.sent,e.t2=a.address,e.next=10,(0,e.t0)(e.t1,e.t2);case 10:return e.abrupt("return",u);case 11:case"end":return e.stop()}}),e)}))),de.apply(this,arguments)}function me(e,t,r,n){return ke.apply(this,arguments)}function ke(){return(ke=i(regeneratorRuntime.mark((function e(t,r,n,a){var u,s,i,o,c,p,l,f,b,h,d,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&(n=void 0),u=t,s=readCookie("finsheet_api_key")){e.next=5;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 5:if(u){e.next=7;break}return e.abrupt("return",[["ISIN cannot be empty"]]);case 7:if("string"==typeof u){e.next=9;break}return e.abrupt("return",[["ISIN has to be a string"]]);case 9:if(u=u.toUpperCase(),r){e.next=12;break}return e.abrupt("return",[["'from' cannot be empty"]]);case 12:if("number"!=typeof r&&isNaN(r)){e.next=17;break}r<73e3&&(r=86400*(r-25569)),r=Math.round(r),e.next=20;break;case 17:if(r=Date.parse(r)/1e3,!(isNaN(r)||r<0)){e.next=20;break}return e.abrupt("return",[["Invalid 'from'"]]);case 20:if(""!=n&&void 0!==n){e.next=24;break}n=current_time,e.next=32;break;case 24:if("number"!=typeof n&&isNaN(n)){e.next=29;break}n<73e3&&(n=86400*(n-25569)),n=Math.round(n),e.next=32;break;case 29:if(n=Date.parse(n)/1e3,!(isNaN(n)||n<0)){e.next=32;break}return e.abrupt("return",[["Invalid 'to'"]]);case 32:if(!(n<=r)){e.next=34;break}return e.abrupt("return",[["'to' has to be after 'from'"]]);case 34:return i=link+"/excel/bond_candles?"+new URLSearchParams({ticker:u,from:r,to:n,api_key:s,function_name:"FS_BondCandles"}).toString(),e.next=38,fetch(i);case 38:if((o=e.sent).ok){e.next=50;break}return e.prev=40,e.next=43,o.text();case 43:return c=e.sent,e.abrupt("return",[[JSON.parse(c).error]]);case 47:return e.prev=47,e.t0=e.catch(40),e.abrupt("return",[["No data"]]);case 50:return e.next=52,o.json();case 52:if(!("message"in(p=e.sent))){e.next=55;break}return e.abrupt("return",[[p.message]]);case 55:if(l=p.data,a||(a=""),f=a.toLowerCase().includes("nh"),b=a.toLowerCase().includes("-"),h=a.toLowerCase().includes("ct"),d=[],l.c){e.next=63;break}return e.abrupt("return",[["No data"]]);case 63:if(l.c.constructor===Array)for(m=0;m<l.c.length;m++)d.push([l.t&&l.t[m]?h?new Date(1e3*l.t[m]):l.t[m]:"",l.c[m]?l.c[m]:""]);if(!(d.length<1)){e.next=66;break}return e.abrupt("return",[["No data"]]);case 66:return b&&d.reverse(),f||(d=[["Period","Close"]].concat(d)),e.abrupt("return",d);case 69:case"end":return e.stop()}}),e,null,[[40,47]])})))).apply(this,arguments)}function ge(){return ge=i(regeneratorRuntime.mark((function e(t){var r,n,a,u,s,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:void 0,n=i.length>2&&void 0!==i[2]?i[2]:void 0,a=i.length>3&&void 0!==i[3]?i[3]:void 0,u=i.length>4?i[4]:void 0,s=me(t,r,n,a),e.t0=check_whether_reach_limit,e.next=8,s;case 8:return e.t1=e.sent,e.t2=u.address,e.next=12,(0,e.t0)(e.t1,e.t2);case 12:return e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)}))),ge.apply(this,arguments)}function xe(e,t,r,n){return ye.apply(this,arguments)}function ye(){return(ye=i(regeneratorRuntime.mark((function e(t,r,n,a){var u,s,i,o,c,p,l,f,b,h,d,m,k,g,x;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=t,s=r,i=readCookie("finsheet_api_key")){e.next=4;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 4:if(u){e.next=6;break}return e.abrupt("return",[["ISIN cannot be empty"]]);case 6:if("string"==typeof u){e.next=8;break}return e.abrupt("return",[["ISIN has to be a string"]]);case 8:if(u=u.toUpperCase(),s){e.next=11;break}return e.abrupt("return",[["'date' cannot be empty"]]);case 11:if("number"!=typeof s&&isNaN(s)){e.next=16;break}s<73e3&&(s=86400*(s-25569)),s=Math.round(s),e.next=19;break;case 16:if(s=Date.parse(s)/1e3,!(isNaN(s)||s<0)){e.next=19;break}return e.abrupt("return",[["Invalid 'date'"]]);case 19:return s=new Date(1e3*s),o=s.getTimezoneOffset(),s=(s=new Date(s.getTime()-60*o*1e3)).toISOString().split("T")[0],n||(n=25e3),c={ticker:u,from:s,limit:n.toString(),api_key:i,function_name:"FS_BondTick"},p=link+"/excel/bond_tick?"+new URLSearchParams(c).toString(),e.next=28,fetch(p);case 28:if((l=e.sent).ok){e.next=40;break}return e.prev=30,e.next=33,l.text();case 33:return f=e.sent,e.abrupt("return",[[JSON.parse(f).error]]);case 37:return e.prev=37,e.t0=e.catch(30),e.abrupt("return",[["No data"]]);case 40:return e.next=42,l.json();case 42:if(!("message"in(b=e.sent))){e.next=45;break}return e.abrupt("return",[[b.message]]);case 45:if(h=b.data,a||(a=""),d=a.toLowerCase().includes("nh"),m=a.toLowerCase().includes("-"),k=a.toLowerCase().includes("ct"),g=[],h.p){e.next=53;break}return e.abrupt("return",[["No data"]]);case 53:if(h.p.constructor===Array)for(x=0;x<h.p.length;x++)g.push([h.t&&h.t[x]?k?new Date(h.t[x]):parseInt(h.t[x]/1e3):"",h.p[x]?h.p[x]:"",h.v&&(h.v[x]||0==h.v[x])?h.v[x]:"",h.si&&h.si[x]?"1"===h.si[x].toString()?"Buy":"Sell":""]);if(!(g.length<1)){e.next=56;break}return e.abrupt("return",[["No data"]]);case 56:return m&&g.reverse(),d||(g=[["Period","Price","Volume","Side"]].concat(g)),e.abrupt("return",g);case 59:case"end":return e.stop()}}),e,null,[[30,37]])})))).apply(this,arguments)}function ve(){return ve=i(regeneratorRuntime.mark((function e(t){var r,n,a,u,s,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:void 0,n=i.length>2&&void 0!==i[2]?i[2]:void 0,a=i.length>3&&void 0!==i[3]?i[3]:void 0,u=i.length>4?i[4]:void 0,s=xe(t,r,n,a),e.t0=check_whether_reach_limit,e.next=8,s;case 8:return e.t1=e.sent,e.t2=u.address,e.next=12,(0,e.t0)(e.t1,e.t2);case 12:return e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)}))),ve.apply(this,arguments)}function _e(){return _e=i(regeneratorRuntime.mark((function e(t){var r,n,a,u,s,i,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:void 0,n=o.length>2&&void 0!==o[2]?o[2]:void 0,a=o.length>3&&void 0!==o[3]?o[3]:void 0,u=o.length>4&&void 0!==o[4]?o[4]:void 0,s=o.length>5?o[5]:void 0,i=k(t,"D",r,n,a,u,"future"),e.t0=check_whether_reach_limit,e.next=9,i;case 9:return e.t1=e.sent,e.t2=s.address,e.next=13,(0,e.t0)(e.t1,e.t2);case 13:return e.abrupt("return",i);case 14:case"end":return e.stop()}}),e)}))),_e.apply(this,arguments)}function we(e){return Se.apply(this,arguments)}function Se(){return(Se=i(regeneratorRuntime.mark((function e(t){var r,n,a,u,s,i,o,c,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return","Symbol cannot be empty");case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return","Symbol has to be a string");case 7:return t=t.toUpperCase(),n=link+"/excel/option?"+new URLSearchParams({ticker:t,api_key:r,function_name:"FS_OptionExpirationDates"}).toString(),e.next=12,fetch(n);case 12:if((a=e.sent).ok){e.next=24;break}return e.prev=14,e.next=17,a.text();case 17:return u=e.sent,e.abrupt("return",[[JSON.parse(u).error]]);case 21:return e.prev=21,e.t0=e.catch(14),e.abrupt("return",[["No data"]]);case 24:return e.next=26,a.json();case 26:if(!("message"in(s=e.sent))){e.next=29;break}return e.abrupt("return",[[s.message]]);case 29:if(i=s.data,o=[],i.constructor===Array)for(c=0;c<i.length;c++)p=i[c],o.push([p.expirationDate]);if(!(o.length<1)){e.next=34;break}return e.abrupt("return",[["No data"]]);case 34:return e.abrupt("return",o);case 35:case"end":return e.stop()}}),e,null,[[14,21]])})))).apply(this,arguments)}function Ne(){return(Ne=i(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=we(t),e.t0=check_whether_reach_limit,e.next=4,n;case 4:return e.t1=e.sent,e.t2=r.address,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Re(e,t,r,n){return Ce.apply(this,arguments)}function Ce(){return(Ce=i(regeneratorRuntime.mark((function e(t,r,n,u){var s,i,o,c,p,l,f,b,h,d,m,k,g,x,y,v,_,w,S,N,R,C,O,F,P,A,I,T,D,U,E,L,j;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return","Symbol cannot be empty");case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return","Symbol has to be a string");case 7:if(t=t.toUpperCase(),"string"==typeof r){e.next=10;break}return e.abrupt("return",'"type" has to be a string');case 10:if("call"==(r=r.toLowerCase())||"put"==r){e.next=13;break}return e.abrupt("return",[['"type" has to be call or put']]);case 13:if(n){e.next=15;break}return e.abrupt("return",[['"expirationDate" cannot be empty']]);case 15:if("string"==typeof n){e.next=17;break}return e.abrupt("return",[['"expirationDate" has to be a string']]);case 17:if(dateIsValid(n)){e.next=19;break}return e.abrupt("return",[['Invalid "expirationDate"']]);case 19:u||(u=[]),i={},e.prev=21,o=a(u);try{for(o.s();!(c=o.n()).done;)p=c.value,i[p[0].toString()]=p[1].toString()}catch(e){o.e(e)}finally{o.f()}e.next=29;break;case 26:return e.prev=26,e.t0=e.catch(21),e.abrupt("return",[['Invalid "options"']]);case 29:if(l={},f=!0,"false"==i.header&&(f=!1),i.metrics)if((b=i.metrics.split("&")).includes("all")){k=a(option_cols);try{for(k.s();!(g=k.n()).done;)m=g.value,l[m]=1}catch(e){k.e(e)}finally{k.f()}}else{h=a(b);try{for(h.s();!(d=h.n()).done;)m=d.value,option_cols.includes(m)&&(l[m]=1)}catch(e){h.e(e)}finally{h.f()}}else{x=a(option_cols);try{for(x.s();!(y=x.n()).done;)m=y.value,l[m]=1}catch(e){x.e(e)}finally{x.f()}}return v=link+"/excel/option?"+new URLSearchParams({ticker:t,api_key:s,function_name:"FS_OptionChain"}).toString(),e.next=37,fetch(v);case 37:if((_=e.sent).ok){e.next=49;break}return e.prev=39,e.next=42,_.text();case 42:return w=e.sent,e.abrupt("return",[[JSON.parse(w).error]]);case 46:return e.prev=46,e.t1=e.catch(39),e.abrupt("return",[["No data"]]);case 49:return e.next=51,_.json();case 51:if(!("message"in(S=e.sent))){e.next=54;break}return e.abrupt("return",[[S.message]]);case 54:if(N=S.data,R=[],N.constructor!==Array){e.next=68;break}C=0;case 58:if(!(C<N.length)){e.next=68;break}if((O=N[C]).expirationDate==n){e.next=62;break}return e.abrupt("continue",65);case 62:F=O.options[r.toUpperCase()],P=a(F);try{for(P.s();!(A=P.n()).done;){I=A.value,T=[],D=a(option_cols);try{for(D.s();!(U=D.n()).done;)(E=U.value)in l&&T.push(I[E]||0==I[E]?I[E]:"")}catch(e){D.e(e)}finally{D.f()}R.push(T)}}catch(e){P.e(e)}finally{P.f()}case 65:C++,e.next=58;break;case 68:if(!(R.length<1)){e.next=70;break}return e.abrupt("return",[["No data"]]);case 70:if(f){T=[],L=a(option_cols);try{for(L.s();!(j=L.n()).done;)(E=j.value)in l&&T.push(E)}catch(e){L.e(e)}finally{L.f()}R=[T].concat(R)}return e.abrupt("return",R);case 72:case"end":return e.stop()}}),e,null,[[21,26],[39,46]])})))).apply(this,arguments)}function Oe(){return Oe=i(regeneratorRuntime.mark((function e(t,r,n){var a,u,s,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.length>3&&void 0!==i[3]?i[3]:[],u=i.length>4?i[4]:void 0,s=Re(t,r,n,a),e.t0=check_whether_reach_limit,e.next=6,s;case 6:return e.t1=e.sent,e.t2=u.address,e.next=10,(0,e.t0)(e.t1,e.t2);case 10:return e.abrupt("return",s);case 11:case"end":return e.stop()}}),e)}))),Oe.apply(this,arguments)}function Fe(e){return Pe.apply(this,arguments)}function Pe(){return(Pe=i(regeneratorRuntime.mark((function e(t){var r,n,u,s,i,o,c,p,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:return t=t.toUpperCase(),n=link+"/excel/short-interest?"+new URLSearchParams({symbol:t,api_key:r,function_name:"FS_ShortInterest"}).toString(),e.next=12,fetch(n);case 12:if((u=e.sent).ok){e.next=24;break}return e.prev=14,e.next=17,u.text();case 17:return s=e.sent,e.abrupt("return",[[JSON.parse(s).error]]);case 21:return e.prev=21,e.t0=e.catch(14),e.abrupt("return",[["No data"]]);case 24:return e.next=26,u.json();case 26:if(!("message"in(i=e.sent))){e.next=29;break}return e.abrupt("return",[[i.message]]);case 29:if("No data"!==(o=i.data.data).status){e.next=32;break}return e.abrupt("return",[["No data"]]);case 32:c=[["Settlement Date","Short Interest","Short Ratio","Short % of Shares Outstanding"]],p=a(o);try{for(p.s();!(l=p.n()).done;)f=l.value,c.push([f.settlementDate,f.shortInterest,f.shortRatio,f.shortPercentOutstanding])}catch(e){p.e(e)}finally{p.f()}return e.abrupt("return",c);case 36:case"end":return e.stop()}}),e,null,[[14,21]])})))).apply(this,arguments)}function Ae(){return(Ae=i(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Fe(t),e.t0=check_whether_reach_limit,e.next=4,n;case 4:return e.t1=e.sent,e.t2=r.address,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ie(e,t,r,n,a){return Te.apply(this,arguments)}function Te(){return(Te=i(regeneratorRuntime.mark((function e(t,r,n,a,u){var s,i,o,c,p,l,f,b,h,d,m,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=r,i=readCookie("finsheet_api_key")){e.next=4;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 4:if(t){e.next=6;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 6:if("string"==typeof t){e.next=8;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 8:if(!(t=t.toUpperCase()).includes(".")||t in{"BRK.A":1,"BRK.B":1}){e.next=11;break}return e.abrupt("return",[["We only support US stocks for this function currently."]]);case 11:if(n){e.next=13;break}return e.abrupt("return",[["Limit cannot be empty"]]);case 13:if(a=a?a.toString():"0",s){e.next=16;break}return e.abrupt("return",[["'date' cannot be empty"]]);case 16:if("number"!=typeof s&&isNaN(s)){e.next=21;break}s<73e3&&(s=86400*(s-25569)),s=Math.round(s),e.next=24;break;case 21:if(s=Date.parse(s)/1e3,!(isNaN(s)||s<0)){e.next=24;break}return e.abrupt("return",[["Invalid 'date'"]]);case 24:if(!(1e3*s<Date.now()-316224e6)){e.next=26;break}return e.abrupt("return",[["'date' cannot be more that 10 years ago"]]);case 26:return s=new Date(1e3*s),o=s.getTimezoneOffset(),s=(s=new Date(s.getTime()-60*o*1e3)).toISOString().split("T")[0],c={ticker:t,from:s,limit:n.toString(),skip:a.toString(),api_key:i,function_name:"FS_EquityTick"},p=link+"/excel/equity_tick?"+new URLSearchParams(c).toString(),e.next=34,fetch(p);case 34:if((l=e.sent).ok){e.next=46;break}return e.prev=36,e.next=39,l.text();case 39:return f=e.sent,e.abrupt("return",[[JSON.parse(f).error]]);case 43:return e.prev=43,e.t0=e.catch(36),e.abrupt("return",[["No data"]]);case 46:return e.next=48,l.json();case 48:if(!("message"in(b=e.sent))){e.next=51;break}return e.abrupt("return",[[b.message]]);case 51:if(h=b.data,u||(u=""),d=u.toLowerCase().includes("ct"),e.prev=54,m=[["Count",h.count?h.count:"","Total",h.total?h.total:"",""],["Venue/Exchange","Timestamp","Price","Volume","Trade conditions"]],h.p){e.next=58;break}return e.abrupt("return","No data");case 58:if(h.p.constructor===Array)for(k=0;k<h.p.length;k++)m.push([h.x&&h.x[k]?h.x[k]in map_exchange_tick?map_exchange_tick[h.x[k]]:h.x[k]:"",h.t[k]?d?new Date(h.t[k]):parseInt(h.t[k]/1e3):"",h.p&&h.p[k]?h.p[k]:"",h.v&&(h.v[k]||0==h.v[k])?h.v[k]:"",h.c&&h.c[k]?h.c[k].join():""]);if(!(m.length<3)){e.next=61;break}return e.abrupt("return","No data");case 61:return e.abrupt("return",m);case 64:return e.prev=64,e.t1=e.catch(54),e.abrupt("return",[["No data"]]);case 67:case"end":return e.stop()}}),e,null,[[36,43],[54,64]])})))).apply(this,arguments)}function De(){return De=i(regeneratorRuntime.mark((function e(t,r,n){var a,u,s,i,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>3&&void 0!==o[3]?o[3]:void 0,u=o.length>4&&void 0!==o[4]?o[4]:void 0,s=o.length>5?o[5]:void 0,i=Ie(t,r,n,a,u),e.t0=check_whether_reach_limit,e.next=7,i;case 7:return e.t1=e.sent,e.t2=s.address,e.next=11,(0,e.t0)(e.t1,e.t2);case 11:return e.abrupt("return",i);case 12:case"end":return e.stop()}}),e)}))),De.apply(this,arguments)}function Ue(e,t,r,n){return Ee.apply(this,arguments)}function Ee(){return(Ee=i(regeneratorRuntime.mark((function e(t,r,n,u){var s,i,o,c,p,l,f,b,h,d,m,k,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(!t){e.next=19;break}if("number"!=typeof t&&isNaN(t)){e.next=10;break}t.toString().length>=12&&(t/=1e3),t=Math.round(t),e.next=13;break;case 10:if(t=Date.parse(t)/1e3,!(isNaN(t)||t<0)){e.next=13;break}return e.abrupt("return","Invalid 'date'");case 13:t=new Date(1e3*t),i=t.getTimezoneOffset(),t=(t=new Date(t.getTime()-60*i*1e3)).toISOString().split("T")[0],e.next=20;break;case 19:t="";case 20:if(!r){e.next=36;break}if("number"!=typeof r&&isNaN(r)){e.next=27;break}r.toString().length>=12&&(r/=1e3),r=Math.round(r),e.next=30;break;case 27:if(r=Date.parse(r)/1e3,!(isNaN(r)||r<0)){e.next=30;break}return e.abrupt("return","Invalid 'date'");case 30:r=new Date(1e3*r),o=r.getTimezoneOffset(),r=(r=new Date(r.getTime()-60*o*1e3)).toISOString().split("T")[0],e.next=37;break;case 36:r="";case 37:return n||(n=""),c=link+"/excel/earningscalendar?"+new URLSearchParams({ticker:n,from:t,to:r,api_key:s,international:u,function_name:"FS_EarningsCalendar"}).toString(),e.next=42,fetch(c);case 42:if((p=e.sent).ok){e.next=54;break}return e.prev=44,e.next=47,p.text();case 47:return l=e.sent,e.abrupt("return",[[JSON.parse(l).error]]);case 51:return e.prev=51,e.t0=e.catch(44),e.abrupt("return",[["No data"]]);case 54:return e.next=56,p.json();case 56:if(!("message"in(f=e.sent))){e.next=59;break}return e.abrupt("return",[[f.message]]);case 59:b=(b=f.data).earningsCalendar,h=[["Date","Hour","Symbol","Revenue Actual","Revenue Estimate","EPS Actual","EPS Estimate","Reporting period"]],d={bmo:"Before Market Open",amc:"After Market Close",dmh:"During Market Hour"},m=a(b);try{for(m.s();!(k=m.n()).done;)g=k.value,h.push([g.date,g.hour in d?d[g.hour]:g.hour,g.symbol,g.revenueActual?g.revenueActual:"",g.revenueEstimate?g.revenueEstimate:"",g.epsActual?g.epsActual:"",g.epsEstimate?g.epsEstimate:"","Q"+g.quarter+"/"+g.year])}catch(e){m.e(e)}finally{m.f()}if(!(h.length<2)){e.next=67;break}return e.abrupt("return",[["No data"]]);case 67:return e.abrupt("return",h);case 68:case"end":return e.stop()}}),e,null,[[44,51]])})))).apply(this,arguments)}function Le(){return(Le=i(regeneratorRuntime.mark((function e(t,r,n,a,u){var s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=Ue(t,r,n,a),e.t0=check_whether_reach_limit,e.next=4,s;case 4:return e.t1=e.sent,e.t2=u.address,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function je(e){return Me.apply(this,arguments)}function Me(){return(Me=i(regeneratorRuntime.mark((function e(t){var r,n,u,s,i,o,c,p,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Guru name cannot be empty"]]);case 5:if(t.toLowerCase()in reversed_map_url_guru){e.next=7;break}return e.abrupt("return",[["This guru/institution is not currently supported"]]);case 7:return n=link+"/excel/institutional-holding?"+new URLSearchParams({guru:t,is_gs:"y",api_key:r,function_name:"FS_InstitutionalPortfolios"}).toString(),e.next=11,fetch(n);case 11:if((u=e.sent).ok){e.next=23;break}return e.prev=13,e.next=16,u.text();case 16:return s=e.sent,e.abrupt("return",[[JSON.parse(s).error]]);case 20:return e.prev=20,e.t0=e.catch(13),e.abrupt("return",[["No data"]]);case 23:return e.next=25,u.json();case 25:if(!("message"in(i=e.sent))){e.next=28;break}return e.abrupt("return",[[i.message]]);case 28:o=i.data,e.prev=29,c=[],p=a(o);try{for(p.s();!(l=p.n()).done;)(f=l.value).ticker&&"--"!==f.ticker&&c.push([f.ticker])}catch(e){p.e(e)}finally{p.f()}if(!(c.length<1)){e.next=35;break}return e.abrupt("return",[["No data"]]);case 35:return e.abrupt("return",c);case 38:return e.prev=38,e.t1=e.catch(29),e.abrupt("return",[["No data"]]);case 41:case"end":return e.stop()}}),e,null,[[13,20],[29,38]])})))).apply(this,arguments)}function Je(){return(Je=i(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=je(t),e.t0=check_whether_reach_limit,e.next=4,n;case 4:return e.t1=e.sent,e.t2=r.address,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Be(e,t,r,n,a){return Ve.apply(this,arguments)}function Ve(){return(Ve=i(regeneratorRuntime.mark((function e(t,r,n,u,s){var i,o,c,p,l,f,b,h,d,m,k,g,x,y,v,_,w,S,N,R,C,O,F;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["symbol cannot be empty"]]);case 5:if(r){e.next=7;break}return e.abrupt("return",[["from cannot be empty"]]);case 7:if(n){e.next=9;break}return e.abrupt("return",[["to cannot be empty"]]);case 9:if(!r){e.next=25;break}if("number"!=typeof r&&isNaN(r)){e.next=16;break}r.toString().length>=12&&(r/=1e3),r=Math.round(r),e.next=19;break;case 16:if(r=Date.parse(r)/1e3,!(isNaN(r)||r<0)){e.next=19;break}return e.abrupt("return","Invalid 'date'");case 19:r=new Date(1e3*r),o=r.getTimezoneOffset(),r=(r=new Date(r.getTime()-60*o*1e3)).toISOString().split("T")[0],e.next=26;break;case 25:r="";case 26:if(!n){e.next=42;break}if("number"!=typeof n&&isNaN(n)){e.next=33;break}n.toString().length>=12&&(n/=1e3),n=Math.round(n),e.next=36;break;case 33:if(n=Date.parse(n)/1e3,!(isNaN(n)||n<0)){e.next=36;break}return e.abrupt("return","Invalid 'date'");case 36:n=new Date(1e3*n),c=n.getTimezoneOffset(),n=(n=new Date(n.getTime()-60*c*1e3)).toISOString().split("T")[0],e.next=43;break;case 42:n="";case 43:return p=link+"/excel/dividend?"+new URLSearchParams({ticker:t,from:r,to:n,api_key:i,function_name:"FS_Dividends"}).toString(),e.next=47,fetch(p);case 47:if((l=e.sent).ok){e.next=59;break}return e.prev=49,e.next=52,l.text();case 52:return f=e.sent,e.abrupt("return",[[JSON.parse(f).error]]);case 56:return e.prev=56,e.t0=e.catch(49),e.abrupt("return",[["No data"]]);case 59:return e.next=61,l.json();case 61:if(!("message"in(b=e.sent))){e.next=64;break}return e.abrupt("return",[[b.message]]);case 64:if(h=b.data,s||(s=""),d=s.toLowerCase().includes("nh"),m=s.toLowerCase().includes("-"),k=[],g={declarationDate:1,recordDate:1,payDate:1,amount:1,adjustedAmount:1,currency:1},u&&"all"!=u&&"All"!=u&&"ALL"!=u){x=u.split("&"),y=a(x);try{for(y.s();!(v=y.n()).done;)_=v.value,(w=_)in g&&k.push(w)}catch(e){y.e(e)}finally{y.f()}}else k=["declarationDate","recordDate","payDate","amount","adjustedAmount","currency"];for(S=[],N=0;N<h.length;N++){R=h[N],C=[],O=a(k);try{for(O.s();!(F=O.n()).done;)_=F.value,C.push(R[_]?R[_]:"")}catch(e){O.e(e)}finally{O.f()}S.push(C)}if(!(S.length<1)){e.next=75;break}return e.abrupt("return",[["No data"]]);case 75:return m&&S.reverse(),d||(S=[k].concat(S)),e.abrupt("return",S);case 78:case"end":return e.stop()}}),e,null,[[49,56]])})))).apply(this,arguments)}function qe(){return(qe=i(regeneratorRuntime.mark((function e(t,r,n,a,u,s){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Be(t,r,n,a,u),e.t0=check_whether_reach_limit,e.next=4,i;case 4:return e.t1=e.sent,e.t2=s.address,e.next=8,(0,e.t0)(e.t1,e.t2);case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}window.OldBigSymbolPriceMap={},window.BigSymbolPriceMap={},window.EachCellStreamingValue={},window.Should_Update_Streaming=!0,window.have_not_reconnect_websocket=!0,window.have_not_add_on_calculated_trigger=!0,window.have_not_set_interval_change_color=!0,window.can_call_streaming=!0,Q(),window.Cells_to_refresh={},window.Sheet_to_refresh={},window.have_not_start_refresh_limit_reach=1,CustomFunctions.associate("FS_TEST",(function(e){return l.apply(this,arguments)})),CustomFunctions.associate("FS_EQUITYMETRICS",(function(e,t){return f.apply(this,arguments)})),CustomFunctions.associate("FS_EQUITYFULLFINANCIALS",(function(e,t){return b.apply(this,arguments)})),CustomFunctions.associate("FS_EQUITYCANDLES",(function(e,t){return x.apply(this,arguments)})),CustomFunctions.associate("FS_FOREXCANDLES",(function(e,t){return y.apply(this,arguments)})),CustomFunctions.associate("FS_CRYPTOCANDLES",(function(e,t){return v.apply(this,arguments)})),CustomFunctions.associate("FS_ETFCANDLES",(function(e,t){return _.apply(this,arguments)})),CustomFunctions.associate("FS_MUTUALFUNDCANDLES",(function(e,t){return w.apply(this,arguments)})),CustomFunctions.associate("FS_FOREXALLRATES",(function(){return R.apply(this,arguments)})),CustomFunctions.associate("FS_CRYPTOPROFILE",(function(e,t){return P.apply(this,arguments)})),CustomFunctions.associate("FS_ETFPROFILE",(function(e,t){return D.apply(this,arguments)})),CustomFunctions.associate("FS_MUTUALFUNDPROFILE",(function(e,t){return j.apply(this,arguments)})),CustomFunctions.associate("FS_ETFHOLDINGS",(function(e,t,r){return V.apply(this,arguments)})),CustomFunctions.associate("FS_MUTUALFUNDHOLDINGS",(function(e,t,r){return q.apply(this,arguments)})),CustomFunctions.associate("FS_LATEST",(function(e,t){return G.apply(this,arguments)})),CustomFunctions.associate("FS_STREAMING",(function(e,t){return z.apply(this,arguments)})),CustomFunctions.associate("FS_PATTERNRECOGNITION",(function(e,t,r){return X.apply(this,arguments)})),CustomFunctions.associate("FS_SUPPORTRESISTANCE",(function(e,t,r){return ee.apply(this,arguments)})),CustomFunctions.associate("FS_AGGREGATEINDICATORS",(function(e,t,r){return ne.apply(this,arguments)})),CustomFunctions.associate("FS_TECHNICALINDICATORS",(function(e,t,r,n){return se.apply(this,arguments)})),CustomFunctions.associate("FS_ESG",(function(e,t){return ce.apply(this,arguments)})),CustomFunctions.associate("FS_EARNINGSQUALITY",(function(e,t,r,n){return fe.apply(this,arguments)})),CustomFunctions.associate("FS_API",(function(e,t){return de.apply(this,arguments)})),CustomFunctions.associate("FS_BONDCANDLES",(function(e){return ge.apply(this,arguments)})),CustomFunctions.associate("FS_BONDTICK",(function(e){return ve.apply(this,arguments)})),CustomFunctions.associate("FS_FUTURESCANDLES",(function(e){return _e.apply(this,arguments)})),CustomFunctions.associate("FS_OPTIONEXPIRATIONDATES",(function(e,t){return Ne.apply(this,arguments)})),CustomFunctions.associate("FS_OPTIONCHAIN",(function(e,t,r){return Oe.apply(this,arguments)})),CustomFunctions.associate("FS_SHORTINTEREST",(function(e,t){return Ae.apply(this,arguments)})),CustomFunctions.associate("FS_EQUITYTICK",(function(e,t,r){return De.apply(this,arguments)})),CustomFunctions.associate("FS_EARNINGSCALENDAR",(function(e,t,r,n,a){return Le.apply(this,arguments)})),CustomFunctions.associate("FS_INSTITUTIONALPORTFOLIOS",(function(e,t){return Je.apply(this,arguments)})),CustomFunctions.associate("FS_DIVIDENDS",(function(e,t,r,n,a,u){return qe.apply(this,arguments)}))}();
//# sourceMappingURL=functions.js.map