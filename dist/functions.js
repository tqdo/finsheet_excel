!function(){function e(r){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(r)}function r(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function t(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(r){n(e,r,a[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))}))}return e}function n(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function a(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,r){if(e){if("string"==typeof e)return s(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?s(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,o=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return u=e.done,e},e:function(e){o=!0,i=e},f:function(){try{u||null==t.return||t.return()}finally{if(o)throw i}}}}function s(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function i(e,r,t,n,a,s,i){try{var u=e[s](i),o=u.value}catch(e){return void t(e)}u.done?r(o):Promise.resolve(o).then(n,a)}function u(e){return function(){var r=this,t=arguments;return new Promise((function(n,a){var s=e.apply(r,t);function u(e){i(s,n,a,u,o,"next",e)}function o(e){i(s,n,a,u,o,"throw",e)}u(void 0)}))}}function o(e){return e.charAt(0).toUpperCase()+e.slice(1)}function c(e,r){return p.apply(this,arguments)}function p(){return p=u(regeneratorRuntime.mark((function e(r,n){var s,i,u,o,c,p,l,b,f,d,h,m,g,k,y,x,v,S,w,_,N,C,R,O,P=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=P.length>2&&void 0!==P[2]?P[2]:void 0,i=P.length>3&&void 0!==P[3]?P[3]:void 0,u=P.length>4&&void 0!==P[4]?P[4]:void 0,o=u,null==s&&(s=void 0),null==i&&(i=void 0),c=readCookie("finsheet_api_key"),p=s,l=r,c){e.next=11;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 11:if(console.log("ticker",l),Array.isArray(l)&&(Array.isArray(l[0])?1===l.length&&1===l[0].length&&(l=l[0][0]):l=l[0]),b={},console.log("ticker",l),Array.isArray(l)){e.next=25;break}if(l){e.next=18;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 18:if("string"==typeof l){e.next=20;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 20:if(!l.includes(",")&&!l.includes(";")){e.next=22;break}return e.abrupt("return",["Invalid symbol"]);case 22:l=l.toUpperCase(),e.next=33;break;case 25:if(void 0===i||1===i||""===i){e.next=27;break}return e.abrupt("return",[["To get data for multiple stocks, limit has to be 1 or empty."]]);case 27:f=a(l);try{for(f.s();!(d=f.n()).done;){h=d.value,m=a(h);try{for(m.s();!(g=m.n()).done;)(k=g.value)&&(b[k]=1)}catch(e){m.e(e)}finally{m.f()}}}catch(e){f.e(e)}finally{f.f()}if(!(Object.keys(b).length<1)){e.next=31;break}return e.abrupt("return",[["Symbols cannot be empty"]]);case 31:if(!(Object.keys(b).length>100)){e.next=33;break}return e.abrupt("return",[["Too many symbols, maximum is 100 each time."]]);case 33:if(n){e.next=35;break}return e.abrupt("return",[["Metric cannot be empty"]]);case 35:if((n=n.toLowerCase())in map_excel_name_to_id||["bs","cf","ic"].includes(n)){e.next=38;break}return e.abrupt("return",[["Unsupported metric"]]);case 38:if("price_latest"!==n||!Array.isArray(l)){e.next=40;break}return e.abrupt("return",[["This metric does not support multiple symbols at the same time."]]);case 40:if(""===p&&(p=void 0),"string"==typeof p||void 0===p){e.next=43;break}return e.abrupt("return",[["Period has to be a string"]]);case 43:if(""===i&&(i=void 0),"number"==typeof i||void 0===i){e.next=46;break}return e.abrupt("return",[["Limit has to be a positive integer"]]);case 46:if(!(void 0!==i&&i<=0)){e.next=48;break}return e.abrupt("return",[["Limit has to be a positive integer"]]);case 48:if(y=n in map_excel_name_to_id?map_excel_name_to_id[n]:n,x=["bs","cf","ic"].includes(y),void 0!==p||!x&&!map_metrics[y].default_freq){e.next=54;break}p=["cf","ic"].includes(y)?"TTM":"bs"===y?"Q":map_metrics[y].default_freq,e.next=67;break;case 54:if(x||map_metrics[y].default_freq||void 0===p){e.next=58;break}return e.abrupt("return",[["This metric does not support periods"]]);case 58:if(void 0===p){e.next=67;break}if(p=p.toUpperCase(),!["bs","ic"].includes(y)||!p.includes("YTD")){e.next=62;break}return e.abrupt("return",[["Period YTD is only available for cf"]]);case 62:if("bs"!==y||!p.includes("TTM")){e.next=64;break}return e.abrupt("return",[["Period TTM is only available for ic and cf"]]);case 64:if(x?(v="cf"===y?["FY","TTM","Q","YTD"]:"bs"===y?["FY","Q"]:["FY","TTM","Q"],p=isValidFreq_returnCleanString(p,v,"TTM",y)):p=!!map_metrics[y].default_freq&&isValidFreq_returnCleanString(p,map_metrics[y].supported_freq,map_metrics[y].default_freq,y),!1!==p){e.next=67;break}return e.abrupt("return",[["Invalid period"]]);case 67:return!x&&["TTM","FY","Q","YTD"].includes(p)&&i&&i>1?p+="@"+i:x||(i="undefined"),S={},x||(w={field_code:y},"-1"!==p&&""!==p&&void 0!==p&&(w.period=p),S=generate_query(1,"watchlist",[],[w],[],["",""],l,[w],Array.isArray(l)?Object.keys(b):[l])),S=t(t({},S),{ticker:Array.isArray(l)?"["+Object.keys(b).length.toString():l,metric:y,freq:p,api_key:c,limit:i?i.toString():"undefined",is_full_statement:x?"y":"n"}),206==y&&(S.is_latest_price="1"),console.log("ticker",l),_={api_key:c,limit:i,is_full_statement:x?"y":"n",freq:p,is_share:"37"==y?"y":"n"},N=link+"/excel/standard?"+new URLSearchParams(_).toString(),e.next=77,fetch(N,{method:"POST",body:JSON.stringify(S)});case 77:if((C=e.sent).ok){e.next=89;break}return e.next=81,C.text();case 81:return R=e.sent,e.prev=82,e.abrupt("return",[[JSON.parse(R).error]]);case 86:return e.prev=86,e.t0=e.catch(82),e.abrupt("return",[["Rate limit reached. Please try again later."]]);case 89:return e.next=91,C.json();case 91:if(O=e.sent,console.log(O),!("message"in O)){e.next=95;break}return e.abrupt("return",[[O.message]]);case 95:return e.abrupt("return",handle_receive_AR_EQUITY(O,x,y,l,b,o));case 96:case"end":return e.stop()}}),e,null,[[82,86]])}))),p.apply(this,arguments)}function l(){return(l=u(regeneratorRuntime.mark((function e(r){var t,n,s,i,u,o,c,p,l,b,f,d,h,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[[""]]);case 5:if(n=r,Array.isArray(n)&&(Array.isArray(n[0])?1===n.length&&1===n[0].length&&(n=n[0][0]):n=n[0]),Array.isArray(n)){e.next=11;break}n=[[n]],e.next=12;break;case 11:return e.abrupt("return",[["Multiple tickers are not allowed."]]);case 12:s={},i=a(n);try{for(i.s();!(u=i.n()).done;){o=u.value,c=a(o);try{for(c.s();!(p=c.n()).done;)(l=p.value)&&(s[l]=1)}catch(e){c.e(e)}finally{c.f()}}}catch(e){i.e(e)}finally{i.f()}if(!(Object.keys(s).length<1)){e.next=17;break}return e.abrupt("return",[["Symbols cannot be empty"]]);case 17:if(!(Object.keys(s).length>100)){e.next=19;break}return e.abrupt("return",[["Too many symbols, maximum is 100 each time."]]);case 19:return b={ticker:Object.keys(s),api_key:t},f=link+"/excel/latest?"+new URLSearchParams({api_key:t}).toString(),e.next=24,fetch(f,{method:"POST",body:JSON.stringify(b)});case 24:if((d=e.sent).ok){e.next=36;break}return e.prev=26,e.next=29,d.text();case 29:return h=e.sent,e.abrupt("return",[[JSON.parse(h).error]]);case 33:return e.prev=33,e.t0=e.catch(26),e.abrupt("return",[["No data"]]);case 36:return e.next=38,d.json();case 38:if(!("message"in(m=e.sent))){e.next=41;break}return e.abrupt("return",[[m.message]]);case 41:return e.abrupt("return",[[m.data]]);case 42:case"end":return e.stop()}}),e,null,[[26,33]])})))).apply(this,arguments)}function b(){return b=u(regeneratorRuntime.mark((function e(r,t){var n,a,s,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>2&&void 0!==i[2]?i[2]:void 0,a=i.length>3&&void 0!==i[3]?i[3]:void 0,s=i.length>4&&void 0!==i[4]?i[4]:void 0,t){e.next=5;break}return e.abrupt("return",[["Metric cannot be empty"]]);case 5:if((t=t.toLowerCase())in map_excel_name_to_id){e.next=8;break}return e.abrupt("return",[["Unsupported metric"]]);case 8:if(r){e.next=10;break}return e.abrupt("return",[[""]]);case 10:return e.abrupt("return",c(r,t,n,a,s));case 11:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}function f(){return f=u(regeneratorRuntime.mark((function e(r,t){var n,a,s,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>2&&void 0!==i[2]?i[2]:void 0,a=i.length>3&&void 0!==i[3]?i[3]:void 0,s=t){e.next=5;break}return e.abrupt("return",[["Metric cannot be empty"]]);case 5:if(s=s.toLowerCase(),["bs","cf","ic"].includes(s)){e.next=8;break}return e.abrupt("return",[["Unsupported metric"]]);case 8:return e.abrupt("return",c(r,s,n,a));case 9:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}var d={1:1,5:1,15:1,30:1,60:1,D:1,W:1,M:1,d:1,w:1,m:1},h={d:1,w:1,m:1},m=["close","open","high","low","volume"];function g(e,r,t){return k.apply(this,arguments)}function k(){return k=u(regeneratorRuntime.mark((function e(r,t,n){var s,i,u,c,p,l,b,f,g,k,y,x,v,S,w,_,N,C,R,O,P,A,I,T,F,D,U=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=U.length>3&&void 0!==U[3]?U[3]:void 0,i=U.length>4&&void 0!==U[4]?U[4]:void 0,u=U.length>5&&void 0!==U[5]?U[5]:void 0,c=U.length>6&&void 0!==U[6]?U[6]:"stock",null==s&&(s=void 0),console.log(n,s),p=readCookie("finsheet_api_key")){e.next=9;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 9:if(r){e.next=11;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 11:if("string"==typeof r){e.next=13;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 13:if(!r.includes(",")&&!r.includes(";")){e.next=15;break}return e.abrupt("return",["Invalid symbol"]);case 15:if(r=r.toUpperCase(),t in d){e.next=18;break}return e.abrupt("return",[["Invalid resolution"]]);case 18:if(t in h&&(t=t.toUpperCase()),l=Date.parse(new Date)/1e3,n){e.next=22;break}return e.abrupt("return",[["'from' cannot be empty"]]);case 22:if("number"!=typeof n&&isNaN(n)){e.next=27;break}n<73e3&&(n=86400*(n-25569)),n=Math.round(n),e.next=30;break;case 27:if(n=Date.parse(n)/1e3,!(isNaN(n)||n<0)){e.next=30;break}return e.abrupt("return",[["Invalid 'from'"]]);case 30:if(""!=s&&void 0!==s){e.next=34;break}s=l,e.next=42;break;case 34:if("number"!=typeof s&&isNaN(s)){e.next=39;break}s<73e3&&(s=86400*(s-25569)),s=Math.round(s),e.next=42;break;case 39:if(s=Date.parse(s)/1e3,!(isNaN(s)||s<0)){e.next=42;break}return e.abrupt("return",[["Invalid 'to'"]]);case 42:if(!(s<=n)){e.next=44;break}return e.abrupt("return",[["'to' has to be after 'from'"]]);case 44:return console.log(n,s),b={ticker:r,resolution:t,from:n,to:s,api_key:p,properties:JSON.stringify(m),which:c},f=link+"/excel/candles?"+new URLSearchParams(b).toString(),e.next=49,fetch(f);case 49:if((g=e.sent).ok){e.next=61;break}return e.prev=51,e.next=54,g.text();case 54:return k=e.sent,e.abrupt("return",[[JSON.parse(k).error]]);case 58:return e.prev=58,e.t0=e.catch(51),e.abrupt("return",[["No data"]]);case 61:return e.next=63,g.json();case 63:if(!("message"in(y=e.sent))){e.next=66;break}return e.abrupt("return",[[y.message]]);case 66:if(x=y.data,u||(u=""),v=u.toLowerCase().includes("nh"),S=u.toLowerCase().includes("-"),w=[],_={Period:"t",Open:"o",High:"h",Low:"l",Close:"c",Volume:"v"},i&&"all"!=i&&"All"!=i&&"ALL"!=i){N=i.split("&"),C=a(N);try{for(C.s();!(R=C.n()).done;)O=R.value,(P=o(O.toLowerCase()))in _&&w.push(P)}catch(e){C.e(e)}finally{C.f()}}else w=["Period","Open","High","Low","Close","Volume"];if(A=[],x.c){e.next=76;break}return e.abrupt("return",[["No data"]]);case 76:if(x.c.constructor===Array)for(I=0;I<x.c.length;I++){T=[],F=a(w);try{for(F.s();!(D=F.n()).done;)"Period"==(O=D.value)?T.push(x.t&&x.t[I]?new Date(1e3*x.t[I]):""):T.push(x[_[O]]&&x[_[O]][I]?x[_[O]][I]:"")}catch(e){F.e(e)}finally{F.f()}A.push(T)}else A.push([x.t?new Date(1e3*x.t):"",x.o?x.o:"",x.h?x.h:"",x.l?x.l:"",x.c?x.c:"",x.v?x.v:""]);if(!(A.length<1)){e.next=79;break}return e.abrupt("return",[["No data"]]);case 79:return S&&A.reverse(),v||(A=[w].concat(A)),e.abrupt("return",A);case 82:case"end":return e.stop()}}),e,null,[[51,58]])}))),k.apply(this,arguments)}function y(){return y=u(regeneratorRuntime.mark((function e(r,t){var n,a,s,i,u=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>2&&void 0!==u[2]?u[2]:void 0,a=u.length>3&&void 0!==u[3]?u[3]:void 0,s=u.length>4&&void 0!==u[4]?u[4]:void 0,i=u.length>5&&void 0!==u[5]?u[5]:void 0,e.abrupt("return",g(r,t,n,a,s,i,"stock"));case 5:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}function x(){return x=u(regeneratorRuntime.mark((function e(r,t){var n,a,s,i,u=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>2&&void 0!==u[2]?u[2]:void 0,a=u.length>3&&void 0!==u[3]?u[3]:void 0,s=u.length>4&&void 0!==u[4]?u[4]:void 0,i=u.length>5&&void 0!==u[5]?u[5]:void 0,e.abrupt("return",g(r,t,n,a,s,i,"forex"));case 5:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}function v(){return v=u(regeneratorRuntime.mark((function e(r,t){var n,a,s,i,u=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>2&&void 0!==u[2]?u[2]:void 0,a=u.length>3&&void 0!==u[3]?u[3]:void 0,s=u.length>4&&void 0!==u[4]?u[4]:void 0,i=u.length>5&&void 0!==u[5]?u[5]:void 0,e.abrupt("return",g(r,t,n,a,s,i,"crypto"));case 5:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}function S(){return S=u(regeneratorRuntime.mark((function e(r,t){var n,a,s,i,u=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>2&&void 0!==u[2]?u[2]:void 0,a=u.length>3&&void 0!==u[3]?u[3]:void 0,s=u.length>4&&void 0!==u[4]?u[4]:void 0,i=u.length>5&&void 0!==u[5]?u[5]:void 0,e.abrupt("return",g(r,t,n,a,s,i,"etf"));case 5:case"end":return e.stop()}}),e)}))),S.apply(this,arguments)}function w(){return w=u(regeneratorRuntime.mark((function e(r,t){var n,a,s,i,u=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>2&&void 0!==u[2]?u[2]:void 0,a=u.length>3&&void 0!==u[3]?u[3]:void 0,s=u.length>4&&void 0!==u[4]?u[4]:void 0,i=u.length>5&&void 0!==u[5]?u[5]:void 0,e.abrupt("return",g(r,t,n,a,s,i,"mutual_fund"));case 5:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function _(){return _=u(regeneratorRuntime.mark((function e(){var r,t,n,a,s,i,u,o,c,p,l,b,f=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=f.length>0&&void 0!==f[0]?f[0]:"USD",t=readCookie("finsheet_api_key")){e.next=4;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 4:return n={base_currency:r,api_key:t},a=link+"/excel/forex_all_rates?"+new URLSearchParams(n).toString(),e.next=8,fetch(a);case 8:if((s=e.sent).ok){e.next=20;break}return e.prev=10,e.next=13,s.text();case 13:return i=e.sent,e.abrupt("return",[[JSON.parse(i).error]]);case 17:return e.prev=17,e.t0=e.catch(10),e.abrupt("return",[["No data"]]);case 20:return e.next=22,s.json();case 22:if(!("message"in(u=e.sent))){e.next=25;break}return e.abrupt("return",[[u.message]]);case 25:for(o=u.data,c=[],p=0,l=Object.keys(o);p<l.length;p++)b=l[p],c.push([b,o[b]]);return e.abrupt("return",c);case 29:case"end":return e.stop()}}),e,null,[[10,17]])}))),_.apply(this,arguments)}var N={name:"Name",longName:"Full Name",description:"Description",marketCap:"Market Capitalization",totalSupply:"Total Supply",maxSupply:"Max Supply",circulatingSupply:"Circulating Supply",launchDate:"Launch Date",website:"Website",proofType:"Proof Type"};function C(){return(C=u(regeneratorRuntime.mark((function e(r){var t,n,a,s,i,u,o,c,p,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(!r.includes(":")){e.next=9;break}return e.abrupt("return",[["Invalid symbol, make sure it does not include exchange name"]]);case 9:return r=r.toUpperCase(),n=link+"/excel/asset_profile?"+new URLSearchParams({symbol:r,api_key:t,which:"crypto_profile"}).toString(),e.next=14,fetch(n);case 14:if((a=e.sent).ok){e.next=26;break}return e.prev=16,e.next=19,a.text();case 19:return s=e.sent,e.abrupt("return",[[JSON.parse(s).error]]);case 23:return e.prev=23,e.t0=e.catch(16),e.abrupt("return",[["No data"]]);case 26:return e.next=28,a.json();case 28:if(!("message"in(i=e.sent))){e.next=31;break}return e.abrupt("return",[[i.message]]);case 31:for(u=i.data,o=[],c=0,p=Object.keys(N);c<p.length;c++)l=p[c],u[l]&&o.push([N[l],u[l]]);return e.abrupt("return",o);case 35:case"end":return e.stop()}}),e,null,[[16,23]])})))).apply(this,arguments)}var R={assetClass:"Asset Class",aum:"AUM",avgVolume:"Avg Volume",cusip:"CUSIP",description:"Description",domicile:"Domicile",etfCompany:"ETF Issuer",expenseRatio:"Expense Ratio",inceptionDate:"Inception Date",investmentSegment:"Investment Segment",isin:"ISIN",name:"Name",nav:"NAV",navCurrency:"NAV Currency",priceToBook:"P/B",priceToEarnings:"P/E",trackingIndex:"Tracking Index",website:"Website"};function O(){return(O=u(regeneratorRuntime.mark((function e(r){var t,n,a,s,i,u,o,c,p,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:return r=r.toUpperCase(),n=link+"/excel/asset_profile?"+new URLSearchParams({symbol:r,api_key:t,which:"etf_profile"}).toString(),e.next=12,fetch(n);case 12:if((a=e.sent).ok){e.next=24;break}return e.prev=14,e.next=17,a.text();case 17:return s=e.sent,e.abrupt("return",[[JSON.parse(s).error]]);case 21:return e.prev=21,e.t0=e.catch(14),e.abrupt("return",[["No data"]]);case 24:return e.next=26,a.json();case 26:if(!("message"in(i=e.sent))){e.next=29;break}return e.abrupt("return",[[i.message]]);case 29:for(u=i.data.profile,o=[],i.data.symbol&&(o=[["Symbol",i.data.symbol]]),c=0,p=Object.keys(R);c<p.length;c++)l=p[c],u[l]&&o.push([R[l],u[l]]);return e.abrupt("return",o);case 34:case"end":return e.stop()}}),e,null,[[14,21]])})))).apply(this,arguments)}var P={benchmark:"Benchmark",beta:"Beta",category:"Category",description:"Description",expenseRatio:"Expense Ratio",fundFamily:"Fund Family",inceptionDate:"Inception Date",investmentSegment:"Investment Segment",name:"Full Name",totalNav:"Total NAV",turnover:"Turnover"};function A(){return(A=u(regeneratorRuntime.mark((function e(r){var t,n,a,s,i,u,o,c,p,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:return r=r.toUpperCase(),n=link+"/excel/asset_profile?"+new URLSearchParams({symbol:r,api_key:t,which:"mutual_fund_profile"}).toString(),e.next=12,fetch(n);case 12:if((a=e.sent).ok){e.next=24;break}return e.prev=14,e.next=17,a.text();case 17:return s=e.sent,e.abrupt("return",[[JSON.parse(s).error]]);case 21:return e.prev=21,e.t0=e.catch(14),e.abrupt("return",[["No data"]]);case 24:return e.next=26,a.json();case 26:if(!("message"in(i=e.sent))){e.next=29;break}return e.abrupt("return",[[i.message]]);case 29:for(u=i.data.profile,o=[],i.data.symbol&&(o=[["Symbol",i.data.symbol]]),c=0,p=Object.keys(P);c<p.length;c++)l=p[c],u[l]&&o.push([P[l],u[l]]);return e.abrupt("return",o);case 34:case"end":return e.stop()}}),e,null,[[14,21]])})))).apply(this,arguments)}function I(e,r,t){return T.apply(this,arguments)}function T(){return(T=u(regeneratorRuntime.mark((function e(r,t,n){var s,i,u,o,c,p,l,b,f,d,h,m,g,k,y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(r=r.toUpperCase(),null!=t&&""!==t||(t=0),"number"==typeof t||void 0===t){e.next=11;break}return e.abrupt("return","skip has to be an integer");case 11:return i={symbol:r,skip:t.toString(),api_key:s,which:n},u=link+"/excel/asset_holdings?"+new URLSearchParams(i).toString(),e.next=15,fetch(u);case 15:if((o=e.sent).ok){e.next=27;break}return e.prev=17,e.next=20,o.text();case 20:return c=e.sent,e.abrupt("return",[[JSON.parse(c).error]]);case 24:return e.prev=24,e.t0=e.catch(17),e.abrupt("return",[["No data"]]);case 27:return e.next=29,o.json();case 29:if(!("message"in(p=e.sent))){e.next=32;break}return e.abrupt("return",p.message);case 32:e.prev=32,l=[["Date",p.data.atDate,"","","","",""],["Symbol","CUSIP","ISIN","Name","Percent","Share","Value"]],b=p.data.holdings,f=a(b);try{for(f.s();!(d=f.n()).done;){for(h=d.value,m=[],g=0,k=Object.keys(F);g<k.length;g++)y=k[g],null!==h[y]&&void 0!==h[y]?m.push(h[y]):m.push("");l.push(m)}}catch(e){f.e(e)}finally{f.f()}return e.abrupt("return",l.length>2?l:[]);case 40:return e.prev=40,e.t1=e.catch(32),e.abrupt("return",[["No data"]]);case 43:case"end":return e.stop()}}),e,null,[[17,24],[32,40]])})))).apply(this,arguments)}var F={symbol:"Symbol",cusip:"CUSIP",isin:"ISIN",name:"Name",percent:"Percent",share:"Share",value:"Value"};function D(){return(D=u(regeneratorRuntime.mark((function e(r,t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",I(r,t,"etf_holdings"));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(){return(U=u(regeneratorRuntime.mark((function e(r,t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",I(r,t,"mutual_fund_holdings"));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){return(E=u(regeneratorRuntime.mark((function e(r){var t,n,s,i,u,o,c,p,l,b,f,d,h,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[[""]]);case 5:if(n=r,Array.isArray(n)&&(Array.isArray(n[0])?1===n.length&&1===n[0].length&&(n=n[0][0]):n=n[0]),Array.isArray(n)){e.next=11;break}n=[[n]],e.next=12;break;case 11:return e.abrupt("return",[["Multiple tickers are not allowed."]]);case 12:s={},i=a(n);try{for(i.s();!(u=i.n()).done;){o=u.value,c=a(o);try{for(c.s();!(p=c.n()).done;)(l=p.value)&&(s[l]=1)}catch(e){c.e(e)}finally{c.f()}}}catch(e){i.e(e)}finally{i.f()}if(!(Object.keys(s).length<1)){e.next=17;break}return e.abrupt("return",[["Symbols cannot be empty"]]);case 17:if(!(Object.keys(s).length>100)){e.next=19;break}return e.abrupt("return",[["Too many symbols, maximum is 100 each time."]]);case 19:return b={ticker:Object.keys(s),api_key:t},f=link+"/excel/latest?"+new URLSearchParams({api_key:t}).toString(),e.next=24,fetch(f,{method:"POST",body:JSON.stringify(b)});case 24:if((d=e.sent).ok){e.next=36;break}return e.prev=26,e.next=29,d.text();case 29:return h=e.sent,e.abrupt("return",[[JSON.parse(h).error]]);case 33:return e.prev=33,e.t0=e.catch(26),e.abrupt("return",[["No data"]]);case 36:return e.next=38,d.json();case 38:if(!("message"in(m=e.sent))){e.next=41;break}return e.abrupt("return",[[m.message]]);case 41:return e.abrupt("return",[[m.data]]);case 42:case"end":return e.stop()}}),e,null,[[26,33]])})))).apply(this,arguments)}function j(e){var r=readCookie("finsheet_api_key");window.socket=new WebSocket("wss://"+link.slice(8)+"/ws?api_key="+r),window.socket.onopen=function(){console.log("Socket open"),e&&(window.socket.send(JSON.stringify({symbol:e,type:"subscribe"})),window.can_call_streaming=!0)},window.socket.onmessage=function(e){if(window.Should_Update_Streaming){var r=JSON.parse(e.data),t=r.data[0].s;window.OldBigSymbolPriceMap[t]=window.BigSymbolPriceMap[t],window.BigSymbolPriceMap[t]=r.data[0].p}},window.socket.onclose=function(e){console.log(12,e),setTimeout((function(){1e3===e.code?(window.have_not_reconnect_websocket=!1,j()):window.can_call_streaming=!1}),1e3)},window.socket.onerror=function(e){console.log(e),console.error("Socket encountered error: ",e.message,"Closing socket"),window.socket.close()}}function L(){return L=u(regeneratorRuntime.mark((function e(r,t){var n,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Excel.run(function(){var e=u(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.have_not_set_interval_change_color&&(window.have_not_set_interval_change_color=!1,setInterval(u(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.Should_Update_Streaming){e.next=2;break}return e.abrupt("return");case 2:return t=r.workbook.worksheets.getActiveWorksheet(),(n=t.getUsedRange(!0)).load("formulas"),n.load("address"),n.load("values"),e.next=9,r.sync().then(u(regeneratorRuntime.mark((function e(){var s,i,o,c,p,l,b,f,d,h,m,g,k,y,x,v,S,w,_,N,C,R;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=t.id,i=n.address.split("!")[1].split(":")[0],o=0,c=0,p=0;case 4:if(!(p<i.length)){e.next=12;break}if(isNaN(i[p])){e.next=9;break}return c=colnameToNumber(i.slice(0,p))-1,o=parseInt(i.slice(p))-1,e.abrupt("break",12);case 9:p++,e.next=4;break;case 12:for(l=[],b=[],f=n.formulas,d=n.values,p=0;p<f.length;p++)for(h=0;h<f[0].length;h++)(m=f[p][h]).toLowerCase().startsWith("=fs_streaming(")&&(3===(g=m.split('"')).length?(k=g[1],window.BigSymbolPriceMap[k]&&window.OldBigSymbolPriceMap[k]&&(window.BigSymbolPriceMap[k]>window.OldBigSymbolPriceMap[k]?l.push([o+p,c+h]):window.BigSymbolPriceMap[k]<window.OldBigSymbolPriceMap[k]&&b.push([o+p,c+h]))):(y=s+"@@"+(o+p)+"@@"+(c+h),window.EachCellStreamingValue[y]&&d[p][h]&&(d[p][h]>window.EachCellStreamingValue[y]?l.push([o+p,c+h]):d[p][h]<window.EachCellStreamingValue[y]&&b.push([o+p,c+h])),window.EachCellStreamingValue[y]=d[p][h]));x=0,v=[[l,"#2cbd54"],[b,"#ff6669"]];case 19:if(!(x<v.length)){e.next=33;break}S=v[x],w="",_=a(S[0]);try{for(_.s();!(N=_.n()).done;)g=N.value,C=getExcelColName(g[1]),w+=C.toUpperCase()+(g[0]+1)+":"+C.toUpperCase()+(g[0]+1)+", "}catch(e){_.e(e)}finally{_.f()}if(""!==w&&(w=w.slice(0,w.length-2)),R=t.getRanges(w),!w){e.next=30;break}return R.format.font.color=S[1],e.next=30,r.sync().then(u(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))));case 30:x++,e.next=19;break;case 33:case"end":return e.stop()}}),e)}))));case 9:case"end":return e.stop()}}),e)}))),500));case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),readCookie("finsheet_api_key")){e.next=4;break}return e.abrupt("return","Please login using the sidebar");case 4:if(r){e.next=6;break}return e.abrupt("return","Symbol cannot be empty");case 6:if("string"==typeof r){e.next=8;break}return e.abrupt("return","Symbol has to be a string");case 8:r=r.toUpperCase(),window.socket&&window.socket.readyState===window.socket.OPEN||!window.have_not_reconnect_websocket?r in window.BigSymbolPriceMap||(n={symbol:r,type:"subscribe"},window.socket.send(JSON.stringify(n)),window.can_call_streaming=!0):j(r),s=setInterval((function(){if(window.can_call_streaming){var e=window.BigSymbolPriceMap[r];t.setResult(e)}else t.setResult("You need a Plus or Pro membership to stream real-time price.")}),500),t.onCanceled=function(){clearInterval(s)};case 12:case"end":return e.stop()}}),e)}))),L.apply(this,arguments)}function M(){return(M=u(regeneratorRuntime.mark((function e(r,t){var n,s,i,u,c,p,l,b,f,m,g,k,y,x,v,S,w,_,N,C,R,O,P,A;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(!r.includes(",")&&!r.includes(";")){e.next=9;break}return e.abrupt("return",["Invalid symbol"]);case 9:if(r=r.toUpperCase(),t in d){e.next=12;break}return e.abrupt("return",[["Invalid resolution"]]);case 12:return t in h&&(t=t.toUpperCase()),s={api_key:n,symbol:r,resolution:t,which:"pattern_recognition"},console.log(0,s),i=link+"/excel/technical?"+new URLSearchParams(s).toString(),e.next=18,fetch(i);case 18:if((u=e.sent).ok){e.next=30;break}return e.next=22,u.text();case 22:return c=e.sent,e.prev=23,e.abrupt("return",[[JSON.parse(c).error]]);case 27:return e.prev=27,e.t0=e.catch(23),e.abrupt("return",[["No data"]]);case 30:return e.next=32,u.json();case 32:if(!("message"in(p=e.sent))){e.next=35;break}return e.abrupt("return",[[p.message]]);case 35:e.prev=35,l=p.data,b=[],f=1,m=a(l),e.prev=40,m.s();case 42:if((g=m.n()).done){e.next=52;break}if((k=g.value).patternname&&k.symbol){e.next=46;break}return e.abrupt("continue",50);case 46:for(y=[["Pattern Name",k.patternname]],x=0,v=Object.keys(k);x<v.length;x++)"patternname"!==(S=v[x])&&"symbol"!==S&&y.push([o(S),k[S]]);y.length>f&&(f=y.length),b.push(y);case 50:e.next=42;break;case 52:e.next=57;break;case 54:e.prev=54,e.t1=e.catch(40),m.e(e.t1);case 57:return e.prev=57,m.f(),e.finish(57);case 60:for(w=0;w<b.length;w++)for(_=f-b[w].length,N=0;N<_;N++)b[w].push(["",""]),console.log(b[w].length);if(!(b.length<1)){e.next=63;break}return e.abrupt("return",[["No data"]]);case 63:for(C=[],w=0;w<b[0].length;w++){R=[],O=a(b);try{for(O.s();!(P=O.n()).done;)A=P.value,R=R.concat(A[w])}catch(e){O.e(e)}finally{O.f()}C.push(R)}return console.log(C),e.abrupt("return",C);case 69:return e.prev=69,e.t2=e.catch(35),e.abrupt("return",[["No data"]]);case 72:case"end":return e.stop()}}),e,null,[[23,27],[35,69],[40,54,57,60]])})))).apply(this,arguments)}function J(){return(J=u(regeneratorRuntime.mark((function e(r,t){var n,a,s,i,u,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(!r.includes(",")&&!r.includes(";")){e.next=9;break}return e.abrupt("return",["Invalid symbol"]);case 9:if(r=r.toUpperCase(),t in d){e.next=12;break}return e.abrupt("return",[["Invalid resolution"]]);case 12:return t in h&&(t=t.toUpperCase()),a=link+"/excel/technical?"+new URLSearchParams({api_key:n,symbol:r,resolution:t,which:"support_resistance"}).toString(),e.next=17,fetch(a);case 17:if((s=e.sent).ok){e.next=29;break}return e.next=21,s.text();case 21:return i=e.sent,e.prev=22,e.abrupt("return",[[JSON.parse(i).error]]);case 26:return e.prev=26,e.t0=e.catch(22),e.abrupt("return",[["No data"]]);case 29:return e.next=31,s.json();case 31:if(!("message"in(u=e.sent))){e.next=34;break}return e.abrupt("return",[[u.message]]);case 34:return o=u.data,e.prev=35,e.abrupt("return",o.length<1?[["No data"]]:[o]);case 39:return e.prev=39,e.t1=e.catch(35),e.abrupt("return",[["No data"]]);case 42:case"end":return e.stop()}}),e,null,[[22,26],[35,39]])})))).apply(this,arguments)}function B(){return(B=u(regeneratorRuntime.mark((function e(r,t){var n,a,s,i,u,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(!r.includes(",")&&!r.includes(";")){e.next=9;break}return e.abrupt("return",["Invalid symbol"]);case 9:if(r=r.toUpperCase(),t in d){e.next=12;break}return e.abrupt("return",[["Invalid resolution"]]);case 12:return t in h&&(t=t.toUpperCase()),a=link+"/excel/technical?"+new URLSearchParams({api_key:n,symbol:r,resolution:t,which:"aggregate_indicators"}).toString(),e.next=17,fetch(a);case 17:if((s=e.sent).ok){e.next=29;break}return e.next=21,s.text();case 21:return i=e.sent,e.prev=22,e.abrupt("return",[[JSON.parse(i).error]]);case 26:return e.prev=26,e.t0=e.catch(22),e.abrupt("return",[["No data"]]);case 29:return e.next=31,s.json();case 31:if(!("message"in(u=e.sent))){e.next=34;break}return e.abrupt("return",[[u.message]]);case 34:return o=u.data,e.prev=35,e.abrupt("return",[["Buy",o.technicalAnalysis.count.buy],["Neutral",o.technicalAnalysis.count.neutral],["Sell",o.technicalAnalysis.count.sell],["Aggregate signal",o.technicalAnalysis.signal],["ADX reading",o.trend.adx],["Trending",o.trend.trending.toString()]]);case 39:return e.prev=39,e.t1=e.catch(35),e.abrupt("return",[["No data"]]);case 42:case"end":return e.stop()}}),e,null,[[22,26],[35,39]])})))).apply(this,arguments)}function V(){return V=u(regeneratorRuntime.mark((function e(r,t,n,s){var i,u,c,p,l,b,f,m,g,k,y,x,v,S,w,_,N,C,R,O,P,A,I,T,F,D=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=D.length>4&&void 0!==D[4]?D[4]:void 0,u=D.length>5&&void 0!==D[5]?D[5]:[],c=u,null==i&&(i=void 0),p=readCookie("finsheet_api_key")){e.next=7;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 7:if(r){e.next=9;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 9:if("string"==typeof r){e.next=11;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 11:if(!r.includes(",")&&!r.includes(";")){e.next=13;break}return e.abrupt("return",["Invalid symbol"]);case 13:if(r=r.toUpperCase(),t in d){e.next=16;break}return e.abrupt("return",[["Invalid resolution"]]);case 16:if(t in h&&(t=t.toUpperCase()),"string"==typeof n){e.next=19;break}return e.abrupt("return",[["Indicator has to be a string"]]);case 19:if(n=n.toLowerCase(),l=Date.parse(new Date)/1e3,s){e.next=23;break}return e.abrupt("return",[["'from' cannot be empty"]]);case 23:if("number"!=typeof s&&isNaN(s)){e.next=28;break}s<73e3&&(s=86400*(s-25569)),s=Math.round(s),e.next=31;break;case 28:if(s=Date.parse(s)/1e3,!(isNaN(s)||s<0)){e.next=31;break}return e.abrupt("return",[["Invalid 'from'"]]);case 31:if(""!=i&&void 0!==i){e.next=35;break}i=l,e.next=43;break;case 35:if("number"!=typeof i&&isNaN(i)){e.next=40;break}i<73e3&&(i=86400*(i-25569)),i=Math.round(i),e.next=43;break;case 40:if(i=Date.parse(i)/1e3,!(isNaN(i)||i<0)){e.next=43;break}return e.abrupt("return",[["Invalid 'to'"]]);case 43:if(!(i<=s)){e.next=45;break}return e.abrupt("return",[["'to' has to be after 'from'"]]);case 45:b={},e.prev=46,f={},m=a(c);try{for(m.s();!(g=m.n()).done;)k=g.value,f[k[0].toString()]=k[1].toString()}catch(e){m.e(e)}finally{m.f()}b={symbol:r,resolution:t,from:s,to:i,api_key:p,indicator:n,indicator_fields:JSON.stringify(f),which:"technical_indicators"},e.next=56;break;case 53:return e.prev=53,e.t0=e.catch(46),e.abrupt("return",[["Invalid parameters"]]);case 56:return console.log("prepare",b),y=link+"/excel/technical?"+new URLSearchParams(b).toString(),e.next=60,fetch(y);case 60:if((x=e.sent).ok){e.next=72;break}return e.next=64,x.text();case 64:return v=e.sent,e.prev=65,e.abrupt("return",[[JSON.parse(v).error]]);case 69:return e.prev=69,e.t1=e.catch(65),e.abrupt("return",[["No data"]]);case 72:return e.next=74,x.json();case 74:if(S=e.sent,console.log(S),!("message"in S)){e.next=78;break}return e.abrupt("return",[[S.message]]);case 78:if(e.prev=78,(w=S.data).c){e.next=82;break}return e.abrupt("return",[["No data"]]);case 82:for(_={t:1,c:1,o:1,h:1,l:1,v:1,s:1},N=[],C=[["Period","Open","High","Low","Close","Volume"]],R=0,O=Object.keys(w);R<O.length;R++)P=O[R],_[P]||(N.push(P),C[0].push(o(P)));for(A=0;A<w.c.length;A++){I=[w.t&&w.t[A]?new Date(1e3*w.t[A]):"",w.o&&w.o[A]?w.o[A]:"",w.h&&w.h[A]?w.h[A]:"",w.l&&w.l[A]?w.l[A]:"",w.c[A]?w.c[A]:"",w.v&&w.v[A]?w.v[A]:""],T=a(N);try{for(T.s();!(F=T.n()).done;)P=F.value,I.push(w[P]&&null!==w[P][A]&&void 0!==w[P][A]?w[P][A]:"")}catch(e){T.e(e)}finally{T.f()}C.push(I)}if(!(C.length<2)){e.next=89;break}return e.abrupt("return",[["No data"]]);case 89:return console.log(C),e.abrupt("return",C);case 93:return e.prev=93,e.t2=e.catch(78),e.abrupt("return",[["No data"]]);case 96:case"end":return e.stop()}}),e,null,[[46,53],[65,69],[78,93]])}))),V.apply(this,arguments)}function q(){return(q=u(regeneratorRuntime.mark((function e(r){var t,n,a,s,i,u,c,p,l,b,f,d,h,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:return r=r.toUpperCase(),n=link+"/excel/alternative/esg?"+new URLSearchParams({symbol:r,api_key:t}).toString(),e.next=12,fetch(n);case 12:if((a=e.sent).ok){e.next=24;break}return e.prev=14,e.next=17,a.text();case 17:return s=e.sent,e.abrupt("return",[[JSON.parse(s).error]]);case 21:return e.prev=21,e.t0=e.catch(14),e.abrupt("return",[["No data"]]);case 24:return e.next=26,a.json();case 26:if(!("message"in(i=e.sent))){e.next=29;break}return e.abrupt("return",[[i.message]]);case 29:u=i.data,c=[],p=0,l=Object.keys(u);case 32:if(!(p<l.length)){e.next=45;break}if("data"!==(b=l[p])){e.next=38;break}try{for(f=0,d=Object.keys(u[b]);f<d.length;f++)h=d[f],c.push([o(h.split(/(?=[A-Z])/).join(" ")),u[b][h]])}catch(e){}e.next=42;break;case 38:if("symbol"!==b){e.next=40;break}return e.abrupt("continue",42);case 40:m="totalESGScore"===b?"Total ESG Score":o(b.split(/(?=[A-Z])/).join(" ")),c.push([m,u[b]]);case 42:p++,e.next=32;break;case 45:return e.abrupt("return",c);case 46:case"end":return e.stop()}}),e,null,[[14,21]])})))).apply(this,arguments)}function Y(){return(Y=u(regeneratorRuntime.mark((function e(r,t,n){var s,i,u,c,p,l,b,f,d,h,m,g,k,y,x,v,S,w,_,N;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(r=r.toUpperCase(),"string"==typeof t&&["annual","quarterly"].includes(t.toLowerCase())){e.next=10;break}return e.abrupt("return",[["Invalid frequency"]]);case 10:if(n||(n=100),"number"==typeof n){e.next=13;break}return e.abrupt("return",[["Limit has to be a number"]]);case 13:return i=link+"/excel/alternative/earnings_quality?"+new URLSearchParams({symbol:r,api_key:s,freq:t}).toString(),e.next=17,fetch(i);case 17:if((u=e.sent).ok){e.next=29;break}return e.prev=19,e.next=22,u.text();case 22:return c=e.sent,e.abrupt("return",[[JSON.parse(c).error]]);case 26:return e.prev=26,e.t0=e.catch(19),e.abrupt("return",[["No data"]]);case 29:return e.next=31,u.json();case 31:if(!("message"in(p=e.sent))){e.next=34;break}return e.abrupt("return",[[p.message]]);case 34:l=p.data.data,b={period:1,score:1,letterScore:1},f={},d={},h=0,m=a(l),e.prev=40,m.s();case 42:if((g=m.n()).done){e.next=52;break}if((k=g.value).period){e.next=46;break}return e.abrupt("continue",50);case 46:for(h+=1,y=0,x=Object.keys(k);y<x.length;y++)(v=x[y])in b||(f[v]=1),v in d?d[v].push(k[v]):v in d||(d[v]=[k[v]]);if(h!==n){e.next=50;break}return e.abrupt("break",52);case 50:e.next=42;break;case 52:e.next=57;break;case 54:e.prev=54,e.t1=e.catch(40),m.e(e.t1);case 57:return e.prev=57,m.f(),e.finish(57);case 60:if(!(Object.keys(d).length<1)){e.next=62;break}return e.abrupt("return",[["No data"]]);case 62:f=["period"].concat(Object.keys(f)).concat(["score","letterScore"]),S=[],w=a(f);try{for(w.s();!(_=w.n()).done;)N=_.value,S.push([o(N.split(/(?=[A-Z])/).join(" "))].concat([].concat(d[N]).reverse()))}catch(e){w.e(e)}finally{w.f()}return S[0][0]="",e.abrupt("return",S);case 68:case"end":return e.stop()}}),e,null,[[19,26],[40,54,57,60]])})))).apply(this,arguments)}function H(){return H=u(regeneratorRuntime.mark((function r(t,n){var s,i,u,o,c,p,l,b,f,d,h,m,g,k,y,x,v,S,w,_,N,C,R,O,P,A,I,T,F,D,U,E,j,L,M,J,B,V,q,Y,H,G,Q,W,z,K,X,Z,$,ee=arguments;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(s=ee.length>2&&void 0!==ee[2]?ee[2]:[],i=readCookie("finsheet_api_key")){r.next=4;break}return r.abrupt("return",[["Please login using the sidebar"]]);case 4:if(t){r.next=6;break}return r.abrupt("return",[["Provider name cannot be empty"]]);case 6:if("string"==typeof t){r.next=8;break}return r.abrupt("return",[["Provider name to be a string"]]);case 8:if(n){r.next=10;break}return r.abrupt("return",[["Endpoint name cannot be empty"]]);case 10:if("string"==typeof n){r.next=12;break}return r.abrupt("return",[["Endpoint name to be a string"]]);case 12:s||(s=[]),u={},r.prev=14,o=a(s);try{for(o.s();!(c=o.n()).done;)p=c.value,u[p[0].toString()]=p[1].toString()}catch(e){o.e(e)}finally{o.f()}r.next=22;break;case 19:return r.prev=19,r.t0=r.catch(14),r.abrupt("return",[["Invalid parameters"]]);case 22:if(""===(l=checkValidProviderEndpoint(t,n))[2]){r.next=25;break}return r.abrupt("return",[[l[2]]]);case 25:b=l[1],f=l[0],d=f.url,h=f.return_is_list?"list":"dic",m=f.params?f.params:{},g={},k=0,y=Object.keys(m);case 31:if(!(k<y.length)){r.next=39;break}if(x=y[k],!m[x].required||x in u){r.next=35;break}return r.abrupt("return",[['Missing parameter "'+x+'"']]);case 35:m[x].replace_2dots?d=d.replace(":"+x,u[x]):x in u?(v=m[x].transformInput,g[x]=v?v(u[x]):u[x]):m[x].default&&(g[x]=m[x].default.toString());case 36:k++,r.next=31;break;case 39:return console.log(12,g),S={api_key:i,base_url:b,endpoint_url:d,params:JSON.stringify(g),return_structure:h},w=link+"/excel/api?"+new URLSearchParams(S).toString(),r.next=44,fetch(w);case 44:if((_=r.sent).ok){r.next=56;break}return r.next=48,_.text();case 48:return N=r.sent,r.prev=49,r.abrupt("return",[[JSON.parse(N).error]]);case 53:return r.prev=53,r.t1=r.catch(49),r.abrupt("return",[["No data"]]);case 56:return r.next=58,_.json();case 58:if(!("message"in(C=r.sent))){r.next=61;break}return r.abrupt("return",[[C.message]]);case 61:if(!("string"==typeof(R=C.data)||R instanceof String)){r.next=64;break}return r.abrupt("return",[[R]]);case 64:r.prev=64,O=0,P=["err","error","errors"];case 66:if(!(O<P.length)){r.next=73;break}if(A=P[O],!R[A]||"object"===e(R[A])&&Object.keys(R[A]).length<1){r.next=70;break}return r.abrupt("return",[[JSON.stringify(R[A])]]);case 70:O++,r.next=66;break;case 73:r.next=77;break;case 75:r.prev=75,r.t2=r.catch(64);case 77:if(delete R.err,delete R.error,delete R.errors,"data"in R&&f.go_down_1_level?R=R.data:"result"in R&&f.go_down_1_level&&(R=R.result),R){r.next=83;break}return r.abrupt("return",[["No data"]]);case 83:if(f.go_up_1_level&&(R={data:R}),!f.specialHandleFunction){r.next=86;break}return r.abrupt("return",f.specialHandleFunction(R));case 86:if(I=[["No data"]],"object"!==e(R)||R.constructor===Array){r.next=96;break}for(T=[],F=0,D=0,U=Object.keys(R);D<U.length;D++){if(E=U[D],j=R[E],L=[],j)if("object"===e(j)&&Object.keys(j).length>15||j.constructor===Array){for(j.constructor!==Array&&(j=convertDicToArray(j,E)),M=[],J=0,B=Object.keys(j);J<B.length;J++)V=B[J],q=f.go_up_1_level?j.constructor!==Array?V:"":j.constructor!==Array?E+"_"+V:E,M.push(handleApiDataExpandColumn(j[V],q));j.constructor===Array&&j.length<1&&(M=[[[E,""]]]),L=rotateDataAfterExpandRow(M)}else"object"!==e(j)?L=[[E],[j]]:Object.keys(j).length<1||"object"!==e(j)?L=[[E],[""]]:(Y=[handleApiDataExpandColumn(j,E)],L=rotateDataAfterExpandRow(Y));else L=[[E],[""]];F=Math.max(F,L.length),T.push(L)}for(H=[],G=0,Q=T;G<Q.length;G++)W=Q[G],H.push(blowUpDimension(W,F));I=concatHorizontally(H),r.next=105;break;case 96:if(R.constructor!==Array){r.next=104;break}for(z=[],K=0,X=Object.keys(R);K<X.length;K++)Z=X[K],$="",z.push(handleApiDataExpandColumn(R[Z],$));if(!(R.length<1)){r.next=101;break}return r.abrupt("return",[["No data"]]);case 101:I=rotateDataAfterExpandRow(z),r.next=105;break;case 104:return r.abrupt("return",[[JSON.stringify(R)]]);case 105:if(f.transformOutput)try{I=f.transformOutput(I)}catch(e){}return r.abrupt("return",I);case 107:case"end":return r.stop()}}),r,null,[[14,19],[49,53],[64,75]])}))),H.apply(this,arguments)}function G(){return G=u(regeneratorRuntime.mark((function e(r){var t,n,a,s,i,u,o,c,p,l,b,f,d=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.length>1&&void 0!==d[1]?d[1]:void 0,null==(n=d.length>2&&void 0!==d[2]?d[2]:void 0)&&(n=void 0),a=r,s=readCookie("finsheet_api_key")){e.next=7;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 7:if(a){e.next=9;break}return e.abrupt("return",[["ISIN cannot be empty"]]);case 9:if("string"==typeof a){e.next=11;break}return e.abrupt("return",[["ISIN has to be a string"]]);case 11:if(a=a.toUpperCase(),t){e.next=14;break}return e.abrupt("return",[["'from' cannot be empty"]]);case 14:if("number"!=typeof t&&isNaN(t)){e.next=19;break}t<73e3&&(t=86400*(t-25569)),t=Math.round(t),e.next=22;break;case 19:if(t=Date.parse(t)/1e3,!(isNaN(t)||t<0)){e.next=22;break}return e.abrupt("return",[["Invalid 'from'"]]);case 22:if(""!=n&&void 0!==n){e.next=26;break}n=current_time,e.next=34;break;case 26:if("number"!=typeof n&&isNaN(n)){e.next=31;break}n<73e3&&(n=86400*(n-25569)),n=Math.round(n),e.next=34;break;case 31:if(n=Date.parse(n)/1e3,!(isNaN(n)||n<0)){e.next=34;break}return e.abrupt("return",[["Invalid 'to'"]]);case 34:if(!(n<=t)){e.next=36;break}return e.abrupt("return",[["'to' has to be after 'from'"]]);case 36:return console.log(t,n),i={ticker:a,from:t,to:n,api_key:s},u=link+"/excel/bond_candles?"+new URLSearchParams(i).toString(),e.next=41,fetch(u);case 41:if((o=e.sent).ok){e.next=53;break}return e.prev=43,e.next=46,o.text();case 46:return c=e.sent,e.abrupt("return",[[JSON.parse(c).error]]);case 50:return e.prev=50,e.t0=e.catch(43),e.abrupt("return",[["No data"]]);case 53:return e.next=55,o.json();case 55:if(!("message"in(p=e.sent))){e.next=58;break}return e.abrupt("return",[[p.message]]);case 58:if(l=p.data,b=[["Period","Close"]],l.c){e.next=62;break}return e.abrupt("return",[["No data"]]);case 62:if(l.c.constructor===Array)for(f=0;f<l.c.length;f++)b.push([l.t&&l.t[f]?new Date(1e3*l.t[f]):"",l.c[f]?l.c[f]:""]);if(!(b.length<2)){e.next=65;break}return e.abrupt("return",[["No data"]]);case 65:return e.abrupt("return",b);case 66:case"end":return e.stop()}}),e,null,[[43,50]])}))),G.apply(this,arguments)}function Q(){return Q=u(regeneratorRuntime.mark((function e(r){var t,n,a,s,i,u,o,c,p,l,b,f,d,h,m=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=m.length>1&&void 0!==m[1]?m[1]:void 0,n=m.length>2&&void 0!==m[2]?m[2]:void 0,a=r,s=t,i=readCookie("finsheet_api_key")){e.next=6;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 6:if(a){e.next=8;break}return e.abrupt("return",[["ISIN cannot be empty"]]);case 8:if("string"==typeof a){e.next=10;break}return e.abrupt("return",[["ISIN has to be a string"]]);case 10:if(a=a.toUpperCase(),s){e.next=13;break}return e.abrupt("return",[["'date' cannot be empty"]]);case 13:if("number"!=typeof s&&isNaN(s)){e.next=18;break}s<73e3&&(s=86400*(s-25569)),s=Math.round(s),e.next=21;break;case 18:if(s=Date.parse(s)/1e3,!(isNaN(s)||s<0)){e.next=21;break}return e.abrupt("return",[["Invalid 'date'"]]);case 21:return s=new Date(1e3*s),u=s.getTimezoneOffset(),s=(s=new Date(s.getTime()-60*u*1e3)).toISOString().split("T")[0],o={ticker:a,from:s,limit:n.toString(),api_key:i},c=link+"/excel/bond_tick?"+new URLSearchParams(o).toString(),e.next=29,fetch(c);case 29:if((p=e.sent).ok){e.next=41;break}return e.prev=31,e.next=34,p.text();case 34:return l=e.sent,e.abrupt("return",[[JSON.parse(l).error]]);case 38:return e.prev=38,e.t0=e.catch(31),e.abrupt("return",[["No data"]]);case 41:return e.next=43,p.json();case 43:if(!("message"in(b=e.sent))){e.next=46;break}return e.abrupt("return",[[b.message]]);case 46:if(f=b.data,d=[["Period","Price","Volume","Side"]],f.p){e.next=50;break}return e.abrupt("return",[["No data"]]);case 50:if(f.p.constructor===Array)for(h=0;h<f.p.length;h++)d.push([f.t&&f.t[h]?new Date(f.t[h]):"",f.p[h]?f.p[h]:"",f.v&&(f.v[h]||0==f.v[h])?f.v[h]:"",f.si&&f.si[h]?"1"===f.si[h].toString()?"Buy":"Sell":""]);if(!(d.length<2)){e.next=53;break}return e.abrupt("return",[["No data"]]);case 53:return e.abrupt("return",d);case 54:case"end":return e.stop()}}),e,null,[[31,38]])}))),Q.apply(this,arguments)}function W(){return W=u(regeneratorRuntime.mark((function e(r){var t,n,a,s,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>1&&void 0!==i[1]?i[1]:void 0,n=i.length>2&&void 0!==i[2]?i[2]:void 0,a=i.length>3&&void 0!==i[3]?i[3]:void 0,s=i.length>4&&void 0!==i[4]?i[4]:void 0,e.abrupt("return",g(r,"D",t,n,a,s,"future"));case 5:case"end":return e.stop()}}),e)}))),W.apply(this,arguments)}function z(){return(z=u(regeneratorRuntime.mark((function e(r){var t,n,a,s,i,u,o,c,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return","Symbol cannot be empty");case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return","Symbol has to be a string");case 7:return r=r.toUpperCase(),n=link+"/excel/option?"+new URLSearchParams({ticker:r,api_key:t}).toString(),e.next=12,fetch(n);case 12:if((a=e.sent).ok){e.next=24;break}return e.prev=14,e.next=17,a.text();case 17:return s=e.sent,e.abrupt("return",[[JSON.parse(s).error]]);case 21:return e.prev=21,e.t0=e.catch(14),e.abrupt("return",[["No data"]]);case 24:return e.next=26,a.json();case 26:if(!("message"in(i=e.sent))){e.next=29;break}return e.abrupt("return",[[i.message]]);case 29:if(u=i.data,console.log(u),o=[],u.constructor===Array)for(c=0;c<u.length;c++)p=u[c],o.push([p.expirationDate]);if(!(o.length<1)){e.next=35;break}return e.abrupt("return",[["No data"]]);case 35:return e.abrupt("return",o);case 36:case"end":return e.stop()}}),e,null,[[14,21]])})))).apply(this,arguments)}function K(){return K=u(regeneratorRuntime.mark((function e(r,t,n){var s,i,u,o,c,p,l,b,f,d,h,m,g,k,y,x,v,S,w,_,N,C,R,O,P,A,I,T,F,D,U,E,j,L,M,J=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=J.length>3&&void 0!==J[3]?J[3]:[],i=readCookie("finsheet_api_key")){e.next=4;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 4:if(r){e.next=6;break}return e.abrupt("return","Symbol cannot be empty");case 6:if("string"==typeof r){e.next=8;break}return e.abrupt("return","Symbol has to be a string");case 8:if(r=r.toUpperCase(),"string"==typeof t){e.next=11;break}return e.abrupt("return",'"type" has to be a string');case 11:if("call"==(t=t.toLowerCase())||"put"==t){e.next=14;break}return e.abrupt("return",[['"type" has to be call or put']]);case 14:if(n){e.next=16;break}return e.abrupt("return",[['"expirationDate" cannot be empty']]);case 16:if("string"==typeof n){e.next=18;break}return e.abrupt("return",[['"expirationDate" has to be a string']]);case 18:if(dateIsValid(n)){e.next=20;break}return e.abrupt("return",[['Invalid "expirationDate"']]);case 20:s||(s=[]),console.log(1,s),u={},e.prev=23,o=a(s);try{for(o.s();!(c=o.n()).done;)p=c.value,u[p[0].toString()]=p[1].toString()}catch(e){o.e(e)}finally{o.f()}e.next=31;break;case 28:return e.prev=28,e.t0=e.catch(23),e.abrupt("return",[['Invalid "options"']]);case 31:if(l={},b=!0,"false"==u.header&&(b=!1),u.metrics)if((f=u.metrics.split("&")).includes("all")){g=a(option_cols);try{for(g.s();!(k=g.n()).done;)m=k.value,l[m]=1}catch(e){g.e(e)}finally{g.f()}}else{d=a(f);try{for(d.s();!(h=d.n()).done;)m=h.value,option_cols.includes(m)&&(l[m]=1)}catch(e){d.e(e)}finally{d.f()}}else{y=a(option_cols);try{for(y.s();!(x=y.n()).done;)m=x.value,l[m]=1}catch(e){y.e(e)}finally{y.f()}}return console.log(2),v={ticker:r,api_key:i},S=link+"/excel/option?"+new URLSearchParams(v).toString(),e.next=40,fetch(S);case 40:if(w=e.sent,console.log(3),w.ok){e.next=53;break}return e.prev=43,e.next=46,w.text();case 46:return _=e.sent,e.abrupt("return",[[JSON.parse(_).error]]);case 50:return e.prev=50,e.t1=e.catch(43),e.abrupt("return",[["No data"]]);case 53:return e.next=55,w.json();case 55:if(!("message"in(N=e.sent))){e.next=58;break}return e.abrupt("return",[[N.message]]);case 58:if(C=N.data,console.log(C),R=[],C.constructor!==Array){e.next=73;break}O=0;case 63:if(!(O<C.length)){e.next=73;break}if((P=C[O]).expirationDate==n){e.next=67;break}return e.abrupt("continue",70);case 67:A=P.options[t.toUpperCase()],I=a(A);try{for(I.s();!(T=I.n()).done;){F=T.value,D=[],U=a(option_cols);try{for(U.s();!(E=U.n()).done;)(j=E.value)in l&&D.push(F[j]||0==F[j]?F[j]:"")}catch(e){U.e(e)}finally{U.f()}R.push(D)}}catch(e){I.e(e)}finally{I.f()}case 70:O++,e.next=63;break;case 73:if(!(R.length<1)){e.next=75;break}return e.abrupt("return",[["No data"]]);case 75:if(b){D=[],L=a(option_cols);try{for(L.s();!(M=L.n()).done;)(j=M.value)in l&&D.push(j)}catch(e){L.e(e)}finally{L.f()}R=[D].concat(R)}return e.abrupt("return",R);case 77:case"end":return e.stop()}}),e,null,[[23,28],[43,50]])}))),K.apply(this,arguments)}function X(){return(X=u(regeneratorRuntime.mark((function e(r){var t,n,s,i,u,o,c,p,l,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(r){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof r){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:return r=r.toUpperCase(),n=link+"/excel/short-interest?"+new URLSearchParams({symbol:r,api_key:t}).toString(),e.next=12,fetch(n);case 12:if((s=e.sent).ok){e.next=24;break}return e.prev=14,e.next=17,s.text();case 17:return i=e.sent,e.abrupt("return",[[JSON.parse(i).error]]);case 21:return e.prev=21,e.t0=e.catch(14),e.abrupt("return",[["No data"]]);case 24:return e.next=26,s.json();case 26:if(!("message"in(u=e.sent))){e.next=29;break}return e.abrupt("return",[[u.message]]);case 29:if("No data"!==(o=u.data.data).status){e.next=32;break}return e.abrupt("return",[["No data"]]);case 32:c=[["Settlement Date","Short Interest","Short Ratio","Short % of Shares Outstanding"]],p=a(o);try{for(p.s();!(l=p.n()).done;)b=l.value,c.push([b.settlementDate,b.shortInterest,b.shortRatio,b.shortPercentOutstanding])}catch(e){p.e(e)}finally{p.f()}return e.abrupt("return",c);case 36:case"end":return e.stop()}}),e,null,[[14,21]])})))).apply(this,arguments)}function Z(){return Z=u(regeneratorRuntime.mark((function e(r,t,n){var a,s,i,u,o,c,p,l,b,f,d,h,m=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=m.length>3&&void 0!==m[3]?m[3]:void 0,s=t,i=readCookie("finsheet_api_key")){e.next=5;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 5:if(r){e.next=7;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 7:if("string"==typeof r){e.next=9;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 9:if(!(r=r.toUpperCase()).includes(".")||r in{"BRK.A":1,"BRK.B":1}){e.next=12;break}return e.abrupt("return",[["We only support US stocks for this function currently."]]);case 12:if(n){e.next=14;break}return e.abrupt("return",[["Limit cannot be empty"]]);case 14:if(a=a?a.toString():"0",s){e.next=17;break}return e.abrupt("return",[["'date' cannot be empty"]]);case 17:if("number"!=typeof s&&isNaN(s)){e.next=22;break}s<73e3&&(s=86400*(s-25569)),s=Math.round(s),e.next=25;break;case 22:if(s=Date.parse(s)/1e3,!(isNaN(s)||s<0)){e.next=25;break}return e.abrupt("return",[["Invalid 'date'"]]);case 25:if(!(1e3*s<Date.now()-316224e6)){e.next=27;break}return e.abrupt("return",[["'date' cannot be more that 10 years ago"]]);case 27:return s=new Date(1e3*s),u=s.getTimezoneOffset(),s=(s=new Date(s.getTime()-60*u*1e3)).toISOString().split("T")[0],o={ticker:r,from:s,limit:n.toString(),skip:a.toString(),api_key:i},c=link+"/excel/equity_tick?"+new URLSearchParams(o).toString(),e.next=35,fetch(c);case 35:if((p=e.sent).ok){e.next=47;break}return e.prev=37,e.next=40,p.text();case 40:return l=e.sent,e.abrupt("return",[[JSON.parse(l).error]]);case 44:return e.prev=44,e.t0=e.catch(37),e.abrupt("return",[["No data"]]);case 47:return e.next=49,p.json();case 49:if(!("message"in(b=e.sent))){e.next=52;break}return e.abrupt("return",[[b.message]]);case 52:if(f=b.data,e.prev=53,d=[["Count",f.count?f.count:"","Total",f.total?f.total:"",""],["Venue/Exchange","Timestamp","Price","Volume","Trade conditions"]],f.p){e.next=57;break}return e.abrupt("return","No data");case 57:if(f.p.constructor===Array)for(h=0;h<f.p.length;h++)d.push([f.x&&f.x[h]?f.x[h]in map_exchange_tick?map_exchange_tick[f.x[h]]:f.x[h]:"",f.t[h]?new Date(f.t[h]):"",f.p&&f.p[h]?f.p[h]:"",f.v&&(f.v[h]||0==f.v[h])?f.v[h]:"",f.c&&f.c[h]?f.c[h].join():""]);if(!(d.length<3)){e.next=60;break}return e.abrupt("return","No data");case 60:return e.abrupt("return",d);case 63:return e.prev=63,e.t1=e.catch(53),e.abrupt("return",[["No data"]]);case 66:case"end":return e.stop()}}),e,null,[[37,44],[53,63]])}))),Z.apply(this,arguments)}function $(){return($=u(regeneratorRuntime.mark((function e(r,t,n,s){var i,u,o,c,p,l,b,f,d,h,m,g,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(!r){e.next=19;break}if("number"!=typeof r&&isNaN(r)){e.next=10;break}r.toString().length>=12&&(r/=1e3),r=Math.round(r),e.next=13;break;case 10:if(r=Date.parse(r)/1e3,!(isNaN(r)||r<0)){e.next=13;break}return e.abrupt("return","Invalid 'date'");case 13:r=new Date(1e3*r),u=r.getTimezoneOffset(),r=(r=new Date(r.getTime()-60*u*1e3)).toISOString().split("T")[0],e.next=20;break;case 19:r="";case 20:if(!t){e.next=36;break}if("number"!=typeof t&&isNaN(t)){e.next=27;break}t.toString().length>=12&&(t/=1e3),t=Math.round(t),e.next=30;break;case 27:if(t=Date.parse(t)/1e3,!(isNaN(t)||t<0)){e.next=30;break}return e.abrupt("return","Invalid 'date'");case 30:t=new Date(1e3*t),o=t.getTimezoneOffset(),t=(t=new Date(t.getTime()-60*o*1e3)).toISOString().split("T")[0],e.next=37;break;case 36:t="";case 37:return n||(n=""),c=link+"/excel/earningscalendar?"+new URLSearchParams({ticker:n,from:r,to:t,api_key:i,international:s,is_gs:"y"}).toString(),e.next=42,fetch(c);case 42:if((p=e.sent).ok){e.next=54;break}return e.prev=44,e.next=47,p.text();case 47:return l=e.sent,e.abrupt("return",[[JSON.parse(l).error]]);case 51:return e.prev=51,e.t0=e.catch(44),e.abrupt("return",[["No data"]]);case 54:return e.next=56,p.json();case 56:if(!("message"in(b=e.sent))){e.next=59;break}return e.abrupt("return",[[b.message]]);case 59:f=(f=b.data).earningsCalendar,d=[["Date","Hour","Symbol","Revenue Actual","Revenue Estimate","EPS Actual","EPS Estimate","Reporting period"]],h={bmo:"Before Market Open",amc:"After Market Close",dmh:"During Market Hour"},m=a(f);try{for(m.s();!(g=m.n()).done;)k=g.value,d.push([k.date,k.hour in h?h[k.hour]:k.hour,k.symbol,k.revenueActual?k.revenueActual:"",k.revenueEstimate?k.revenueEstimate:"",k.epsActual?k.epsActual:"",k.epsEstimate?k.epsEstimate:"","Q"+k.quarter+"/"+k.year])}catch(e){m.e(e)}finally{m.f()}if(!(d.length<2)){e.next=67;break}return e.abrupt("return",[["No data"]]);case 67:return e.abrupt("return",d);case 68:case"end":return e.stop()}}),e,null,[[44,51]])})))).apply(this,arguments)}window.OldBigSymbolPriceMap={},window.BigSymbolPriceMap={},window.EachCellStreamingValue={},window.Should_Update_Streaming=!0,window.have_not_reconnect_websocket=!0,window.have_not_add_on_calculated_trigger=!0,window.have_not_set_interval_change_color=!0,window.can_call_streaming=!0,j(),CustomFunctions.associate("FS_TEST",(function(e){return l.apply(this,arguments)})),CustomFunctions.associate("FS_EQUITYMETRICS",(function(e,r){return b.apply(this,arguments)})),CustomFunctions.associate("FS_EQUITYFULLFINANCIALS",(function(e,r){return f.apply(this,arguments)})),CustomFunctions.associate("FS_EQUITYCANDLES",(function(e,r){return y.apply(this,arguments)})),CustomFunctions.associate("FS_FOREXCANDLES",(function(e,r){return x.apply(this,arguments)})),CustomFunctions.associate("FS_CRYPTOCANDLES",(function(e,r){return v.apply(this,arguments)})),CustomFunctions.associate("FS_ETFCANDLES",(function(e,r){return S.apply(this,arguments)})),CustomFunctions.associate("FS_MUTUALFUNDCANDLES",(function(e,r){return w.apply(this,arguments)})),CustomFunctions.associate("FS_FOREXALLRATES",(function(){return _.apply(this,arguments)})),CustomFunctions.associate("FS_CRYPTOPROFILE",(function(e){return C.apply(this,arguments)})),CustomFunctions.associate("FS_ETFPROFILE",(function(e){return O.apply(this,arguments)})),CustomFunctions.associate("FS_MUTUALFUNDPROFILE",(function(e){return A.apply(this,arguments)})),CustomFunctions.associate("FS_ETFHOLDINGS",(function(e,r){return D.apply(this,arguments)})),CustomFunctions.associate("FS_MUTUALFUNDHOLDINGS",(function(e,r){return U.apply(this,arguments)})),CustomFunctions.associate("FS_LATEST",(function(e){return E.apply(this,arguments)})),CustomFunctions.associate("FS_STREAMING",(function(e,r){return L.apply(this,arguments)})),CustomFunctions.associate("FS_PATTERNRECOGNITION",(function(e,r){return M.apply(this,arguments)})),CustomFunctions.associate("FS_SUPPORTRESISTANCE",(function(e,r){return J.apply(this,arguments)})),CustomFunctions.associate("FS_AGGREGATEINDICATORS",(function(e,r){return B.apply(this,arguments)})),CustomFunctions.associate("FS_TECHNICALINDICATORS",(function(e,r,t,n){return V.apply(this,arguments)})),CustomFunctions.associate("FS_ESG",(function(e){return q.apply(this,arguments)})),CustomFunctions.associate("FS_EARNINGSQUALITY",(function(e,r,t){return Y.apply(this,arguments)})),CustomFunctions.associate("FS_API",(function(e,r){return H.apply(this,arguments)})),CustomFunctions.associate("FS_BONDCANDLES",(function(e){return G.apply(this,arguments)})),CustomFunctions.associate("FS_BONDTICK",(function(e){return Q.apply(this,arguments)})),CustomFunctions.associate("FS_FUTURESCANDLES",(function(e){return W.apply(this,arguments)})),CustomFunctions.associate("FS_OPTIONEXPIRATIONDATES",(function(e){return z.apply(this,arguments)})),CustomFunctions.associate("FS_OPTIONCHAIN",(function(e,r,t){return K.apply(this,arguments)})),CustomFunctions.associate("FS_SHORTINTEREST",(function(e){return X.apply(this,arguments)})),CustomFunctions.associate("FS_EQUITYTICK",(function(e,r,t){return Z.apply(this,arguments)})),CustomFunctions.associate("FS_EARNINGSCALENDAR",(function(e,r,t,n){return $.apply(this,arguments)}))}();
//# sourceMappingURL=functions.js.map