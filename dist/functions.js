!function(){function e(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,i=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw i}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t,r,n,a,o,i){try{var s=e[o](i),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function s(e){o(i,n,a,s,u,"next",e)}function u(e){o(i,n,a,s,u,"throw",e)}s(void 0)}))}}function s(e,t){return u.apply(this,arguments)}function u(){return u=i(regeneratorRuntime.mark((function e(t,r){var a,o,i,s,u,c,p,l,f,b,d,m,g,h=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=h.length>2&&void 0!==h[2]?h[2]:void 0,o=h.length>3&&void 0!==h[3]?h[3]:void 0,null==a&&(a=void 0),null==o&&(o=void 0),i=readCookie("finsheet_api_key"),s=a,u=t,i){e.next=9;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 9:if(u){e.next=11;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 11:if("string"==typeof u){e.next=13;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 13:if(u=u.toUpperCase(),r){e.next=16;break}return e.abrupt("return",[["Metric cannot be empty"]]);case 16:if((r=r.toLowerCase())in map_excel_name_to_id||["bs","cf","ic"].includes(r)){e.next=19;break}return e.abrupt("return",[["Unsupported metric"]]);case 19:if(""===s&&(s=void 0),"string"==typeof s||void 0===s){e.next=22;break}return e.abrupt("return",[["Period has to be a string"]]);case 22:if(""===o&&(o=void 0),"number"==typeof o||void 0===o){e.next=25;break}return e.abrupt("return",[["Limit has to be a positive interger"]]);case 25:if(!(void 0!==o&&o<=0)){e.next=27;break}return e.abrupt("return",[["Limit has to be a positive interger"]]);case 27:if(c=r in map_excel_name_to_id?map_excel_name_to_id[r]:r,p=["bs","cf","ic"].includes(c),void 0!==s||!p&&!map_metrics[c].default_freq){e.next=33;break}s=["cf","ic"].includes(c)?"TTM":"bs"===c?"Q":map_metrics[c].default_freq,e.next=46;break;case 33:if(p||map_metrics[c].default_freq||void 0===s){e.next=37;break}return e.abrupt("return",[["This metric does not support periods"]]);case 37:if(void 0===s){e.next=46;break}if(s=s.toUpperCase(),!["bs","ic"].includes(c)||!s.includes("YTD")){e.next=41;break}return e.abrupt("return",[["Period YTD is only available for cf"]]);case 41:if("bs"!==c||!s.includes("TTM")){e.next=43;break}return e.abrupt("return",[["Period TTM is only available for ic and cf"]]);case 43:if(p?(l="cf"===c?["FY","TTM","Q","YTD"]:"bs"===c?["FY","Q"]:["FY","TTM","Q"],s=isValidFreq_returnCleanString(s,l,"TTM",c)):s=!!map_metrics[c].default_freq&&isValidFreq_returnCleanString(s,map_metrics[c].supported_freq,map_metrics[c].default_freq,c),!1!==s){e.next=46;break}return e.abrupt("return",[["Invalid period"]]);case 46:return!p&&["TTM","FY","Q","YTD"].includes(s)&&o&&o>1?s+="@"+o:p||(o=void 0),f={},p||(b={field_code:c},"-1"!==s&&""!==s&&void 0!==s&&(b.period=s),f=generate_query(1,"watchlist",[],[b],[],["",""],u,[b],[u])),f=n(n({},f),{ticker:u,metric:c,freq:s,api_key:i,limit:o}),206==c&&(f.is_latest_price="1"),d=link+"/excel/standard?"+new URLSearchParams(f).toString(),e.next=54,fetch(d);case 54:if((m=e.sent).ok){e.next=57;break}throw new Error(m.statusText);case 57:return e.next=59,m.json();case 59:if(!("message"in(g=e.sent))){e.next=62;break}return e.abrupt("return",[[g.message]]);case 62:return e.abrupt("return",handle_receive_AR_EQUITY(g,p,c));case 63:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}function c(){return c=i(regeneratorRuntime.mark((function e(t,r){var n,a,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>2&&void 0!==o[2]?o[2]:void 0,a=o.length>3&&void 0!==o[3]?o[3]:void 0,r){e.next=4;break}return e.abrupt("return",[["Metric cannot be empty"]]);case 4:if((r=r.toLowerCase())in map_excel_name_to_id){e.next=7;break}return e.abrupt("return",[["Unsupported metric"]]);case 7:return e.abrupt("return",s(t,r,n,a));case 8:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}function p(){return p=i(regeneratorRuntime.mark((function e(t,r){var n,a,o,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>2&&void 0!==i[2]?i[2]:void 0,a=i.length>3&&void 0!==i[3]?i[3]:void 0,o=r){e.next=5;break}return e.abrupt("return",[["Metric cannot be empty"]]);case 5:if(o=o.toLowerCase(),["bs","cf","ic"].includes(o)){e.next=8;break}return e.abrupt("return",[["Unsupported metric"]]);case 8:return e.abrupt("return",s(t,o,n,a));case 9:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}var l={1:1,5:1,15:1,30:1,60:1,D:1,W:1,M:1,d:1,w:1,m:1},f={d:1,w:1,m:1},b=["close","open","high","low","volume"];function d(e,t,r){return m.apply(this,arguments)}function m(){return m=i(regeneratorRuntime.mark((function e(t,r,n){var a,o,i,s,u,c,p,d,m,g,h,w=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=w.length>3&&void 0!==w[3]?w[3]:void 0,o=w.length>4&&void 0!==w[4]?w[4]:"stock",null==a&&(a=void 0),i=readCookie("finsheet_api_key")){e.next=6;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 6:if(t){e.next=8;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 8:if("string"==typeof t){e.next=10;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 10:if(t=t.toUpperCase(),r in l){e.next=13;break}return e.abrupt("return",[["Invalid resolution"]]);case 13:if(r in f&&(r=r.toUpperCase()),s=Date.parse(new Date)/1e3,n){e.next=17;break}return e.abrupt("return",[["'from' cannot be empty"]]);case 17:if("number"!=typeof n&&isNaN(n)){e.next=21;break}n=Math.round(n),e.next=24;break;case 21:if(n=Date.parse(n)/1e3,!(isNaN(n)||n<0)){e.next=24;break}return e.abrupt("return",[["Invalid 'from'"]]);case 24:if(""!=a&&void 0!==a){e.next=28;break}a=s,e.next=35;break;case 28:if("number"!=typeof a&&isNaN(a)){e.next=32;break}a=Math.round(a),e.next=35;break;case 32:if(a=Date.parse(a)/1e3,!(isNaN(a)||a<0)){e.next=35;break}return e.abrupt("return",[["Invalid 'to'"]]);case 35:if(!(a<=n)){e.next=37;break}return e.abrupt("return",[["'to' cannot be before 'from'"]]);case 37:return u={ticker:t,resolution:r,from:n,to:a,api_key:i,properties:JSON.stringify(b),which:o},c=link+"/excel/candles?"+new URLSearchParams(u).toString(),e.next=41,fetch(c);case 41:if((p=e.sent).ok){e.next=44;break}throw new Error(p.statusText);case 44:return e.next=46,p.json();case 46:if(!("message"in(d=e.sent))){e.next=49;break}return e.abrupt("return",[[d.message]]);case 49:if(m=d.data,g=[["Period","Close","Open","High","Low","Volume"]],m.c){e.next=53;break}return e.abrupt("return",[["No data"]]);case 53:if(m.c.constructor===Array)for(h=0;h<m.c.length;h++)g.push([m.t&&m.t[h]?new Date(1e3*m.t[h]):"",m.c[h]?m.c[h]:"",m.o&&m.o[h]?m.o[h]:"",m.h&&m.h[h]?m.h[h]:"",m.l&&m.l[h]?m.l[h]:"",m.v&&m.v[h]?m.v[h]:""]);else g.push([m.t?new Date(1e3*m.t):"",m.c?m.c:"",m.o?m.o:"",m.h?m.h:"",m.l?m.l:"",m.v?m.v:""]);if(!(g.length<2)){e.next=56;break}return e.abrupt("return",[["No data"]]);case 56:return console.log(g),e.abrupt("return",g);case 58:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}function g(){return g=i(regeneratorRuntime.mark((function e(t,r){var n,a,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>2&&void 0!==o[2]?o[2]:void 0,a=o.length>3&&void 0!==o[3]?o[3]:void 0,e.abrupt("return",d(t,r,n,a,"stock"));case 3:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function h(){return h=i(regeneratorRuntime.mark((function e(t,r){var n,a,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>2&&void 0!==o[2]?o[2]:void 0,a=o.length>3&&void 0!==o[3]?o[3]:void 0,e.abrupt("return",d(t,r,n,a,"forex"));case 3:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function w(){return w=i(regeneratorRuntime.mark((function e(t,r){var n,a,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>2&&void 0!==o[2]?o[2]:void 0,a=o.length>3&&void 0!==o[3]?o[3]:void 0,e.abrupt("return",d(t,r,n,a,"crypto"));case 3:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function y(){return y=i(regeneratorRuntime.mark((function e(t,r){var n,a,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>2&&void 0!==o[2]?o[2]:void 0,a=o.length>3&&void 0!==o[3]?o[3]:void 0,e.abrupt("return",d(t,r,n,a,"etf"));case 3:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}function k(){return k=i(regeneratorRuntime.mark((function e(t,r){var n,a,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>2&&void 0!==o[2]?o[2]:void 0,a=o.length>3&&void 0!==o[3]?o[3]:void 0,e.abrupt("return",d(t,r,n,a,"mutual_fund"));case 3:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}function v(){return v=i(regeneratorRuntime.mark((function e(){var t,r,n,a,o,i,s,u,c,p,l,f=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f.length>0&&void 0!==f[0]?f[0]:"USD",r=readCookie("finsheet_api_key")){e.next=4;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 4:return n={base_currency:t,api_key:r},a=link+"/excel/forex_all_rates?"+new URLSearchParams(n).toString(),e.next=8,fetch(a);case 8:if((o=e.sent).ok){e.next=11;break}throw new Error(o.statusText);case 11:return e.next=13,o.json();case 13:if(!("message"in(i=e.sent))){e.next=16;break}return e.abrupt("return",[[i.message]]);case 16:for(s=i.data,u=[],c=0,p=Object.keys(s);c<p.length;c++)l=p[c],u.push([l,s[l]]);return console.log(u),e.abrupt("return",u);case 21:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}var x={name:"Name",longName:"Full Name",description:"Description",marketCap:"Market Capitalization",totalSupply:"Total Supply",maxSupply:"Max Supply",circulatingSupply:"Circulating Supply",launchDate:"Launch Date",website:"Website",proofType:"Proof Type"};function _(){return(_=i(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,s,u,c,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:if(!t.includes(":")){e.next=9;break}return e.abrupt("return",[["Invalid symbol, make sure it does not include exchange name"]]);case 9:return t=t.toUpperCase(),n=link+"/excel/asset_profile?"+new URLSearchParams({symbol:t,api_key:r,which:"crypto_profile"}).toString(),e.next=14,fetch(n);case 14:if((a=e.sent).ok){e.next=17;break}throw new Error(a.statusText);case 17:return e.next=19,a.json();case 19:if(!("message"in(o=e.sent))){e.next=22;break}return e.abrupt("return",[[o.message]]);case 22:for(i=o.data,s=[],u=0,c=Object.keys(x);u<c.length;u++)p=c[u],i[p]&&s.push([x[p],i[p]]);return console.log(s),e.abrupt("return",s);case 27:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S={assetClass:"Asset Class",aum:"AUM",avgVolume:"Avg Volume",cusip:"CUSIP",description:"Description",domicile:"Domicile",etfCompany:"ETF Issuer",expenseRatio:"Expense Ratio",inceptionDate:"Inception Date",investmentSegment:"Investment Segment",isin:"ISIN",name:"Name",nav:"NAV",navCurrency:"NAV Currency",priceToBook:"P/B",priceToEarnings:"P/E",trackingIndex:"Tracking Index",website:"Website"};function C(){return(C=i(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,s,u,c,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:return t=t.toUpperCase(),n=link+"/excel/asset_profile?"+new URLSearchParams({symbol:t,api_key:r,which:"etf_profile"}).toString(),e.next=12,fetch(n);case 12:if((a=e.sent).ok){e.next=15;break}throw new Error(a.statusText);case 15:return e.next=17,a.json();case 17:if(!("message"in(o=e.sent))){e.next=20;break}return e.abrupt("return",[[o.message]]);case 20:for(i=o.data.profile,s=[],o.data.symbol&&(s=[["Symbol",o.data.symbol]]),u=0,c=Object.keys(S);u<c.length;u++)p=c[u],i[p]&&s.push([S[p],i[p]]);return console.log(s),e.abrupt("return",s);case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var R={benchmark:"Benchmark",beta:"Beta",category:"Category",description:"Description",expenseRatio:"Expense Ratio",fundFamily:"Fund Family",inceptionDate:"Inception Date",investmentSegment:"Investment Segment",name:"Full Name",totalNav:"Total NAV",turnover:"Turnover"};function P(){return(P=i(regeneratorRuntime.mark((function e(t){var r,n,a,o,i,s,u,c,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:return t=t.toUpperCase(),n=link+"/excel/asset_profile?"+new URLSearchParams({symbol:t,api_key:r,which:"mutual_fund_profile"}).toString(),e.next=12,fetch(n);case 12:if((a=e.sent).ok){e.next=15;break}throw new Error(a.statusText);case 15:return e.next=17,a.json();case 17:if(!("message"in(o=e.sent))){e.next=20;break}return e.abrupt("return",[[o.message]]);case 20:for(i=o.data.profile,s=[],o.data.symbol&&(s=[["Symbol",o.data.symbol]]),u=0,c=Object.keys(R);u<c.length;u++)p=c[u],i[p]&&s.push([R[p],i[p]]);return console.log(s),e.abrupt("return",s);case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(){return(T=i(regeneratorRuntime.mark((function e(t){var r,n,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=readCookie("finsheet_api_key")){e.next=3;break}return e.abrupt("return",[["Please login using the sidebar"]]);case 3:if(t){e.next=5;break}return e.abrupt("return",[["Symbol cannot be empty"]]);case 5:if("string"==typeof t){e.next=7;break}return e.abrupt("return",[["Symbol has to be a string"]]);case 7:return t=t.toUpperCase(),n=link+"/excel/latest?"+new URLSearchParams({ticker:t,api_key:r}).toString(),e.next=12,fetch(n);case 12:if((a=e.sent).ok){e.next=15;break}throw new Error(a.statusText);case 15:return e.next=17,a.json();case 17:if(!("message"in(o=e.sent))){e.next=20;break}return e.abrupt("return",[[o.message]]);case 20:return e.abrupt("return",[[o.data]]);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e){window.socket=new WebSocket("wss://"+link.slice(8)+"/ws"),window.socket.onopen=function(){console.log("Socket open"),e&&window.socket.send(JSON.stringify({symbol:e,type:"subscribe"}))},window.socket.onmessage=function(e){if(window.Should_Update_Streaming){var t=JSON.parse(e.data),r=t.data[0].s;window.OldBigSymbolPriceMap[r]=window.BigSymbolPriceMap[r],window.BigSymbolPriceMap[r]=t.data[0].p}},window.socket.onclose=function(e){console.log("Socket is closed. Reconnect will be attempted in 1 second.",e.reason),setTimeout((function(){window.have_not_reconnect_websocket=!1,F()}),1e3)},window.socket.onerror=function(e){console.error("Socket encountered error: ",e.message,"Closing socket"),window.socket.close()}}function E(){return E=i(regeneratorRuntime.mark((function t(r,n){var a,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Excel.run(function(){var t=i(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:window.have_not_set_interval_change_color&&(window.have_not_set_interval_change_color=!1,setInterval(i(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(window.Should_Update_Streaming){t.next=2;break}return t.abrupt("return");case 2:return n=r.workbook.worksheets.getActiveWorksheet(),(a=n.getUsedRange(!0)).load("formulas"),a.load("address"),a.load("values"),t.next=9,r.sync().then(i(regeneratorRuntime.mark((function t(){var o,s,u,c,p,l,f,b,d,m,g,h,w,y,k,v,x,_,S,C,R,P;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=n.id,s=a.address.split("!")[1].split(":")[0],u=0,c=0,p=0;case 4:if(!(p<s.length)){t.next=12;break}if(isNaN(s[p])){t.next=9;break}return c=colnameToNumber(s.slice(0,p))-1,u=parseInt(s.slice(p))-1,t.abrupt("break",12);case 9:p++,t.next=4;break;case 12:for(l=[],f=[],b=a.formulas,d=a.values,p=0;p<b.length;p++)for(m=0;m<b[0].length;m++)(g=b[p][m]).toLowerCase().startsWith("=fs_streaming(")&&(3===(h=g.split('"')).length?(w=h[1],window.BigSymbolPriceMap[w]&&window.OldBigSymbolPriceMap[w]&&(window.BigSymbolPriceMap[w]>window.OldBigSymbolPriceMap[w]?l.push([u+p,c+m]):window.BigSymbolPriceMap[w]<window.OldBigSymbolPriceMap[w]&&f.push([u+p,c+m]))):(y=o+"@@"+(u+p)+"@@"+(c+m),window.EachCellStreamingValue[y]&&d[p][m]&&(d[p][m]>window.EachCellStreamingValue[y]?l.push([u+p,c+m]):d[p][m]<window.EachCellStreamingValue[y]&&f.push([u+p,c+m])),window.EachCellStreamingValue[y]=d[p][m]));k=0,v=[[l,"#2cbd54"],[f,"#ff6669"]];case 19:if(!(k<v.length)){t.next=33;break}x=v[k],_="",S=e(x[0]);try{for(S.s();!(C=S.n()).done;)h=C.value,R=getExcelColName(h[1]),_+=R.toUpperCase()+(h[0]+1)+":"+R.toUpperCase()+(h[0]+1)+", "}catch(e){S.e(e)}finally{S.f()}if(""!==_&&(_=_.slice(0,_.length-2)),P=n.getRanges(_),!_){t.next=30;break}return P.format.font.color=x[1],t.next=30,r.sync().then(i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))));case 30:k++,t.next=19;break;case 33:case"end":return t.stop()}}),t)}))));case 9:case"end":return t.stop()}}),t)}))),500));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),console.log("crypto"),readCookie("finsheet_api_key")){t.next=5;break}return t.abrupt("return","Please login using the sidebar");case 5:if(r){t.next=7;break}return t.abrupt("return","Symbol cannot be empty");case 7:if("string"==typeof r){t.next=9;break}return t.abrupt("return","Symbol has to be a string");case 9:r=r.toUpperCase(),window.socket&&window.socket.readyState===window.socket.OPEN||!window.have_not_reconnect_websocket?r in window.BigSymbolPriceMap||(a={symbol:r,type:"subscribe"},window.socket.send(JSON.stringify(a))):F(r),o=setInterval((function(){var e=window.BigSymbolPriceMap[r];n.setResult(e)}),500),n.onCanceled=function(){clearInterval(o)};case 13:case"end":return t.stop()}}),t)}))),E.apply(this,arguments)}window.OldBigSymbolPriceMap={},window.BigSymbolPriceMap={},window.EachCellStreamingValue={},window.Should_Update_Streaming=!0,window.have_not_reconnect_websocket=!0,window.have_not_add_on_calculated_trigger=!0,window.have_not_set_interval_change_color=!0,F(),CustomFunctions.associate("FS_EQUITYMETRICS",(function(e,t){return c.apply(this,arguments)})),CustomFunctions.associate("FS_EQUITYFULLFINANCIALS",(function(e,t){return p.apply(this,arguments)})),CustomFunctions.associate("FS_EQUITYCANDLES",(function(e,t){return g.apply(this,arguments)})),CustomFunctions.associate("FS_FOREXCANDLES",(function(e,t){return h.apply(this,arguments)})),CustomFunctions.associate("FS_CRYPTOCANDLES",(function(e,t){return w.apply(this,arguments)})),CustomFunctions.associate("FS_ETFCANDLES",(function(e,t){return y.apply(this,arguments)})),CustomFunctions.associate("FS_MUTUALFUNDCANDLES",(function(e,t){return k.apply(this,arguments)})),CustomFunctions.associate("FS_FOREXALLRATES",(function(){return v.apply(this,arguments)})),CustomFunctions.associate("FS_CRYPTOPROFILE",(function(e){return _.apply(this,arguments)})),CustomFunctions.associate("FS_ETFPROFILE",(function(e){return C.apply(this,arguments)})),CustomFunctions.associate("FS_MUTUALFUNDPROFILE",(function(e){return P.apply(this,arguments)})),CustomFunctions.associate("FS_LATEST",(function(e){return T.apply(this,arguments)})),CustomFunctions.associate("FS_STREAMING",(function(e,t){return E.apply(this,arguments)}))}();
//# sourceMappingURL=functions.js.map